(()=>{var ed=Object.defineProperty,we=Object.prototype.hasOwnProperty,ub=(j,p)=>()=>(p||(p={exports:{}},j(p.exports,p)),p.exports),cf=j=>ed(j,"__esModule",{value:!0}),df=(j,p)=>{cf(j);if(typeof p==="object"||typeof p==="function")for(let t in p)we.call(p,t)&&!we.call(j,t)&&t!=="default"&&ed(j,t,{get:()=>p[t],enumerable:!0});return j},fd=j=>j&&j.__esModule?j:df(ed({},"default",{value:j,enumerable:!0}),j);var le=ub((j,p)=>{(function(t,m){typeof j==="object"&&typeof p!=="undefined"?m(j):typeof define==="function"&&define.amd?define(["exports"],m):(t=typeof globalThis!=="undefined"?globalThis:t||self,m(t.Tweakpane={}))})(j,function(t){"use strict";class m{constructor(a){const[b,d]=a.split("-"),f=b.split(".");this.major=parseInt(f[0],10),this.minor=parseInt(f[1],10),this.patch=parseInt(f[2],10),this.prerelease=d!==null&&d!==void 0?d:null}toString(){const a=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[a,this.prerelease].join("-"):a}}class q{constructor(a){this.controller_=a}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(a){this.controller_.viewProps.set("disabled",a)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(a){this.controller_.viewProps.set("hidden",a)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class E{constructor(a){this.target=a}}class J extends E{constructor(a,b,d,f){super(a);this.value=b,this.presetKey=d,this.last=f!==null&&f!==void 0?f:!0}}class L extends E{constructor(a,b,d){super(a);this.value=b,this.presetKey=d}}class _ extends E{constructor(a,b){super(a);this.expanded=b}}function H(a){return a}function A(a){return a===null||a===void 0}function ha(a,b){if(a.length!==b.length)return!1;for(let d=0;d<a.length;d++)if(a[d]!==b[d])return!1;return!0}const y={alreadydisposed:()=>"View has been already disposed",invalidparams:a=>`Invalid parameters for '${a.name}'`,nomatchingcontroller:a=>`No matching controller for '${a.key}'`,nomatchingview:a=>`No matching view for '${JSON.stringify(a.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:a=>`Property '${a.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class n{constructor(a){var b;this.message=(b=y[a.type](H(a.context)))!==null&&b!==void 0?b:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=a.type}static alreadyDisposed(){return new n({type:"alreadydisposed"})}static notBindable(){return new n({type:"notbindable"})}static propertyNotFound(a){return new n({type:"propertynotfound",context:{name:a}})}static shouldNeverHappen(){return new n({type:"shouldneverhappen"})}}class B{constructor(a,b,d){this.obj_=a,this.key_=b,this.presetKey_=d!==null&&d!==void 0?d:b}static isBindable(a){return a===null?!1:typeof a!=="object"?!1:!0}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(a){this.obj_[this.key_]=a}writeProperty(a,b){const d=this.read();if(!B.isBindable(d))throw n.notBindable();if(!(a in d))throw n.propertyNotFound(a);d[a]=b}}class s extends q{get label(){return this.controller_.props.get("label")}set label(a){this.controller_.props.set("label",a)}get title(){var a;return(a=this.controller_.valueController.props.get("title"))!==null&&a!==void 0?a:""}set title(a){this.controller_.valueController.props.set("title",a)}on(a,b){const d=b.bind(this),f=this.controller_.valueController.emitter;return f.on(a,()=>{d(new E(this))}),this}}class v{constructor(){this.observers_={}}on(a,b){let d=this.observers_[a];return d||(d=this.observers_[a]=[]),d.push({handler:b}),this}off(a,b){const d=this.observers_[a];return d&&(this.observers_[a]=d.filter(f=>f.handler!==b)),this}emit(a,b){const d=this.observers_[a];if(!d)return;d.forEach(f=>{f.handler(b)})}}const P="tp";function z(a){const b=(d,f)=>[P,"-",a,"v",d?`_${d}`:"",f?`-${f}`:""].join("");return b}function Ra(a,b){return d=>b(a(d))}function wa(a){return a.rawValue}function aa(a,b){a.emitter.on("change",Ra(wa,b)),b(a.rawValue)}function $(a,b,d){aa(a.value(b),d)}function xa(a,b,d){d?a.classList.add(b):a.classList.remove(b)}function ba(a,b){return d=>{xa(a,b,d)}}function da(a,b){aa(a,d=>{b.textContent=d!==null&&d!==void 0?d:""})}const X=z("btn");class Nb{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(X()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("button");d.classList.add(X("b")),b.viewProps.bindDisabled(d),this.element.appendChild(d),this.buttonElement=d;const f=a.createElement("div");f.classList.add(X("t")),da(b.props.value("title"),f),this.buttonElement.appendChild(f)}}class Ha{constructor(a,b){this.emitter=new v(),this.onClick_=this.onClick_.bind(this),this.props=b.props,this.viewProps=b.viewProps,this.view=new Nb(a,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Ia{constructor(a,b){var d;this.constraint_=b===null||b===void 0?void 0:b.constraint,this.equals_=(d=b===null||b===void 0?void 0:b.equals)!==null&&d!==void 0?d:(f,i)=>f===i,this.emitter=new v(),this.rawValue_=a}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(a){this.setRawValue(a,{forceEmit:!1,last:!0})}setRawValue(a,b){const d=b!==null&&b!==void 0?b:{forceEmit:!1,last:!0},f=this.constraint_?this.constraint_.constrain(a):a,i=!this.equals_(this.rawValue_,f);if(!i&&!d.forceEmit)return;this.emitter.emit("beforechange",{sender:this}),this.rawValue_=f,this.emitter.emit("change",{options:d,rawValue:f,sender:this})}}class ma{constructor(a){this.emitter=new v(),this.value_=a}get rawValue(){return this.value_}set rawValue(a){this.setRawValue(a,{forceEmit:!1,last:!0})}setRawValue(a,b){const d=b!==null&&b!==void 0?b:{forceEmit:!1,last:!0};if(this.value_===a&&!d.forceEmit)return;this.emitter.emit("beforechange",{sender:this}),this.value_=a,this.emitter.emit("change",{options:d,rawValue:this.value_,sender:this})}}function Y(a,b){const d=b===null||b===void 0?void 0:b.constraint,f=b===null||b===void 0?void 0:b.equals;return!d&&!f?new ma(a):new Ia(a,b)}class C{constructor(a){this.emitter=new v(),this.valMap_=a;for(const b in this.valMap_){const d=this.valMap_[b];d.emitter.on("change",()=>{this.emitter.emit("change",{key:b,sender:this})})}}static createCore(a){const b=Object.keys(a);return b.reduce((d,f)=>Object.assign(d,{[f]:Y(a[f])}),{})}static fromObject(a){const b=this.createCore(a);return new C(b)}get(a){return this.valMap_[a].rawValue}set(a,b){this.valMap_[a].rawValue=b}value(a){return this.valMap_[a]}}function R(a,b){const d=Object.keys(b),f=d.reduce((i,l)=>{if(i===void 0)return;const r=b[l],x=r(a[l]);return x.succeeded?Object.assign(Object.assign({},i),{[l]:x.value}):void 0},{});return H(f)}function Wa(a,b){return a.reduce((d,f)=>{if(d===void 0)return;const i=b(f);return!i.succeeded||i.value===void 0?void 0:[...d,i.value]},[])}function Ob(a){return a===null?!1:typeof a==="object"}function na(a){return b=>d=>{if(!b&&d===void 0)return{succeeded:!1,value:void 0};if(b&&d===void 0)return{succeeded:!0,value:void 0};const f=a(d);return f!==void 0?{succeeded:!0,value:f}:{succeeded:!1,value:void 0}}}function Xa(a){return{custom:b=>na(b)(a),boolean:na(b=>typeof b==="boolean"?b:void 0)(a),number:na(b=>typeof b==="number"?b:void 0)(a),string:na(b=>typeof b==="string"?b:void 0)(a),function:na(b=>typeof b==="function"?b:void 0)(a),constant:b=>na(d=>d===b?b:void 0)(a),raw:na(b=>b)(a),object:b=>na(d=>Ob(d)?R(d,b):void 0)(a),array:b=>na(d=>Array.isArray(d)?Wa(d,b):void 0)(a)}}const S={optional:Xa(!0),required:Xa(!1)};function N(a,b){const d=S.required.object(b)(a);return d.succeeded?d.value:void 0}function Ya(a){return a&&a.parentElement&&a.parentElement.removeChild(a),null}function Pb(){return["veryfirst","first","last","verylast"]}const fb=z(""),vb={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Ja{constructor(a){this.parent_=null,this.blade=a.blade,this.view=a.view,this.viewProps=a.viewProps;const b=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Pb().forEach(d=>{b.classList.remove(fb(void 0,vb[d]))}),this.blade.get("positions").forEach(d=>{b.classList.add(fb(void 0,vb[d]))})}),this.viewProps.handleDispose(()=>{Ya(b)})}get parent(){return this.parent_}}const ca="http://www.w3.org/2000/svg";function Za(a){a.offsetHeight}function wb(a,b){const d=a.style.transition;a.style.transition="none",b(),a.style.transition=d}function Ka(a){return a.ontouchstart!==void 0}function Qb(){return new Function("return this")()}function w(){const a=H(Qb());return a.document}function F(a){const b=a.ownerDocument.defaultView;if(!b)return null;const d="document"in b;return d?a.getContext("2d"):null}const Z={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function I(a,b){const d=a.createElementNS(ca,"svg");return d.innerHTML=Z[b],d}function ea(a,b,d){a.insertBefore(b,a.children[d])}function ta(a){a.parentElement&&a.parentElement.removeChild(a)}function ya(a){for(;a.children.length>0;)a.removeChild(a.children[0])}function gb(a){for(;a.childNodes.length>0;)a.removeChild(a.childNodes[0])}function Rb(a){return a.relatedTarget?H(a.relatedTarget):"explicitOriginalTarget"in a?a.explicitOriginalTarget:null}const za=z("lbl");function gd(a,b){const d=a.createDocumentFragment(),f=b.split(`
`).map(i=>a.createTextNode(i));return f.forEach((i,l)=>{l>0&&d.appendChild(a.createElement("br")),d.appendChild(i)}),d}class wc{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(za()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("div");d.classList.add(za("l")),$(b.props,"label",i=>{A(i)?this.element.classList.add(za(void 0,"nol")):(this.element.classList.remove(za(void 0,"nol")),gb(d),d.appendChild(gd(a,i)))}),this.element.appendChild(d),this.labelElement=d;const f=a.createElement("div");f.classList.add(za("v")),this.element.appendChild(f),this.valueElement=f}}class hb extends Ja{constructor(a,b){const d=b.valueController.viewProps;super(Object.assign(Object.assign({},b),{view:new wc(a,{props:b.props,viewProps:d}),viewProps:d}));this.props=b.props,this.valueController=b.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const xb={id:"button",type:"blade",accept(a){const b=S,d=N(a,{title:b.required.string,view:b.required.constant("button"),label:b.optional.string});return d?{params:d}:null},controller(a){return new hb(a.document,{blade:a.blade,props:C.fromObject({label:a.params.label}),valueController:new Ha(a.document,{props:C.fromObject({title:a.params.title}),viewProps:a.viewProps})})},api(a){return a.controller instanceof hb?a.controller.valueController instanceof Ha?new s(a.controller):null:null}};class Aa extends Ja{constructor(a){super(a);this.value=a.value}}function La(){return new C({positions:Y([],{equals:ha})})}class ib extends C{constructor(a){super(a)}static create(a){const b={completed:!0,expanded:a,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},d=C.createCore(b);return new ib(d)}get styleExpanded(){var a;return(a=this.get("temporaryExpanded"))!==null&&a!==void 0?a:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const a=this.get("expandedHeight");return this.get("shouldFixHeight")&&!A(a)?`${a}px`:"auto"}bindExpandedClass(a,b){const d=()=>{const f=this.styleExpanded;f?a.classList.add(b):a.classList.remove(b)};$(this,"expanded",d),$(this,"temporaryExpanded",d)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function hd(a,b){let d=0;return wb(b,()=>{a.set("expandedHeight",null),a.set("temporaryExpanded",!0),Za(b),d=b.clientHeight,a.set("temporaryExpanded",null),Za(b)}),d}function xc(a,b){b.style.height=a.styleHeight}function yb(a,b){a.value("expanded").emitter.on("beforechange",()=>{a.set("completed",!1),A(a.get("expandedHeight"))&&a.set("expandedHeight",hd(a,b)),a.set("shouldFixHeight",!0),Za(b)}),a.emitter.on("change",()=>{xc(a,b)}),xc(a,b),b.addEventListener("transitionend",d=>{if(d.propertyName!=="height")return;a.cleanUpTransition()})}class Sb extends q{constructor(a,b){super(a);this.rackApi_=b}}function id(a,b){return a.addBlade(Object.assign(Object.assign({},b),{view:"button"}))}function jd(a,b){return a.addBlade(Object.assign(Object.assign({},b),{view:"folder"}))}function kd(a,b){const d=b||{};return a.addBlade(Object.assign(Object.assign({},d),{view:"separator"}))}function ld(a,b){return a.addBlade(Object.assign(Object.assign({},b),{view:"tab"}))}class Tb{constructor(a){this.emitter=new v(),this.items_=[],this.cache_=new Set(),this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=a}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(a){for(const b of this.allItems())if(a(b))return b;return null}includes(a){return this.cache_.has(a)}add(a,b){if(this.includes(a))throw n.shouldNeverHappen();const d=b!==void 0?b:this.items_.length;this.items_.splice(d,0,a),this.cache_.add(a);const f=this.extract_(a);f&&(f.emitter.on("add",this.onSubListAdd_),f.emitter.on("remove",this.onSubListRemove_),f.allItems().forEach(i=>{this.cache_.add(i)})),this.emitter.emit("add",{index:d,item:a,root:this,target:this})}remove(a){const b=this.items_.indexOf(a);if(b<0)return;this.items_.splice(b,1),this.cache_.delete(a);const d=this.extract_(a);d&&(d.emitter.off("add",this.onSubListAdd_),d.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:b,item:a,root:this,target:this})}onSubListAdd_(a){this.cache_.add(a.item),this.emitter.emit("add",{index:a.index,item:a.item,root:this,target:a.target})}onSubListRemove_(a){this.cache_.delete(a.item),this.emitter.emit("remove",{index:a.index,item:a.item,root:this,target:a.target})}}class Ub extends q{constructor(a){super(a);this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new v(),this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(a){this.controller_.props.set("label",a)}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(a){const b=a.sender.target.read();this.emitter_.emit("change",{event:new J(this,H(b),this.controller_.binding.target.presetKey,a.options.last)})}}class oa extends hb{constructor(a,b){super(a,b);this.binding=b.binding}}class Sa extends q{constructor(a){super(a);this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new v(),this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(a){this.controller_.props.set("label",a)}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(a){const b=a.sender.target.read();this.emitter_.emit("update",{event:new L(this,H(b),this.controller_.binding.target.presetKey)})}}class Ma extends hb{constructor(a,b){super(a,b);this.binding=b.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function jb(a){return a instanceof lb?a.apiSet_:a instanceof Sb?a.rackApi_.apiSet_:null}function kb(a,b){const d=a.find(f=>f.controller_===b);if(!d)throw n.shouldNeverHappen();return d}function zb(a,b,d){if(!B.isBindable(a))throw n.notBindable();return new B(a,b,d)}class lb extends q{constructor(a,b){super(a);this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new v(),this.apiSet_=new Tb(jb),this.pool_=b;const d=this.controller_.rack;d.emitter.on("add",this.onRackAdd_),d.emitter.on("remove",this.onRackRemove_),d.emitter.on("inputchange",this.onRackInputChange_),d.emitter.on("monitorupdate",this.onRackMonitorUpdate_),d.children.forEach(f=>{this.setUpApi_(f)})}get children(){return this.controller_.rack.children.map(a=>kb(this.apiSet_,a))}addInput(a,b,d){const f=d||{},i=this.controller_.view.element.ownerDocument,l=this.pool_.createInput(i,zb(a,b,f.presetKey),f),r=new Ub(l);return this.add(r,f.index)}addMonitor(a,b,d){const f=d||{},i=this.controller_.view.element.ownerDocument,l=this.pool_.createMonitor(i,zb(a,b),f),r=new Sa(l);return H(this.add(r,f.index))}addFolder(a){return jd(this,a)}addButton(a){return id(this,a)}addSeparator(a){return kd(this,a)}addTab(a){return ld(this,a)}add(a,b){this.controller_.rack.add(a.controller_,b);const d=this.apiSet_.find(f=>f.controller_===a.controller_);return d&&this.apiSet_.remove(d),this.apiSet_.add(a),a}remove(a){this.controller_.rack.remove(a.controller_)}addBlade(a){const b=this.controller_.view.element.ownerDocument,d=this.pool_.createBlade(b,a),f=this.pool_.createBladeApi(d);return this.add(f,a.index)}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}setUpApi_(a){const b=this.apiSet_.find(d=>d.controller_===a);b||this.apiSet_.add(this.pool_.createBladeApi(a))}onRackAdd_(a){this.setUpApi_(a.bladeController)}onRackRemove_(a){if(a.isRoot){const b=kb(this.apiSet_,a.bladeController);this.apiSet_.remove(b)}}onRackInputChange_(a){const b=a.bladeController;if(b instanceof oa){const d=kb(this.apiSet_,b),f=b.binding;this.emitter_.emit("change",{event:new J(d,H(f.target.read()),f.target.presetKey,a.options.last)})}else if(b instanceof Aa){const d=kb(this.apiSet_,b);this.emitter_.emit("change",{event:new J(d,b.value.rawValue,void 0,a.options.last)})}}onRackMonitorUpdate_(a){if(!(a.bladeController instanceof Ma))throw n.shouldNeverHappen();const b=kb(this.apiSet_,a.bladeController),d=a.bladeController.binding;this.emitter_.emit("update",{event:new L(b,H(d.target.read()),d.target.presetKey)})}}class Vb extends Sb{constructor(a,b){super(a,new lb(a.rackController,b));this.emitter_=new v(),this.controller_.foldable.value("expanded").emitter.on("change",d=>{this.emitter_.emit("fold",{event:new _(this,d.sender.rawValue)})}),this.rackApi_.on("change",d=>{this.emitter_.emit("change",{event:d})}),this.rackApi_.on("update",d=>{this.emitter_.emit("update",{event:d})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(a){this.controller_.foldable.set("expanded",a)}get title(){return this.controller_.props.get("title")}set title(a){this.controller_.props.set("title",a)}get children(){return this.rackApi_.children}addInput(a,b,d){return this.rackApi_.addInput(a,b,d)}addMonitor(a,b,d){return this.rackApi_.addMonitor(a,b,d)}addFolder(a){return this.rackApi_.addFolder(a)}addButton(a){return this.rackApi_.addButton(a)}addSeparator(a){return this.rackApi_.addSeparator(a)}addTab(a){return this.rackApi_.addTab(a)}add(a,b){return this.rackApi_.add(a,b)}remove(a){this.rackApi_.remove(a)}addBlade(a){return this.rackApi_.addBlade(a)}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}}class Wb extends Ja{constructor(a){super({blade:a.blade,view:a.view,viewProps:a.rackController.viewProps});this.rackController=a.rackController}}class md{constructor(a,b){const d=z(b.viewName);this.element=a.createElement("div"),this.element.classList.add(d()),b.viewProps.bindClassModifiers(this.element)}}function nd(a,b){for(let d=0;d<a.length;d++){const f=a[d];if(f instanceof oa&&f.binding===b)return f}return null}function od(a,b){for(let d=0;d<a.length;d++){const f=a[d];if(f instanceof Ma&&f.binding===b)return f}return null}function pd(a,b){for(let d=0;d<a.length;d++){const f=a[d];if(f instanceof Aa&&f.value===b)return f}return null}function Xb(a){return a instanceof mb?a.rack:a instanceof Wb?a.rackController.rack:null}function qd(a){const b=Xb(a);return b?b.bcSet_:null}class rd{constructor(a){var b;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new v(),this.blade_=a!==null&&a!==void 0?a:null,(b=this.blade_)===null||b===void 0||b.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new Tb(qd),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(a,b){a.parent&&a.parent.remove(a),a.parent_=this,this.bcSet_.add(a,b)}remove(a){a.parent_=null,this.bcSet_.remove(a)}find(a){return H(this.bcSet_.allItems().filter(b=>b instanceof a))}onSetAdd_(a){this.updatePositions_();const b=a.target===a.root;this.emitter.emit("add",{bladeController:a.item,index:a.index,isRoot:b,sender:this});if(!b)return;const d=a.item;d.viewProps.emitter.on("change",this.onChildViewPropsChange_),d.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),d.viewProps.handleDispose(this.onChildDispose_);if(d instanceof oa)d.binding.emitter.on("change",this.onChildInputChange_);else if(d instanceof Ma)d.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(d instanceof Aa)d.value.emitter.on("change",this.onChildValueChange_);else{const f=Xb(d);if(f){const i=f.emitter;i.on("layout",this.onDescendantLayout_),i.on("inputchange",this.onDescendantInputChange_),i.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(a){this.updatePositions_();const b=a.target===a.root;this.emitter.emit("remove",{bladeController:a.item,isRoot:b,sender:this});if(!b)return;const d=a.item;if(d instanceof oa)d.binding.emitter.off("change",this.onChildInputChange_);else if(d instanceof Ma)d.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(d instanceof Aa)d.value.emitter.off("change",this.onChildValueChange_);else{const f=Xb(d);if(f){const i=f.emitter;i.off("layout",this.onDescendantLayout_),i.off("inputchange",this.onDescendantInputChange_),i.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const a=this.bcSet_.items.filter(f=>!f.viewProps.get("hidden")),b=a[0],d=a[a.length-1];this.bcSet_.items.forEach(f=>{const i=[];f===b&&(i.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&i.push("veryfirst")),f===d&&(i.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&i.push("verylast")),f.blade.set("positions",i)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(a){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){const a=this.bcSet_.items.filter(b=>b.viewProps.get("disposed"));a.forEach(b=>{this.bcSet_.remove(b)})}onChildInputChange_(a){const b=nd(this.find(oa),a.sender);if(!b)throw n.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:b,options:a.options,sender:this})}onChildMonitorUpdate_(a){const b=od(this.find(Ma),a.sender);if(!b)throw n.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:b,sender:this})}onChildValueChange_(a){const b=pd(this.find(Aa),a.sender);if(!b)throw n.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:b,options:a.options,sender:this})}onDescendantLayout_(a){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(a){this.emitter.emit("inputchange",{bladeController:a.bladeController,options:a.options,sender:this})}onDescendantMonitorUpdate_(a){this.emitter.emit("monitorupdate",{bladeController:a.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class mb extends Ja{constructor(a,b){super(Object.assign(Object.assign({},b),{view:new md(a,{viewName:"brk",viewProps:b.viewProps})}));this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const d=new rd(b.root?void 0:b.blade);d.emitter.on("add",this.onRackAdd_),d.emitter.on("remove",this.onRackRemove_),this.rack=d,this.viewProps.handleDispose(()=>{for(let f=this.rack.children.length-1;f>=0;f--){const i=this.rack.children[f];i.viewProps.set("disposed",!0)}})}onRackAdd_(a){if(!a.isRoot)return;ea(this.view.element,a.bladeController.view.element,a.index)}onRackRemove_(a){if(!a.isRoot)return;ta(a.bladeController.view.element)}}const yc=z("cnt");class sd{constructor(a,b){this.className_=z(b.viewName||"fld"),this.element=a.createElement("div"),this.element.classList.add(this.className_(),yc()),b.viewProps.bindClassModifiers(this.element),this.foldable_=b.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),$(this.foldable_,"completed",ba(this.element,this.className_(void 0,"cpl")));const d=a.createElement("button");d.classList.add(this.className_("b")),$(b.props,"title",r=>{A(r)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),b.viewProps.bindDisabled(d),this.element.appendChild(d),this.buttonElement=d;const f=a.createElement("div");f.classList.add(this.className_("t")),da(b.props.value("title"),f),this.buttonElement.appendChild(f),this.titleElement=f;const i=a.createElement("div");i.classList.add(this.className_("m")),this.buttonElement.appendChild(i);const l=b.containerElement;l.classList.add(this.className_("c")),this.element.appendChild(l),this.containerElement=l}}class Yb extends Wb{constructor(a,b){var d;const f=ib.create((d=b.expanded)!==null&&d!==void 0?d:!0),i=new mb(a,{blade:b.blade,root:b.root,viewProps:b.viewProps});super(Object.assign(Object.assign({},b),{rackController:i,view:new sd(a,{containerElement:i.view.element,foldable:f,props:b.props,viewName:b.root?"rot":void 0,viewProps:b.viewProps})}));this.onTitleClick_=this.onTitleClick_.bind(this),this.props=b.props,this.foldable=f,yb(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const td={id:"folder",type:"blade",accept(a){const b=S,d=N(a,{title:b.required.string,view:b.required.constant("folder"),expanded:b.optional.boolean});return d?{params:d}:null},controller(a){return new Yb(a.document,{blade:a.blade,expanded:a.params.expanded,props:C.fromObject({title:a.params.title}),viewProps:a.viewProps})},api(a){return a.controller instanceof Yb?new Vb(a.controller,a.pool):null}};class _a extends Aa{constructor(a,b){const d=b.valueController.viewProps;super(Object.assign(Object.assign({},b),{value:b.valueController.value,view:new wc(a,{props:b.props,viewProps:d}),viewProps:d}));this.props=b.props,this.valueController=b.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Zb extends q{}const zc=z("spr");class ud{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(zc()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("hr");d.classList.add(zc("r")),this.element.appendChild(d)}}class Ac extends Ja{constructor(a,b){super(Object.assign(Object.assign({},b),{view:new ud(a,{viewProps:b.viewProps})}))}}const Bc={id:"separator",type:"blade",accept(a){const b=S,d=N(a,{view:b.required.constant("separator")});return d?{params:d}:null},controller(a){return new Ac(a.document,{blade:a.blade,viewProps:a.viewProps})},api(a){return a.controller instanceof Ac?new Zb(a.controller):null}},vd=z("");function nb(a,b){return ba(a,vd(void 0,b))}class Ta extends C{constructor(a){super(a)}static create(a){var b,d;const f=a!==null&&a!==void 0?a:{},i={disabled:(b=f.disabled)!==null&&b!==void 0?b:!1,disposed:!1,hidden:(d=f.hidden)!==null&&d!==void 0?d:!1},l=C.createCore(i);return new Ta(l)}bindClassModifiers(a){$(this,"disabled",nb(a,"disabled")),$(this,"hidden",nb(a,"hidden"))}bindDisabled(a){$(this,"disabled",b=>{a.disabled=b})}bindTabIndex(a){$(this,"disabled",b=>{a.tabIndex=b?-1:0})}handleDispose(a){this.value("disposed").emitter.on("change",b=>{b&&a()})}}const Na=z("tbi");class Cc{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(Na()),b.viewProps.bindClassModifiers(this.element),$(b.props,"selected",i=>{i?this.element.classList.add(Na(void 0,"sel")):this.element.classList.remove(Na(void 0,"sel"))});const d=a.createElement("button");d.classList.add(Na("b")),b.viewProps.bindDisabled(d),this.element.appendChild(d),this.buttonElement=d;const f=a.createElement("div");f.classList.add(Na("t")),da(b.props.value("title"),f),this.buttonElement.appendChild(f),this.titleElement=f}}class wd{constructor(a,b){this.emitter=new v(),this.onClick_=this.onClick_.bind(this),this.props=b.props,this.viewProps=b.viewProps,this.view=new Cc(a,{props:b.props,viewProps:b.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Dc{constructor(a,b){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new wd(a,{props:b.itemProps,viewProps:Ta.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new mb(a,{blade:La(),viewProps:Ta.create()}),this.props=b.props,$(this.props,"selected",d=>{this.itemController.props.set("selected",d),this.contentController.viewProps.set("hidden",!d)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Ec{constructor(a,b){this.controller_=a,this.rackApi_=b}get title(){var a;return(a=this.controller_.itemController.props.get("title"))!==null&&a!==void 0?a:""}set title(a){this.controller_.itemController.props.set("title",a)}get selected(){return this.controller_.props.get("selected")}set selected(a){this.controller_.props.set("selected",a)}get children(){return this.rackApi_.children}addButton(a){return this.rackApi_.addButton(a)}addFolder(a){return this.rackApi_.addFolder(a)}addSeparator(a){return this.rackApi_.addSeparator(a)}addTab(a){return this.rackApi_.addTab(a)}add(a,b){this.rackApi_.add(a,b)}remove(a){this.rackApi_.remove(a)}addInput(a,b,d){return this.rackApi_.addInput(a,b,d)}addMonitor(a,b,d){return this.rackApi_.addMonitor(a,b,d)}addBlade(a){return this.rackApi_.addBlade(a)}}class _b extends Sb{constructor(a,b){super(a,new lb(a.rackController,b));this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new v(),this.pageApiMap_=new Map(),this.rackApi_.on("change",d=>{this.emitter_.emit("change",{event:d})}),this.rackApi_.on("update",d=>{this.emitter_.emit("update",{event:d})}),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(d=>{this.setUpPageApi_(d)})}get pages(){return this.controller_.pageSet.items.map(a=>{const b=this.pageApiMap_.get(a);if(!b)throw n.shouldNeverHappen();return b})}addPage(a){const b=this.controller_.view.element.ownerDocument,d=new Dc(b,{itemProps:C.fromObject({selected:!1,title:a.title}),props:C.fromObject({selected:!1})});this.controller_.add(d,a.index);const f=this.pageApiMap_.get(d);if(!f)throw n.shouldNeverHappen();return f}removePage(a){this.controller_.remove(a)}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}setUpPageApi_(a){const b=this.rackApi_.apiSet_.find(f=>f.controller_===a.contentController);if(!b)throw n.shouldNeverHappen();const d=new Ec(a,b);this.pageApiMap_.set(a,d)}onPageAdd_(a){this.setUpPageApi_(a.item)}onPageRemove_(a){const b=this.pageApiMap_.get(a.item);if(!b)throw n.shouldNeverHappen();this.pageApiMap_.delete(a.item)}}const Ba=z("tab");class Ab{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(Ba(),yc()),b.viewProps.bindClassModifiers(this.element),aa(b.empty,ba(this.element,Ba(void 0,"nop")));const d=a.createElement("div");d.classList.add(Ba("i")),this.element.appendChild(d),this.itemsElement=d;const f=b.contentsElement;f.classList.add(Ba("c")),this.element.appendChild(f),this.contentsElement=f}}class $b extends Wb{constructor(a,b){const d=new mb(a,{blade:b.blade,viewProps:b.viewProps}),f=Y(!0);super({blade:b.blade,rackController:d,view:new Ab(a,{contentsElement:d.view.element,empty:f,viewProps:b.viewProps})});this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new Tb(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=f,this.applyPages_()}get pageSet(){return this.pageSet_}add(a,b){this.pageSet_.add(a,b!==null&&b!==void 0?b:this.pageSet_.items.length)}remove(a){this.pageSet_.remove(this.pageSet_.items[a])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=this.pageSet_.items.length===0}onPageAdd_(a){const b=a.item;ea(this.view.itemsElement,b.itemController.view.element,a.index),this.rackController.rack.add(b.contentController,a.index),b.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(a){const b=a.item;ta(b.itemController.view.element),this.rackController.rack.remove(b.contentController),b.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(this.pageSet_.items.length===0)return;const a=this.pageSet_.items.findIndex(b=>b.props.get("selected"));a<0?this.pageSet_.items.forEach((b,d)=>{b.props.set("selected",d===0)}):this.pageSet_.items.forEach((b,d)=>{b.props.set("selected",d===a)})}onPageSelectedChange_(a){if(a.rawValue){const b=this.pageSet_.items.findIndex(d=>d.props.value("selected")===a.sender);this.pageSet_.items.forEach((d,f)=>{d.props.set("selected",f===b)})}else this.keepSelection_()}}const Fc={id:"tab",type:"blade",accept(a){const b=S,d=N(a,{pages:b.required.array(b.required.object({title:b.required.string})),view:b.required.constant("tab")});return!d||d.pages.length===0?null:{params:d}},controller(a){const b=new $b(a.document,{blade:a.blade,viewProps:a.viewProps});return a.params.pages.forEach(d=>{const f=new Dc(a.document,{itemProps:C.fromObject({selected:!1,title:d.title}),props:C.fromObject({selected:!1})});b.add(f)}),b},api(a){return a.controller instanceof $b?new _b(a.controller,a.pool):null}};function Gc(a,b){const d=a.accept(b.params);if(!d)return null;const f=S.optional.boolean(b.params.disabled).value,i=S.optional.boolean(b.params.hidden).value;return a.controller({blade:La(),document:b.document,params:H(Object.assign(Object.assign({},d.params),{disabled:f,hidden:i})),viewProps:Ta.create({disabled:f,hidden:i})})}class ac{constructor(){this.disabled=!1,this.emitter=new v()}dispose(){}tick(){if(this.disabled)return;this.emitter.emit("tick",{sender:this})}}class Bb{constructor(a,b){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=a,this.emitter=new v(),this.interval_=b,this.setTimer_()}get disabled(){return this.disabled_}set disabled(a){this.disabled_=a,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const a=this.doc_.defaultView;a&&a.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){this.clearTimer_();if(this.interval_<=0)return;const a=this.doc_.defaultView;a&&(this.timerId_=a.setInterval(this.onTick_,this.interval_))}onTick_(){if(this.disabled_)return;this.emitter.emit("tick",{sender:this})}}class V{constructor(a){this.constraints=a}constrain(a){return this.constraints.reduce((b,d)=>d.constrain(b),a)}}function sa(a,b){if(a instanceof b)return a;if(a instanceof V){const d=a.constraints.reduce((f,i)=>f?f:i instanceof b?i:null,null);if(d)return d}return null}class Ca{constructor(a){this.options=a}constrain(a){const b=this.options;if(b.length===0)return a;const d=b.filter(f=>f.value===a).length>0;return d?a:b[0].value}}class W{constructor(a){this.maxValue=a.max,this.minValue=a.min}constrain(a){let b=a;return A(this.minValue)||(b=Math.max(b,this.minValue)),A(this.maxValue)||(b=Math.min(b,this.maxValue)),b}}class Ua{constructor(a){this.step=a}constrain(a){const b=a<0?-Math.round(-a/this.step):Math.round(a/this.step);return b*this.step}}const bc=z("lst");class xd{constructor(a,b){this.onValueChange_=this.onValueChange_.bind(this),this.props_=b.props,this.element=a.createElement("div"),this.element.classList.add(bc()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("select");d.classList.add(bc("s")),$(this.props_,"options",i=>{ya(d),i.forEach((l,r)=>{const x=a.createElement("option");x.dataset.index=String(r),x.textContent=l.text,x.value=String(l.value),d.appendChild(x)})}),b.viewProps.bindDisabled(d),this.element.appendChild(d),this.selectElement=d;const f=a.createElement("div");f.classList.add(bc("m")),f.appendChild(I(a,"dropdown")),this.element.appendChild(f),b.value.emitter.on("change",this.onValueChange_),this.value_=b.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class ob{constructor(a,b){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=b.props,this.value=b.value,this.viewProps=b.viewProps,this.view=new xd(a,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(a){const b=H(a.currentTarget),d=b.selectedOptions.item(0);if(!d)return;const f=Number(d.dataset.index);this.value.rawValue=this.props.get("options")[f].value}}const Hc=z("pop");class Ic{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(Hc()),b.viewProps.bindClassModifiers(this.element),aa(b.shows,ba(this.element,Hc(void 0,"v")))}}class Jc{constructor(a,b){this.shows=Y(!1),this.viewProps=b.viewProps,this.view=new Ic(a,{shows:this.shows,viewProps:this.viewProps})}}const Kc=z("txt");class Lc{constructor(a,b){this.onChange_=this.onChange_.bind(this),this.element=a.createElement("div"),this.element.classList.add(Kc()),b.viewProps.bindClassModifiers(this.element),this.props_=b.props,this.props_.emitter.on("change",this.onChange_);const d=a.createElement("input");d.classList.add(Kc("i")),d.type="text",b.viewProps.bindDisabled(d),this.element.appendChild(d),this.inputElement=d,b.value.emitter.on("change",this.onChange_),this.value_=b.value,this.refresh()}refresh(){const a=this.props_.get("formatter");this.inputElement.value=a(this.value_.rawValue)}onChange_(){this.refresh()}}class Cb{constructor(a,b){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=b.parser,this.props=b.props,this.value=b.value,this.viewProps=b.viewProps,this.view=new Lc(a,{props:b.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(a){const b=H(a.currentTarget),d=b.value,f=this.parser_(d);A(f)||(this.value.rawValue=f),this.view.refresh()}}function yd(a){return String(a)}function Db(a){return a==="false"?!1:!!a}function Mc(a){return yd(a)}class zd{constructor(a){this.text=a}evaluate(){return Number(this.text)}toString(){return this.text}}const Ad={"**":(a,b)=>Math.pow(a,b),"*":(a,b)=>a*b,"/":(a,b)=>a/b,"%":(a,b)=>a%b,"+":(a,b)=>a+b,"-":(a,b)=>a-b,"<<":(a,b)=>a<<b,">>":(a,b)=>a>>b,">>>":(a,b)=>a>>>b,"&":(a,b)=>a&b,"^":(a,b)=>a^b,"|":(a,b)=>a|b};class Bd{constructor(a,b,d){this.left=b,this.operator=a,this.right=d}evaluate(){const a=Ad[this.operator];if(!a)throw new Error(`unexpected binary operator: '${this.operator}`);return a(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Oa={"+":a=>a,"-":a=>-a,"~":a=>~a};class Cd{constructor(a,b){this.operator=a,this.expression=b}evaluate(){const a=Oa[this.operator];if(!a)throw new Error(`unexpected unary operator: '${this.operator}`);return a(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function cc(a){return(b,d)=>{for(let f=0;f<a.length;f++){const i=a[f](b,d);if(i!=="")return i}return""}}function pb(a,b){var d;const f=a.substr(b).match(/^\s+/);return(d=f&&f[0])!==null&&d!==void 0?d:""}function Dd(a,b){const d=a.substr(b,1);return d.match(/^[1-9]$/)?d:""}function qb(a,b){var d;const f=a.substr(b).match(/^[0-9]+/);return(d=f&&f[0])!==null&&d!==void 0?d:""}function Nc(a,b){const d=qb(a,b);if(d!=="")return d;const f=a.substr(b,1);b+=1;if(f!=="-"&&f!=="+")return"";const i=qb(a,b);return i===""?"":f+i}function dc(a,b){const d=a.substr(b,1);b+=1;if(d.toLowerCase()!=="e")return"";const f=Nc(a,b);return f===""?"":d+f}function Oc(a,b){const d=a.substr(b,1);if(d==="0")return d;const f=Dd(a,b);return b+=f.length,f===""?"":f+qb(a,b)}function pa(a,b){const d=Oc(a,b);b+=d.length;if(d==="")return"";const f=a.substr(b,1);b+=f.length;if(f!==".")return"";const i=qb(a,b);return b+=i.length,d+f+i+dc(a,b)}function Ed(a,b){const d=a.substr(b,1);b+=d.length;if(d!==".")return"";const f=qb(a,b);return b+=f.length,f===""?"":d+f+dc(a,b)}function Fd(a,b){const d=Oc(a,b);return b+=d.length,d===""?"":d+dc(a,b)}const ec=cc([pa,Ed,Fd]);function Gd(a,b){var d;const f=a.substr(b).match(/^[01]+/);return(d=f&&f[0])!==null&&d!==void 0?d:""}function Pa(a,b){const d=a.substr(b,2);b+=d.length;if(d.toLowerCase()!=="0b")return"";const f=Gd(a,b);return f===""?"":d+f}function Pc(a,b){var d;const f=a.substr(b).match(/^[0-7]+/);return(d=f&&f[0])!==null&&d!==void 0?d:""}function Hd(a,b){const d=a.substr(b,2);b+=d.length;if(d.toLowerCase()!=="0o")return"";const f=Pc(a,b);return f===""?"":d+f}function Qc(a,b){var d;const f=a.substr(b).match(/^[0-9a-f]+/i);return(d=f&&f[0])!==null&&d!==void 0?d:""}function Id(a,b){const d=a.substr(b,2);b+=d.length;if(d.toLowerCase()!=="0x")return"";const f=Qc(a,b);return f===""?"":d+f}const Va=cc([Pa,Hd,Id]),Jd=cc([Va,ec]);function fc(a,b){const d=Jd(a,b);return b+=d.length,d===""?null:{evaluable:new zd(d),cursor:b}}function Kd(a,b){const d=a.substr(b,1);b+=d.length;if(d!=="(")return null;const f=gc(a,b);if(!f)return null;b=f.cursor,b+=pb(a,b).length;const i=a.substr(b,1);return b+=i.length,i!==")"?null:{evaluable:f.evaluable,cursor:b}}function Rc(a,b){return fc(a,b)||Kd(a,b)}function Da(a,b){const d=Rc(a,b);if(d)return d;const f=a.substr(b,1);b+=f.length;if(f!=="+"&&f!=="-"&&f!=="~")return null;const i=Da(a,b);return i?(b=i.cursor,{cursor:b,evaluable:new Cd(f,i.evaluable)}):null}function Ld(a,b,d){d+=pb(b,d).length;const f=a.filter(i=>b.startsWith(i,d))[0];return f?(d+=f.length,d+=pb(b,d).length,{cursor:d,operator:f}):null}function Md(a,b){return(d,f)=>{const i=a(d,f);if(!i)return null;f=i.cursor;let l=i.evaluable;for(;;){const r=Ld(b,d,f);if(!r)break;f=r.cursor;const x=a(d,f);if(!x)return null;f=x.cursor,l=new Bd(r.operator,l,x.evaluable)}return l?{cursor:f,evaluable:l}:null}}const Sc=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((a,b)=>Md(a,b),Da);function gc(a,b){return b+=pb(a,b).length,Sc(a,b)}function Tc(a){const b=gc(a,0);if(!b)return null;const d=b.cursor+pb(a,b.cursor).length;return d!==a.length?null:b.evaluable}function ia(a){var b;const d=Tc(a);return(b=d===null||d===void 0?void 0:d.evaluate())!==null&&b!==void 0?b:null}function Uc(a){if(typeof a==="number")return a;if(typeof a==="string"){const b=ia(a);if(!A(b))return b}return 0}function hc(a){return String(a)}function ja(a){return b=>b.toFixed(Math.max(Math.min(a,20),0))}const Nd=ja(0);function Eb(a){return Nd(a)+"%"}function ic(a){return String(a)}function jc(a){return a}function Vc(a,b){for(;a.length<b;)a.push(void 0)}function Od(a){const b=[];return Vc(b,a),Y(b)}function Wc(a){const b=a.indexOf(void 0);return H(b<0?a:a.slice(0,b))}function Pd(a,b){const d=[...Wc(a),b];return d.length>a.length?d.splice(0,d.length-a.length):Vc(d,a.length),d}function Ea({primary:a,secondary:b,forward:d,backward:f}){let i=!1;function l(r){if(i)return;i=!0,r(),i=!1}a.emitter.on("change",r=>{l(()=>{b.setRawValue(d(a,b),r.options)})}),b.emitter.on("change",r=>{l(()=>{a.setRawValue(f(a,b),r.options)}),l(()=>{b.setRawValue(d(a,b),r.options)})}),l(()=>{b.setRawValue(d(a,b),{forceEmit:!1,last:!0})})}function ka(a,b){const d=a*(b.altKey?.1:1)*(b.shiftKey?10:1);return b.upKey?+d:b.downKey?-d:0}function $a(a){return{altKey:a.altKey,downKey:a.key==="ArrowDown",shiftKey:a.shiftKey,upKey:a.key==="ArrowUp"}}function Fa(a){return{altKey:a.altKey,downKey:a.key==="ArrowLeft",shiftKey:a.shiftKey,upKey:a.key==="ArrowRight"}}function Qd(a){return a==="ArrowUp"||a==="ArrowDown"}function la(a){return Qd(a)||a==="ArrowLeft"||a==="ArrowRight"}function Fb(a,b){const d=b.ownerDocument.defaultView,f=b.getBoundingClientRect();return{x:a.pageX-((d&&d.scrollX||0)+f.left),y:a.pageY-((d&&d.scrollY||0)+f.top)}}class Qa{constructor(a){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=a,this.emitter=new v(),a.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),a.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),a.addEventListener("touchend",this.onTouchEnd_),a.addEventListener("mousedown",this.onMouseDown_)}computePosition_(a){const b=this.elem_.getBoundingClientRect();return{bounds:{width:b.width,height:b.height},point:a?{x:a.x,y:a.y}:null}}onMouseDown_(a){var b;a.preventDefault(),(b=a.currentTarget)===null||b===void 0||b.focus();const d=this.elem_.ownerDocument;d.addEventListener("mousemove",this.onDocumentMouseMove_),d.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:a.altKey,data:this.computePosition_(Fb(a,this.elem_)),sender:this,shiftKey:a.shiftKey})}onDocumentMouseMove_(a){this.emitter.emit("move",{altKey:a.altKey,data:this.computePosition_(Fb(a,this.elem_)),sender:this,shiftKey:a.shiftKey})}onDocumentMouseUp_(a){const b=this.elem_.ownerDocument;b.removeEventListener("mousemove",this.onDocumentMouseMove_),b.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:a.altKey,data:this.computePosition_(Fb(a,this.elem_)),sender:this,shiftKey:a.shiftKey})}onTouchStart_(a){a.preventDefault();const b=a.targetTouches.item(0),d=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:a.altKey,data:this.computePosition_(b?{x:b.clientX-d.left,y:b.clientY-d.top}:void 0),sender:this,shiftKey:a.shiftKey}),this.lastTouch_=b}onTouchMove_(a){const b=a.targetTouches.item(0),d=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:a.altKey,data:this.computePosition_(b?{x:b.clientX-d.left,y:b.clientY-d.top}:void 0),sender:this,shiftKey:a.shiftKey}),this.lastTouch_=b}onTouchEnd_(a){var b;const d=(b=a.targetTouches.item(0))!==null&&b!==void 0?b:this.lastTouch_,f=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:a.altKey,data:this.computePosition_(d?{x:d.clientX-f.left,y:d.clientY-f.top}:void 0),sender:this,shiftKey:a.shiftKey})}}function T(a,b,d,f,i){const l=(a-b)/(d-b);return f+l*(i-f)}function Xc(a){const b=String(a.toFixed(10)),d=b.split(".")[1];return d.replace(/0+$/,"").length}function O(a,b,d){return Math.min(Math.max(a,b),d)}function kc(a,b){return(a%b+b)%b}const qa=z("txt");class Rd{constructor(a,b){this.onChange_=this.onChange_.bind(this),this.props_=b.props,this.props_.emitter.on("change",this.onChange_),this.element=a.createElement("div"),this.element.classList.add(qa(),qa(void 0,"num")),b.arrayPosition&&this.element.classList.add(qa(void 0,b.arrayPosition)),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("input");d.classList.add(qa("i")),d.type="text",b.viewProps.bindDisabled(d),this.element.appendChild(d),this.inputElement=d,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=b.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(qa()),this.inputElement.classList.add(qa("i"));const f=a.createElement("div");f.classList.add(qa("k")),this.element.appendChild(f),this.knobElement=f;const i=a.createElementNS(ca,"svg");i.classList.add(qa("g")),this.knobElement.appendChild(i);const l=a.createElementNS(ca,"path");l.classList.add(qa("gb")),i.appendChild(l),this.guideBodyElem_=l;const r=a.createElementNS(ca,"path");r.classList.add(qa("gh")),i.appendChild(r),this.guideHeadElem_=r;const x=a.createElement("div");x.classList.add(z("tt")()),this.knobElement.appendChild(x),this.tooltipElem_=x,b.value.emitter.on("change",this.onChange_),this.value=b.value,this.refresh()}onDraggingChange_(a){if(a.rawValue===null){this.element.classList.remove(qa(void 0,"drg"));return}this.element.classList.add(qa(void 0,"drg"));const b=a.rawValue/this.props_.get("draggingScale"),d=b+(b>0?-1:b<0?1:0),f=O(-d,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${d+f},0 L${d},4 L${d+f},8`,`M ${b},-1 L${b},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${b},4`);const i=this.props_.get("formatter");this.tooltipElem_.textContent=i(this.value.rawValue),this.tooltipElem_.style.left=`${b}px`}refresh(){const a=this.props_.get("formatter");this.inputElement.value=a(this.value.rawValue)}onChange_(){this.refresh()}}class rb{constructor(a,b){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=b.baseStep,this.parser_=b.parser,this.props=b.props,this.value=b.value,this.viewProps=b.viewProps,this.dragging_=Y(null),this.view=new Rd(a,{arrayPosition:b.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const d=new Qa(this.view.knobElement);d.emitter.on("down",this.onPointerDown_),d.emitter.on("move",this.onPointerMove_),d.emitter.on("up",this.onPointerUp_)}onInputChange_(a){const b=H(a.currentTarget),d=b.value,f=this.parser_(d);A(f)||(this.value.rawValue=f),this.view.refresh()}onInputKeyDown_(a){const b=ka(this.baseStep_,$a(a));if(b===0)return;this.value.setRawValue(this.value.rawValue+b,{forceEmit:!1,last:!1})}onInputKeyUp_(a){const b=ka(this.baseStep_,$a(a));if(b===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(a){if(!a.point)return null;const b=a.point.x-a.bounds.width/2;return this.originRawValue_+b*this.props.get("draggingScale")}onPointerMove_(a){const b=this.computeDraggingValue_(a.data);if(b===null)return;this.value.setRawValue(b,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_}onPointerUp_(a){const b=this.computeDraggingValue_(a.data);if(b===null)return;this.value.setRawValue(b,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null}}const lc=z("sld");class Sd{constructor(a,b){this.onChange_=this.onChange_.bind(this),this.props_=b.props,this.props_.emitter.on("change",this.onChange_),this.element=a.createElement("div"),this.element.classList.add(lc()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("div");d.classList.add(lc("t")),b.viewProps.bindTabIndex(d),this.element.appendChild(d),this.trackElement=d;const f=a.createElement("div");f.classList.add(lc("k")),this.trackElement.appendChild(f),this.knobElement=f,b.value.emitter.on("change",this.onChange_),this.value=b.value,this.update_()}update_(){const a=O(T(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${a}%`}onChange_(){this.update_()}}class Td{constructor(a,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=b.baseStep,this.value=b.value,this.viewProps=b.viewProps,this.props=b.props,this.view=new Sd(a,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qa(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(a,b){if(!a.point)return;this.value.setRawValue(T(O(a.point.x,0,a.bounds.width),0,a.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),b)}onPointerDownOrMove_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerUp_(a){this.handlePointerEvent_(a.data,{forceEmit:!0,last:!0})}onKeyDown_(a){const b=ka(this.baseStep_,Fa(a));if(b===0)return;this.value.setRawValue(this.value.rawValue+b,{forceEmit:!1,last:!1})}onKeyUp_(a){const b=ka(this.baseStep_,Fa(a));if(b===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const mc=z("sldtxt");class Ud{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(mc());const d=a.createElement("div");d.classList.add(mc("s")),this.sliderView_=b.sliderView,d.appendChild(this.sliderView_.element),this.element.appendChild(d);const f=a.createElement("div");f.classList.add(mc("t")),this.textView_=b.textView,f.appendChild(this.textView_.element),this.element.appendChild(f)}}class nc{constructor(a,b){this.value=b.value,this.viewProps=b.viewProps,this.sliderC_=new Td(a,{baseStep:b.baseStep,props:b.sliderProps,value:b.value,viewProps:this.viewProps}),this.textC_=new rb(a,{baseStep:b.baseStep,parser:b.parser,props:b.textProps,value:b.value,viewProps:b.viewProps}),this.view=new Ud(a,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Ga(a,b){a.write(b)}function Gb(a){const b=S;return Array.isArray(a)?b.required.array(b.required.object({text:b.required.string,value:b.required.raw}))(a).value:typeof a==="object"?b.required.raw(a).value:void 0}function Yc(a){return a==="inline"||a==="popup"?a:void 0}function ua(a){const b=S;return b.required.object({max:b.optional.number,min:b.optional.number,step:b.optional.number})(a).value}function Zc(a){if(Array.isArray(a))return a;const b=[];return Object.keys(a).forEach(d=>{b.push({text:d,value:a[d]})}),b}function oc(a){return A(a)?null:new Ca(Zc(H(a)))}function pc(a){const b=a?sa(a,Ca):null;return b?b.options:null}function c(a){const b=a?sa(a,Ua):null;return b?b.step:null}function e(a,b){const d=a&&sa(a,Ua);return d?Xc(d.step):Math.max(Xc(b),2)}function g(a){const b=c(a);return b!==null&&b!==void 0?b:1}function h(a,b){var d;const f=a&&sa(a,Ua),i=Math.abs((d=f===null||f===void 0?void 0:f.step)!==null&&d!==void 0?d:b);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}const k=z("ckb");class o{constructor(a,b){this.onValueChange_=this.onValueChange_.bind(this),this.element=a.createElement("div"),this.element.classList.add(k()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("label");d.classList.add(k("l")),this.element.appendChild(d);const f=a.createElement("input");f.classList.add(k("i")),f.type="checkbox",d.appendChild(f),this.inputElement=f,b.viewProps.bindDisabled(this.inputElement);const i=a.createElement("div");i.classList.add(k("w")),d.appendChild(i);const l=I(a,"check");i.appendChild(l),b.value.emitter.on("change",this.onValueChange_),this.value=b.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class u{constructor(a,b){this.onInputChange_=this.onInputChange_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new o(a,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(a){const b=H(a.currentTarget);this.value.rawValue=b.checked}}function G(a){const b=[],d=oc(a.options);return d&&b.push(d),new V(b)}const ra={id:"input-bool",type:"input",accept:(a,b)=>{if(typeof a!=="boolean")return null;const d=S,f=N(b,{options:d.optional.custom(Gb)});return f?{initialValue:a,params:f}:null},binding:{reader:a=>Db,constraint:a=>G(a.params),writer:a=>Ga},controller:a=>{var b;const d=a.document,f=a.value,i=a.constraint;return i&&sa(i,Ca)?new ob(d,{props:C.fromObject({options:(b=pc(i))!==null&&b!==void 0?b:[]}),value:f,viewProps:a.viewProps}):new u(d,{value:f,viewProps:a.viewProps})}},fa=z("col");class qc{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(fa()),b.foldable.bindExpandedClass(this.element,fa(void 0,"expanded")),$(b.foldable,"completed",ba(this.element,fa(void 0,"cpl")));const d=a.createElement("div");d.classList.add(fa("h")),this.element.appendChild(d);const f=a.createElement("div");f.classList.add(fa("s")),d.appendChild(f),this.swatchElement=f;const i=a.createElement("div");i.classList.add(fa("t")),d.appendChild(i),this.textElement=i;if(b.pickerLayout==="inline"){const l=a.createElement("div");l.classList.add(fa("p")),this.element.appendChild(l),this.pickerElement=l}else this.pickerElement=null}}function Vd(a,b,d){const f=O(a/255,0,1),i=O(b/255,0,1),l=O(d/255,0,1),r=Math.max(f,i,l),x=Math.min(f,i,l),K=r-x;let D=0,Q=0;const U=(x+r)/2;return K!==0&&(Q=K/(1-Math.abs(r+x-1)),f===r?D=(i-l)/K:i===r?D=2+(l-f)/K:D=4+(f-i)/K,D=D/6+(D<0?1:0)),[D*360,Q*100,U*100]}function Wd(a,b,d){const f=(a%360+360)%360,i=O(b/100,0,1),l=O(d/100,0,1),r=(1-Math.abs(2*l-1))*i,x=r*(1-Math.abs(f/60%2-1)),K=l-r/2;let D,Q,U;return f>=0&&f<60?[D,Q,U]=[r,x,0]:f>=60&&f<120?[D,Q,U]=[x,r,0]:f>=120&&f<180?[D,Q,U]=[0,r,x]:f>=180&&f<240?[D,Q,U]=[0,x,r]:f>=240&&f<300?[D,Q,U]=[x,0,r]:[D,Q,U]=[r,0,x],[(D+K)*255,(Q+K)*255,(U+K)*255]}function ef(a,b,d){const f=O(a/255,0,1),i=O(b/255,0,1),l=O(d/255,0,1),r=Math.max(f,i,l),x=Math.min(f,i,l),K=r-x;let D;K===0?D=0:r===f?D=60*(((i-l)/K%6+6)%6):r===i?D=60*((l-f)/K+2):D=60*((f-i)/K+4);const Q=r===0?0:K/r,U=r;return[D,Q*100,U*100]}function xe(a,b,d){const f=kc(a,360),i=O(b/100,0,1),l=O(d/100,0,1),r=l*i,x=r*(1-Math.abs(f/60%2-1)),K=l-r;let D,Q,U;return f>=0&&f<60?[D,Q,U]=[r,x,0]:f>=60&&f<120?[D,Q,U]=[x,r,0]:f>=120&&f<180?[D,Q,U]=[0,r,x]:f>=180&&f<240?[D,Q,U]=[0,x,r]:f>=240&&f<300?[D,Q,U]=[x,0,r]:[D,Q,U]=[r,0,x],[(D+K)*255,(Q+K)*255,(U+K)*255]}function ff(a,b,d){const f=d+b*(100-Math.abs(2*d-100))/(2*100);return[a,f!==0?b*(100-Math.abs(2*d-100))/f:0,d+b*(100-Math.abs(2*d-100))/(2*100)]}function gf(a,b,d){const f=100-Math.abs(d*(200-b)/100-100);return[a,f!==0?b*d/f:0,d*(200-b)/(2*100)]}function Hb(a){return[a[0],a[1],a[2]]}function ye(a,b){return[a[0],a[1],a[2],b]}const hf={hsl:{hsl:(a,b,d)=>[a,b,d],hsv:ff,rgb:Wd},hsv:{hsl:gf,hsv:(a,b,d)=>[a,b,d],rgb:xe},rgb:{hsl:Vd,hsv:ef,rgb:(a,b,d)=>[a,b,d]}};function jf(a,b,d){return hf[b][d](...a)}const kf={hsl:a=>{var b;return[kc(a[0],360),O(a[1],0,100),O(a[2],0,100),O((b=a[3])!==null&&b!==void 0?b:1,0,1)]},hsv:a=>{var b;return[kc(a[0],360),O(a[1],0,100),O(a[2],0,100),O((b=a[3])!==null&&b!==void 0?b:1,0,1)]},rgb:a=>{var b;return[O(a[0],0,255),O(a[1],0,255),O(a[2],0,255),O((b=a[3])!==null&&b!==void 0?b:1,0,1)]}};function _c(a,b){return typeof a!=="object"||A(a)?!1:b in a&&typeof a[b]==="number"}class M{constructor(a,b){this.mode_=b,this.comps_=kf[b](a)}static black(){return new M([0,0,0],"rgb")}static fromObject(a){const b="a"in a?[a.r,a.g,a.b,a.a]:[a.r,a.g,a.b];return new M(b,"rgb")}static toRgbaObject(a){return a.toRgbaObject()}static isRgbColorObject(a){return _c(a,"r")&&_c(a,"g")&&_c(a,"b")}static isRgbaColorObject(a){return this.isRgbColorObject(a)&&_c(a,"a")}static isColorObject(a){return this.isRgbColorObject(a)}static equals(a,b){if(a.mode_!==b.mode_)return!1;const d=a.comps_,f=b.comps_;for(let i=0;i<d.length;i++)if(d[i]!==f[i])return!1;return!0}get mode(){return this.mode_}getComponents(a){return ye(jf(Hb(this.comps_),this.mode_,a||this.mode_),this.comps_[3])}toRgbaObject(){const a=this.getComponents("rgb");return{r:a[0],g:a[1],b:a[2],a:a[3]}}}const ab=z("colp");class lf{constructor(a,b){this.alphaViews_=null,this.element=a.createElement("div"),this.element.classList.add(ab());const d=a.createElement("div");d.classList.add(ab("hsv"));const f=a.createElement("div");f.classList.add(ab("sv")),this.svPaletteView_=b.svPaletteView,f.appendChild(this.svPaletteView_.element),d.appendChild(f);const i=a.createElement("div");i.classList.add(ab("h")),this.hPaletteView_=b.hPaletteView,i.appendChild(this.hPaletteView_.element),d.appendChild(i),this.element.appendChild(d);const l=a.createElement("div");l.classList.add(ab("rgb")),this.textView_=b.textView,l.appendChild(this.textView_.element),this.element.appendChild(l);if(b.alphaViews){this.alphaViews_={palette:b.alphaViews.palette,text:b.alphaViews.text};const r=a.createElement("div");r.classList.add(ab("a"));const x=a.createElement("div");x.classList.add(ab("ap")),x.appendChild(this.alphaViews_.palette.element),r.appendChild(x);const K=a.createElement("div");K.classList.add(ab("at")),K.appendChild(this.alphaViews_.text.element),r.appendChild(K),this.element.appendChild(r)}}get allFocusableElements(){const a=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(b=>b.inputElement)];return this.alphaViews_&&a.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),a}}function Xd(a){const b=S;return N(a,{alpha:b.optional.boolean,expanded:b.optional.boolean,picker:b.optional.custom(Yc)})}function sb(a){return a?.1:1}function va(a,b){const d=a.match(/^(.+)%$/);return d?Math.min(parseFloat(d[1])*.01*b,b):Math.min(parseFloat(a),b)}const mf={deg:a=>a,grad:a=>a*360/400,rad:a=>a*360/(2*Math.PI),turn:a=>a*360};function ze(a){const b=a.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!b)return parseFloat(a);const d=parseFloat(b[1]),f=b[2];return mf[f](d)}const Yd={"func.rgb":a=>{const b=a.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!b)return null;const d=[va(b[1],255),va(b[2],255),va(b[3],255)];return isNaN(d[0])||isNaN(d[1])||isNaN(d[2])?null:new M(d,"rgb")},"func.rgba":a=>{const b=a.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!b)return null;const d=[va(b[1],255),va(b[2],255),va(b[3],255),va(b[4],1)];return isNaN(d[0])||isNaN(d[1])||isNaN(d[2])||isNaN(d[3])?null:new M(d,"rgb")},"func.hsl":a=>{const b=a.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!b)return null;const d=[ze(b[1]),va(b[2],100),va(b[3],100)];return isNaN(d[0])||isNaN(d[1])||isNaN(d[2])?null:new M(d,"hsl")},"func.hsla":a=>{const b=a.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!b)return null;const d=[ze(b[1]),va(b[2],100),va(b[3],100),va(b[4],1)];return isNaN(d[0])||isNaN(d[1])||isNaN(d[2])||isNaN(d[3])?null:new M(d,"hsl")},"hex.rgb":a=>{const b=a.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(b)return new M([parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)],"rgb");const d=a.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return d?new M([parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)],"rgb"):null},"hex.rgba":a=>{const b=a.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(b)return new M([parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16),T(parseInt(b[4]+b[4],16),0,255,0,1)],"rgb");const d=a.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return d?new M([parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16),T(parseInt(d[4],16),0,255,0,1)],"rgb"):null}};function $c(a){const b=Object.keys(Yd);return b.reduce((d,f)=>{if(d)return d;const i=Yd[f];return i(a)?f:null},null)}const ad=a=>{const b=$c(a);return b?Yd[b](a):null};function nf(a){return a==="func.hsla"||a==="func.rgba"||a==="hex.rgba"}function of(a){if(typeof a==="string"){const b=ad(a);if(b)return b}return M.black()}function Ae(a){const b=O(Math.floor(a),0,255).toString(16);return b.length===1?`0${b}`:b}function Zd(a,b="#"){const d=Hb(a.getComponents("rgb")).map(Ae).join("");return`${b}${d}`}function bd(a,b="#"){const d=a.getComponents("rgb"),f=[d[0],d[1],d[2],d[3]*255].map(Ae).join("");return`${b}${f}`}function Be(a){const b=ja(0),d=Hb(a.getComponents("rgb")).map(f=>b(f));return`rgb(${d.join(", ")})`}function cd(a){const b=ja(2),d=ja(0),f=a.getComponents("rgb").map((i,l)=>{const r=l===3?b:d;return r(i)});return`rgba(${f.join(", ")})`}function pf(a){const b=[ja(0),Eb,Eb],d=Hb(a.getComponents("hsl")).map((f,i)=>b[i](f));return`hsl(${d.join(", ")})`}function qf(a){const b=[ja(0),Eb,Eb,ja(2)],d=a.getComponents("hsl").map((f,i)=>b[i](f));return`hsla(${d.join(", ")})`}const rf={"func.hsl":pf,"func.hsla":qf,"func.rgb":Be,"func.rgba":cd,"hex.rgb":Zd,"hex.rgba":bd};function Ce(a){return rf[a]}const rc=z("apl");class sf{constructor(a,b){this.onValueChange_=this.onValueChange_.bind(this),this.value=b.value,this.value.emitter.on("change",this.onValueChange_),this.element=a.createElement("div"),this.element.classList.add(rc()),b.viewProps.bindTabIndex(this.element);const d=a.createElement("div");d.classList.add(rc("b")),this.element.appendChild(d);const f=a.createElement("div");f.classList.add(rc("c")),d.appendChild(f),this.colorElem_=f;const i=a.createElement("div");i.classList.add(rc("m")),this.element.appendChild(i),this.markerElem_=i;const l=a.createElement("div");l.classList.add(rc("p")),this.markerElem_.appendChild(l),this.previewElem_=l,this.update_()}update_(){const a=this.value.rawValue,b=a.getComponents("rgb"),d=new M([b[0],b[1],b[2],0],"rgb"),f=new M([b[0],b[1],b[2],255],"rgb"),i=["to right",cd(d),cd(f)];this.colorElem_.style.background=`linear-gradient(${i.join(",")})`,this.previewElem_.style.backgroundColor=cd(a);const l=T(b[3],0,1,0,100);this.markerElem_.style.left=`${l}%`}onValueChange_(){this.update_()}}class tf{constructor(a,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new sf(a,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qa(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(a,b){if(!a.point)return;const d=a.point.x/a.bounds.width,f=this.value.rawValue,[i,l,r]=f.getComponents("hsv");this.value.setRawValue(new M([i,l,r,d],"hsv"),b)}onPointerDown_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerMove_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerUp_(a){this.handlePointerEvent_(a.data,{forceEmit:!0,last:!0})}onKeyDown_(a){const b=ka(sb(!0),Fa(a));if(b===0)return;const d=this.value.rawValue,[f,i,l,r]=d.getComponents("hsv");this.value.setRawValue(new M([f,i,l,r+b],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(a){const b=ka(sb(!0),Fa(a));if(b===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ib=z("coltxt");function uf(a){const b=a.createElement("select"),d=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return b.appendChild(d.reduce((f,i)=>{const l=a.createElement("option");return l.textContent=i.text,l.value=i.value,f.appendChild(l),f},a.createDocumentFragment())),b}class vf{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(Ib());const d=a.createElement("div");d.classList.add(Ib("m")),this.modeElem_=uf(a),this.modeElem_.classList.add(Ib("ms")),d.appendChild(this.modeSelectElement);const f=a.createElement("div");f.classList.add(Ib("mm")),f.appendChild(I(a,"dropdown")),d.appendChild(f),this.element.appendChild(d);const i=a.createElement("div");i.classList.add(Ib("w")),this.element.appendChild(i),this.textsElem_=i,this.textViews_=b.textViews,this.applyTextViews_(),aa(b.colorMode,l=>{this.modeElem_.value=l})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(a){this.textViews_=a,this.applyTextViews_()}applyTextViews_(){ya(this.textsElem_);const a=this.element.ownerDocument;this.textViews_.forEach(b=>{const d=a.createElement("div");d.classList.add(Ib("c")),d.appendChild(b.element),this.textsElem_.appendChild(d)})}}const wf=ja(0),xf={rgb:()=>new W({min:0,max:255}),hsl:a=>a===0?new W({min:0,max:360}):new W({min:0,max:100}),hsv:a=>a===0?new W({min:0,max:360}):new W({min:0,max:100})};function _d(a,b,d){return new rb(a,{arrayPosition:d===0?"fst":d===3-1?"lst":"mid",baseStep:sb(!1),parser:b.parser,props:C.fromObject({draggingScale:1,formatter:wf}),value:Y(0,{constraint:xf[b.colorMode](d)}),viewProps:b.viewProps})}class yf{constructor(a,b){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=b.parser,this.value=b.value,this.viewProps=b.viewProps,this.colorMode=Y(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(a),this.view=new vf(a,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(a){const b={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},d=[_d(a,b,0),_d(a,b,1),_d(a,b,2)];return d.forEach((f,i)=>{Ea({primary:this.value,secondary:f.value,forward:l=>l.rawValue.getComponents(this.colorMode.rawValue)[i],backward:(l,r)=>{const x=this.colorMode.rawValue,K=l.rawValue.getComponents(x);return K[i]=r.rawValue,new M(ye(Hb(K),K[3]),x)}})}),d}onModeSelectChange_(a){const b=a.currentTarget;this.colorMode.rawValue=b.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const $d=z("hpl");class zf{constructor(a,b){this.onValueChange_=this.onValueChange_.bind(this),this.value=b.value,this.value.emitter.on("change",this.onValueChange_),this.element=a.createElement("div"),this.element.classList.add($d()),b.viewProps.bindTabIndex(this.element);const d=a.createElement("div");d.classList.add($d("c")),this.element.appendChild(d);const f=a.createElement("div");f.classList.add($d("m")),this.element.appendChild(f),this.markerElem_=f,this.update_()}update_(){const a=this.value.rawValue,[b]=a.getComponents("hsv");this.markerElem_.style.backgroundColor=Be(new M([b,100,100],"hsv"));const d=T(b,0,360,0,100);this.markerElem_.style.left=`${d}%`}onValueChange_(){this.update_()}}class Af{constructor(a,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new zf(a,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qa(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(a,b){if(!a.point)return;const d=T(O(a.point.x,0,a.bounds.width),0,a.bounds.width,0,359),f=this.value.rawValue,[,i,l,r]=f.getComponents("hsv");this.value.setRawValue(new M([d,i,l,r],"hsv"),b)}onPointerDown_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerMove_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerUp_(a){this.handlePointerEvent_(a.data,{forceEmit:!0,last:!0})}onKeyDown_(a){const b=ka(sb(!1),Fa(a));if(b===0)return;const d=this.value.rawValue,[f,i,l,r]=d.getComponents("hsv");this.value.setRawValue(new M([f+b,i,l,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(a){const b=ka(sb(!1),Fa(a));if(b===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const ae=z("svp"),De=64;class Bf{constructor(a,b){this.onValueChange_=this.onValueChange_.bind(this),this.value=b.value,this.value.emitter.on("change",this.onValueChange_),this.element=a.createElement("div"),this.element.classList.add(ae()),b.viewProps.bindTabIndex(this.element);const d=a.createElement("canvas");d.height=De,d.width=De,d.classList.add(ae("c")),this.element.appendChild(d),this.canvasElement=d;const f=a.createElement("div");f.classList.add(ae("m")),this.element.appendChild(f),this.markerElem_=f,this.update_()}update_(){const a=F(this.canvasElement);if(!a)return;const b=this.value.rawValue,d=b.getComponents("hsv"),f=this.canvasElement.width,i=this.canvasElement.height,l=a.getImageData(0,0,f,i),r=l.data;for(let D=0;D<i;D++)for(let Q=0;Q<f;Q++){const U=T(Q,0,f,0,100),tb=T(D,0,i,100,0),tc=xe(d[0],U,tb),Mb=(D*f+Q)*4;r[Mb]=tc[0],r[Mb+1]=tc[1],r[Mb+2]=tc[2],r[Mb+3]=255}a.putImageData(l,0,0);const x=T(d[1],0,100,0,100);this.markerElem_.style.left=`${x}%`;const K=T(d[2],0,100,100,0);this.markerElem_.style.top=`${K}%`}onValueChange_(){this.update_()}}class Cf{constructor(a,b){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.view=new Bf(a,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qa(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(a,b){if(!a.point)return;const d=T(a.point.x,0,a.bounds.width,0,100),f=T(a.point.y,0,a.bounds.height,100,0),[i,,,l]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new M([i,d,f,l],"hsv"),b)}onPointerDown_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerMove_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerUp_(a){this.handlePointerEvent_(a.data,{forceEmit:!0,last:!0})}onKeyDown_(a){la(a.key)&&a.preventDefault();const[b,d,f,i]=this.value.rawValue.getComponents("hsv"),l=sb(!1),r=ka(l,Fa(a)),x=ka(l,$a(a));if(r===0&&x===0)return;this.value.setRawValue(new M([b,d+r,f+x,i],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(a){const b=sb(!1),d=ka(b,Fa(a)),f=ka(b,$a(a));if(d===0&&f===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Df{constructor(a,b){this.value=b.value,this.viewProps=b.viewProps,this.hPaletteC_=new Af(a,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Cf(a,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=b.supportsAlpha?{palette:new tf(a,{value:this.value,viewProps:this.viewProps}),text:new rb(a,{parser:ia,baseStep:.1,props:C.fromObject({draggingScale:.01,formatter:ja(2)}),value:Y(0,{constraint:new W({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ea({primary:this.value,secondary:this.alphaIcs_.text.value,forward:d=>d.rawValue.getComponents()[3],backward:(d,f)=>{const i=d.rawValue.getComponents();return i[3]=f.rawValue,new M(i,d.rawValue.mode)}}),this.textC_=new yf(a,{parser:ia,value:this.value,viewProps:this.viewProps}),this.view=new lf(a,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:b.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const be=z("colsw");class Ef{constructor(a,b){this.onValueChange_=this.onValueChange_.bind(this),b.value.emitter.on("change",this.onValueChange_),this.value=b.value,this.element=a.createElement("div"),this.element.classList.add(be()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("div");d.classList.add(be("sw")),this.element.appendChild(d),this.swatchElem_=d;const f=a.createElement("button");f.classList.add(be("b")),b.viewProps.bindDisabled(f),this.element.appendChild(f),this.buttonElement=f,this.update_()}update_(){const a=this.value.rawValue;this.swatchElem_.style.backgroundColor=bd(a)}onValueChange_(){this.update_()}}class Ff{constructor(a,b){this.value=b.value,this.viewProps=b.viewProps,this.view=new Ef(a,{value:this.value,viewProps:this.viewProps})}}class ce{constructor(a,b){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.foldable_=ib.create(b.expanded),this.swatchC_=new Ff(a,{value:this.value,viewProps:this.viewProps});const d=this.swatchC_.view.buttonElement;d.addEventListener("blur",this.onButtonBlur_),d.addEventListener("click",this.onButtonClick_),this.textC_=new Cb(a,{parser:b.parser,props:C.fromObject({formatter:b.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new qc(a,{foldable:this.foldable_,pickerLayout:b.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=b.pickerLayout==="popup"?new Jc(a,{viewProps:this.viewProps}):null;const f=new Df(a,{supportsAlpha:b.supportsAlpha,value:this.value,viewProps:this.viewProps});f.view.allFocusableElements.forEach(i=>{i.addEventListener("blur",this.onPopupChildBlur_),i.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=f,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(f.view.element),Ea({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:i=>i.rawValue,backward:(i,l)=>l.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),yb(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(a){if(!this.popC_)return;const b=this.view.element,d=H(a.relatedTarget);(!d||!b.contains(d))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(a){if(!this.popC_)return;const b=this.popC_.view.element,d=Rb(a);if(d&&b.contains(d))return;if(d&&d===this.swatchC_.view.buttonElement&&!Ka(b.ownerDocument))return;this.popC_.shows.rawValue=!1}onPopupChildKeydown_(a){this.popC_?a.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&(a.key==="Escape"&&this.swatchC_.view.buttonElement.focus())}}function Gf(a){return M.isColorObject(a)?M.fromObject(a):M.black()}function Hf(a){return Hb(a.getComponents("rgb")).reduce((b,d)=>b<<8|Math.floor(d)&255,0)}function If(a){return a.getComponents("rgb").reduce((b,d,f)=>{const i=Math.floor(f===3?d*255:d)&255;return b<<8|i},0)>>>0}function Jf(a){return new M([a>>16&255,a>>8&255,a&255],"rgb")}function Kf(a){return new M([a>>24&255,a>>16&255,a>>8&255,T(a&255,0,255,0,1)],"rgb")}function Lf(a){return typeof a!=="number"?M.black():Jf(a)}function Mf(a){return typeof a!=="number"?M.black():Kf(a)}function Nf(a){const b=Ce(a);return(d,f)=>{Ga(d,b(f))}}function Of(a){const b=a?If:Hf;return(d,f)=>{Ga(d,b(f))}}function Pf(a,b){const d=b.toRgbaObject();a.writeProperty("r",d.r),a.writeProperty("g",d.g),a.writeProperty("b",d.b),a.writeProperty("a",d.a)}function Qf(a,b){const d=b.toRgbaObject();a.writeProperty("r",d.r),a.writeProperty("g",d.g),a.writeProperty("b",d.b)}function Rf(a){return a?Pf:Qf}function de(a){return"alpha"in a&&a.alpha===!0}function Sf(a){return a?b=>bd(b,"0x"):b=>Zd(b,"0x")}const Tf={id:"input-color-number",type:"input",accept:(a,b)=>{if(typeof a!=="number")return null;if(!("view"in b))return null;if(b.view!=="color")return null;const d=Xd(b);return d?{initialValue:a,params:d}:null},binding:{reader:a=>de(a.params)?Mf:Lf,equals:M.equals,writer:a=>Of(de(a.params))},controller:a=>{const b=de(a.params),d="expanded"in a.params?a.params.expanded:void 0,f="picker"in a.params?a.params.picker:void 0;return new ce(a.document,{expanded:d!==null&&d!==void 0?d:!1,formatter:Sf(b),parser:ad,pickerLayout:f!==null&&f!==void 0?f:"popup",supportsAlpha:b,value:a.value,viewProps:a.viewProps})}};function Uf(a){return M.isRgbaColorObject(a)}const Vf={id:"input-color-object",type:"input",accept:(a,b)=>{if(!M.isColorObject(a))return null;const d=Xd(b);return d?{initialValue:a,params:d}:null},binding:{reader:a=>Gf,equals:M.equals,writer:a=>Rf(Uf(a.initialValue))},controller:a=>{const b=M.isRgbaColorObject(a.initialValue),d="expanded"in a.params?a.params.expanded:void 0,f="picker"in a.params?a.params.picker:void 0,i=b?bd:Zd;return new ce(a.document,{expanded:d!==null&&d!==void 0?d:!1,formatter:i,parser:ad,pickerLayout:f!==null&&f!==void 0?f:"popup",supportsAlpha:b,value:a.value,viewProps:a.viewProps})}},Wf={id:"input-color-string",type:"input",accept:(a,b)=>{if(typeof a!=="string")return null;if("view"in b&&b.view==="text")return null;const d=$c(a);if(!d)return null;const f=Xd(b);return f?{initialValue:a,params:f}:null},binding:{reader:a=>of,equals:M.equals,writer:a=>{const b=$c(a.initialValue);if(!b)throw n.shouldNeverHappen();return Nf(b)}},controller:a=>{const b=$c(a.initialValue);if(!b)throw n.shouldNeverHappen();const d=Ce(b),f="expanded"in a.params?a.params.expanded:void 0,i="picker"in a.params?a.params.picker:void 0;return new ce(a.document,{expanded:f!==null&&f!==void 0?f:!1,formatter:d,parser:ad,pickerLayout:i!==null&&i!==void 0?i:"popup",supportsAlpha:nf(b),value:a.value,viewProps:a.viewProps})}};class bb{constructor(a){this.components=a.components,this.asm_=a.assembly}constrain(a){const b=this.asm_.toComponents(a).map((d,f)=>{var i,l;return(l=(i=this.components[f])===null||i===void 0?void 0:i.constrain(d))!==null&&l!==void 0?l:d});return this.asm_.fromComponents(b)}}const Ee=z("pndtxt");class Xf{constructor(a,b){this.textViews=b.textViews,this.element=a.createElement("div"),this.element.classList.add(Ee()),this.textViews.forEach(d=>{const f=a.createElement("div");f.classList.add(Ee("a")),f.appendChild(d.element),this.element.appendChild(f)})}}function Yf(a,b,d){return new rb(a,{arrayPosition:d===0?"fst":d===b.axes.length-1?"lst":"mid",baseStep:b.axes[d].baseStep,parser:b.parser,props:b.axes[d].textProps,value:Y(0,{constraint:b.axes[d].constraint}),viewProps:b.viewProps})}class ee{constructor(a,b){this.value=b.value,this.viewProps=b.viewProps,this.acs_=b.axes.map((d,f)=>Yf(a,b,f)),this.acs_.forEach((d,f)=>{Ea({primary:this.value,secondary:d.value,forward:i=>b.assembly.toComponents(i.rawValue)[f],backward:(i,l)=>{const r=b.assembly.toComponents(i.rawValue);return r[f]=l.rawValue,b.assembly.fromComponents(r)}})}),this.view=new Xf(a,{textViews:this.acs_.map(d=>d.view)})}}function Zf(a){return"step"in a&&!A(a.step)?new Ua(a.step):null}function _f(a){return"max"in a&&!A(a.max)||"min"in a&&!A(a.min)?new W({max:a.max,min:a.min}):null}function $f(a){const b=[],d=Zf(a);d&&b.push(d);const f=_f(a);f&&b.push(f);const i=oc(a.options);return i&&b.push(i),new V(b)}function ag(a){const b=a?sa(a,W):null;return b?[b.minValue,b.maxValue]:[void 0,void 0]}function bg(a){const[b,d]=ag(a);return[b!==null&&b!==void 0?b:0,d!==null&&d!==void 0?d:100]}const cg={id:"input-number",type:"input",accept:(a,b)=>{if(typeof a!=="number")return null;const d=S,f=N(b,{format:d.optional.function,max:d.optional.number,min:d.optional.number,options:d.optional.custom(Gb),step:d.optional.number});return f?{initialValue:a,params:f}:null},binding:{reader:a=>Uc,constraint:a=>$f(a.params),writer:a=>Ga},controller:a=>{var b,d;const f=a.value,i=a.constraint;if(i&&sa(i,Ca))return new ob(a.document,{props:C.fromObject({options:(b=pc(i))!==null&&b!==void 0?b:[]}),value:f,viewProps:a.viewProps});const l=(d="format"in a.params?a.params.format:void 0)!==null&&d!==void 0?d:ja(e(i,f.rawValue));if(i&&sa(i,W)){const[r,x]=bg(i);return new nc(a.document,{baseStep:g(i),parser:ia,sliderProps:C.fromObject({maxValue:x,minValue:r}),textProps:C.fromObject({draggingScale:h(i,f.rawValue),formatter:l}),value:f,viewProps:a.viewProps})}return new rb(a.document,{baseStep:g(i),parser:ia,props:C.fromObject({draggingScale:h(i,f.rawValue),formatter:l}),value:f,viewProps:a.viewProps})}};class cb{constructor(a=0,b=0){this.x=a,this.y=b}getComponents(){return[this.x,this.y]}static isObject(a){if(A(a))return!1;const b=a.x,d=a.y;return typeof b!=="number"||typeof d!=="number"?!1:!0}static equals(a,b){return a.x===b.x&&a.y===b.y}toObject(){return{x:this.x,y:this.y}}}const Fe={toComponents:a=>a.getComponents(),fromComponents:a=>new cb(...a)},Jb=z("p2d");class dg{constructor(a,b){this.element=a.createElement("div"),this.element.classList.add(Jb()),b.viewProps.bindClassModifiers(this.element),aa(b.expanded,ba(this.element,Jb(void 0,"expanded")));const d=a.createElement("div");d.classList.add(Jb("h")),this.element.appendChild(d);const f=a.createElement("button");f.classList.add(Jb("b")),f.appendChild(I(a,"p2dpad")),b.viewProps.bindDisabled(f),d.appendChild(f),this.buttonElement=f;const i=a.createElement("div");i.classList.add(Jb("t")),d.appendChild(i),this.textElement=i;if(b.pickerLayout==="inline"){const l=a.createElement("div");l.classList.add(Jb("p")),this.element.appendChild(l),this.pickerElement=l}else this.pickerElement=null}}const db=z("p2dp");class eg{constructor(a,b){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=b.invertsY,this.maxValue_=b.maxValue,this.element=a.createElement("div"),this.element.classList.add(db()),b.layout==="popup"&&this.element.classList.add(db(void 0,"p"));const d=a.createElement("div");d.classList.add(db("p")),b.viewProps.bindTabIndex(d),this.element.appendChild(d),this.padElement=d;const f=a.createElementNS(ca,"svg");f.classList.add(db("g")),this.padElement.appendChild(f),this.svgElem_=f;const i=a.createElementNS(ca,"line");i.classList.add(db("ax")),i.setAttributeNS(null,"x1","0"),i.setAttributeNS(null,"y1","50%"),i.setAttributeNS(null,"x2","100%"),i.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(i);const l=a.createElementNS(ca,"line");l.classList.add(db("ax")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","0"),l.setAttributeNS(null,"x2","50%"),l.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(l);const r=a.createElementNS(ca,"line");r.classList.add(db("l")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(r),this.lineElem_=r;const x=a.createElement("div");x.classList.add(db("m")),this.padElement.appendChild(x),this.markerElem_=x,b.value.emitter.on("change",this.onValueChange_),this.value=b.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[a,b]=this.value.rawValue.getComponents(),d=this.maxValue_,f=T(a,-d,+d,0,100),i=T(b,-d,+d,0,100),l=this.invertsY_?100-i:i;this.lineElem_.setAttributeNS(null,"x2",`${f}%`),this.lineElem_.setAttributeNS(null,"y2",`${l}%`),this.markerElem_.style.left=`${f}%`,this.markerElem_.style.top=`${l}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Ge(a,b,d){return[ka(b[0],Fa(a)),ka(b[1],$a(a))*(d?1:-1)]}class fg{constructor(a,b){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.baseSteps_=b.baseSteps,this.maxValue_=b.maxValue,this.invertsY_=b.invertsY,this.view=new eg(a,{invertsY:this.invertsY_,layout:b.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qa(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(a,b){if(!a.point)return;const d=this.maxValue_,f=T(a.point.x,0,a.bounds.width,-d,+d),i=T(this.invertsY_?a.bounds.height-a.point.y:a.point.y,0,a.bounds.height,-d,+d);this.value.setRawValue(new cb(f,i),b)}onPointerDown_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerMove_(a){this.handlePointerEvent_(a.data,{forceEmit:!1,last:!1})}onPointerUp_(a){this.handlePointerEvent_(a.data,{forceEmit:!0,last:!0})}onPadKeyDown_(a){la(a.key)&&a.preventDefault();const[b,d]=Ge(a,this.baseSteps_,this.invertsY_);if(b===0&&d===0)return;this.value.setRawValue(new cb(this.value.rawValue.x+b,this.value.rawValue.y+d),{forceEmit:!1,last:!1})}onPadKeyUp_(a){const[b,d]=Ge(a,this.baseSteps_,this.invertsY_);if(b===0&&d===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class gg{constructor(a,b){var d,f;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.foldable_=ib.create(b.expanded),this.popC_=b.pickerLayout==="popup"?new Jc(a,{viewProps:this.viewProps}):null;const i=new fg(a,{baseSteps:[b.axes[0].baseStep,b.axes[1].baseStep],invertsY:b.invertsY,layout:b.pickerLayout,maxValue:b.maxValue,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach(l=>{l.addEventListener("blur",this.onPopupChildBlur_),l.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=i,this.textC_=new ee(a,{assembly:Fe,axes:b.axes,parser:b.parser,value:this.value,viewProps:this.viewProps}),this.view=new dg(a,{expanded:this.foldable_.value("expanded"),pickerLayout:b.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(d=this.view.buttonElement)===null||d===void 0||d.addEventListener("blur",this.onPadButtonBlur_),(f=this.view.buttonElement)===null||f===void 0||f.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ea({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:l=>l.rawValue,backward:(l,r)=>r.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),yb(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(a){if(!this.popC_)return;const b=this.view.element,d=H(a.relatedTarget);(!d||!b.contains(d))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(a){if(!this.popC_)return;const b=this.popC_.view.element,d=Rb(a);if(d&&b.contains(d))return;if(d&&d===this.view.buttonElement&&!Ka(b.ownerDocument))return;this.popC_.shows.rawValue=!1}onPopupChildKeydown_(a){this.popC_?a.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&(a.key==="Escape"&&this.view.buttonElement.focus())}}function hg(a){return cb.isObject(a)?new cb(a.x,a.y):new cb()}function ig(a,b){a.writeProperty("x",b.x),a.writeProperty("y",b.y)}function He(a){if(!a)return;const b=[];return A(a.step)||b.push(new Ua(a.step)),(!A(a.max)||!A(a.min))&&b.push(new W({max:a.max,min:a.min})),new V(b)}function jg(a){return new bb({assembly:Fe,components:[He("x"in a?a.x:void 0),He("y"in a?a.y:void 0)]})}function Ie(a,b){const d=a&&sa(a,W);if(d)return Math.max(Math.abs(d.minValue||0),Math.abs(d.maxValue||0));const f=g(a);return Math.max(Math.abs(f)*10,Math.abs(b)*10)}function kg(a,b){const d=b instanceof bb?b.components[0]:void 0,f=b instanceof bb?b.components[1]:void 0,i=Ie(d,a.x),l=Ie(f,a.y);return Math.max(i,l)}function Je(a,b){return{baseStep:g(b),constraint:b,textProps:C.fromObject({draggingScale:h(b,a),formatter:ja(e(b,a))})}}function lg(a){if(!("y"in a))return!1;const b=a.y;return b?"inverted"in b?!!b.inverted:!1:!1}const mg={id:"input-point2d",type:"input",accept:(a,b)=>{if(!cb.isObject(a))return null;const d=S,f=N(b,{expanded:d.optional.boolean,picker:d.optional.custom(Yc),x:d.optional.custom(ua),y:d.optional.object({inverted:d.optional.boolean,max:d.optional.number,min:d.optional.number,step:d.optional.number})});return f?{initialValue:a,params:f}:null},binding:{reader:a=>hg,constraint:a=>jg(a.params),equals:cb.equals,writer:a=>ig},controller:a=>{const b=a.document,d=a.value,f=a.constraint;if(!(f instanceof bb))throw n.shouldNeverHappen();const i="expanded"in a.params?a.params.expanded:void 0,l="picker"in a.params?a.params.picker:void 0;return new gg(b,{axes:[Je(d.rawValue.x,f.components[0]),Je(d.rawValue.y,f.components[1])],expanded:i!==null&&i!==void 0?i:!1,invertsY:lg(a.params),maxValue:kg(d.rawValue,f),parser:ia,pickerLayout:l!==null&&l!==void 0?l:"popup",value:d,viewProps:a.viewProps})}};class Kb{constructor(a=0,b=0,d=0){this.x=a,this.y=b,this.z=d}getComponents(){return[this.x,this.y,this.z]}static isObject(a){if(A(a))return!1;const b=a.x,d=a.y,f=a.z;return typeof b!=="number"||typeof d!=="number"||typeof f!=="number"?!1:!0}static equals(a,b){return a.x===b.x&&a.y===b.y&&a.z===b.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Ke={toComponents:a=>a.getComponents(),fromComponents:a=>new Kb(...a)};function ng(a){return Kb.isObject(a)?new Kb(a.x,a.y,a.z):new Kb()}function og(a,b){a.writeProperty("x",b.x),a.writeProperty("y",b.y),a.writeProperty("z",b.z)}function fe(a){if(!a)return;const b=[];return A(a.step)||b.push(new Ua(a.step)),(!A(a.max)||!A(a.min))&&b.push(new W({max:a.max,min:a.min})),new V(b)}function pg(a){return new bb({assembly:Ke,components:[fe("x"in a?a.x:void 0),fe("y"in a?a.y:void 0),fe("z"in a?a.z:void 0)]})}function ge(a,b){return{baseStep:g(b),constraint:b,textProps:C.fromObject({draggingScale:h(b,a),formatter:ja(e(b,a))})}}const qg={id:"input-point3d",type:"input",accept:(a,b)=>{if(!Kb.isObject(a))return null;const d=S,f=N(b,{x:d.optional.custom(ua),y:d.optional.custom(ua),z:d.optional.custom(ua)});return f?{initialValue:a,params:f}:null},binding:{reader:a=>ng,constraint:a=>pg(a.params),equals:Kb.equals,writer:a=>og},controller:a=>{const b=a.value,d=a.constraint;if(!(d instanceof bb))throw n.shouldNeverHappen();return new ee(a.document,{assembly:Ke,axes:[ge(b.rawValue.x,d.components[0]),ge(b.rawValue.y,d.components[1]),ge(b.rawValue.z,d.components[2])],parser:ia,value:b,viewProps:a.viewProps})}};class Lb{constructor(a=0,b=0,d=0,f=0){this.x=a,this.y=b,this.z=d,this.w=f}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(a){if(A(a))return!1;const b=a.x,d=a.y,f=a.z,i=a.w;return typeof b!=="number"||typeof d!=="number"||typeof f!=="number"||typeof i!=="number"?!1:!0}static equals(a,b){return a.x===b.x&&a.y===b.y&&a.z===b.z&&a.w===b.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Le={toComponents:a=>a.getComponents(),fromComponents:a=>new Lb(...a)};function rg(a){return Lb.isObject(a)?new Lb(a.x,a.y,a.z,a.w):new Lb()}function sg(a,b){a.writeProperty("x",b.x),a.writeProperty("y",b.y),a.writeProperty("z",b.z),a.writeProperty("w",b.w)}function dd(a){if(!a)return;const b=[];return A(a.step)||b.push(new Ua(a.step)),(!A(a.max)||!A(a.min))&&b.push(new W({max:a.max,min:a.min})),new V(b)}function tg(a){return new bb({assembly:Le,components:[dd("x"in a?a.x:void 0),dd("y"in a?a.y:void 0),dd("z"in a?a.z:void 0),dd("w"in a?a.w:void 0)]})}function ug(a,b){return{baseStep:g(b),constraint:b,textProps:C.fromObject({draggingScale:h(b,a),formatter:ja(e(b,a))})}}const vg={id:"input-point4d",type:"input",accept:(a,b)=>{if(!Lb.isObject(a))return null;const d=S,f=N(b,{x:d.optional.custom(ua),y:d.optional.custom(ua),z:d.optional.custom(ua),w:d.optional.custom(ua)});return f?{initialValue:a,params:f}:null},binding:{reader:a=>rg,constraint:a=>tg(a.params),equals:Lb.equals,writer:a=>sg},controller:a=>{const b=a.value,d=a.constraint;if(!(d instanceof bb))throw n.shouldNeverHappen();return new ee(a.document,{assembly:Le,axes:b.rawValue.getComponents().map((f,i)=>ug(f,d.components[i])),parser:ia,value:b,viewProps:a.viewProps})}};function wg(a){const b=[],d=oc(a.options);return d&&b.push(d),new V(b)}const xg={id:"input-string",type:"input",accept:(a,b)=>{if(typeof a!=="string")return null;const d=S,f=N(b,{options:d.optional.custom(Gb)});return f?{initialValue:a,params:f}:null},binding:{reader:a=>ic,constraint:a=>wg(a.params),writer:a=>Ga},controller:a=>{var b;const d=a.document,f=a.value,i=a.constraint;return i&&sa(i,Ca)?new ob(d,{props:C.fromObject({options:(b=pc(i))!==null&&b!==void 0?b:[]}),value:f,viewProps:a.viewProps}):new Cb(d,{parser:l=>l,props:C.fromObject({formatter:jc}),value:f,viewProps:a.viewProps})}},sc={monitor:{defaultInterval:200,defaultLineCount:3}},Me=z("mll");class yg{constructor(a,b){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=b.formatter,this.element=a.createElement("div"),this.element.classList.add(Me()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("textarea");d.classList.add(Me("i")),d.style.height=`calc(var(--bld-us) * ${b.lineCount})`,d.readOnly=!0,b.viewProps.bindDisabled(d),this.element.appendChild(d),this.textareaElem_=d,b.value.emitter.on("change",this.onValueUpdate_),this.value=b.value,this.update_()}update_(){const a=this.textareaElem_,b=a.scrollTop===a.scrollHeight-a.clientHeight,d=[];this.value.rawValue.forEach(f=>{f!==void 0&&d.push(this.formatter_(f))}),a.textContent=d.join(`
`),b&&(a.scrollTop=a.scrollHeight)}onValueUpdate_(){this.update_()}}class he{constructor(a,b){this.value=b.value,this.viewProps=b.viewProps,this.view=new yg(a,{formatter:b.formatter,lineCount:b.lineCount,value:this.value,viewProps:this.viewProps})}}const Ne=z("sgl");class zg{constructor(a,b){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=b.formatter,this.element=a.createElement("div"),this.element.classList.add(Ne()),b.viewProps.bindClassModifiers(this.element);const d=a.createElement("input");d.classList.add(Ne("i")),d.readOnly=!0,d.type="text",b.viewProps.bindDisabled(d),this.element.appendChild(d),this.inputElement=d,b.value.emitter.on("change",this.onValueUpdate_),this.value=b.value,this.update_()}update_(){const a=this.value.rawValue,b=a[a.length-1];this.inputElement.value=b!==void 0?this.formatter_(b):""}onValueUpdate_(){this.update_()}}class ie{constructor(a,b){this.value=b.value,this.viewProps=b.viewProps,this.view=new zg(a,{formatter:b.formatter,value:this.value,viewProps:this.viewProps})}}const Ag={id:"monitor-bool",type:"monitor",accept:(a,b)=>{if(typeof a!=="boolean")return null;const d=S,f=N(b,{lineCount:d.optional.number});return f?{initialValue:a,params:f}:null},binding:{reader:a=>Db},controller:a=>{var b;return a.value.rawValue.length===1?new ie(a.document,{formatter:Mc,value:a.value,viewProps:a.viewProps}):new he(a.document,{formatter:Mc,lineCount:(b=a.params.lineCount)!==null&&b!==void 0?b:sc.monitor.defaultLineCount,value:a.value,viewProps:a.viewProps})}};class Bg{constructor(){this.emitter=new v(),this.index_=-1}get index(){return this.index_}set index(a){const b=this.index_!==a;b&&(this.index_=a,this.emitter.emit("change",{index:a,sender:this}))}}const eb=z("grl");class Cg{constructor(a,b){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=a.createElement("div"),this.element.classList.add(eb()),b.viewProps.bindClassModifiers(this.element),this.formatter_=b.formatter,this.minValue_=b.minValue,this.maxValue_=b.maxValue,this.cursor_=b.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const d=a.createElementNS(ca,"svg");d.classList.add(eb("g")),d.style.height=`calc(var(--bld-us) * ${b.lineCount})`,this.element.appendChild(d),this.svgElem_=d;const f=a.createElementNS(ca,"polyline");this.svgElem_.appendChild(f),this.lineElem_=f;const i=a.createElement("div");i.classList.add(eb("t"),z("tt")()),this.element.appendChild(i),this.tooltipElem_=i,b.value.emitter.on("change",this.onValueUpdate_),this.value=b.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const a=this.svgElem_.getBoundingClientRect(),b=this.value.rawValue.length-1,d=this.minValue_,f=this.maxValue_,i=[];this.value.rawValue.forEach((D,Q)=>{if(D===void 0)return;const U=T(Q,0,b,0,a.width),tb=T(D,d,f,a.height,0);i.push([U,tb].join(","))}),this.lineElem_.setAttributeNS(null,"points",i.join(" "));const l=this.tooltipElem_,r=this.value.rawValue[this.cursor_.index];if(r===void 0){l.classList.remove(eb("t","a"));return}const x=T(this.cursor_.index,0,b,0,a.width),K=T(r,d,f,a.height,0);l.style.left=`${x}px`,l.style.top=`${K}px`,l.textContent=`${this.formatter_(r)}`,l.classList.contains(eb("t","a"))||(l.classList.add(eb("t","a"),eb("t","in")),Za(l),l.classList.remove(eb("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Dg{constructor(a,b){this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=b.value,this.viewProps=b.viewProps,this.cursor_=new Bg(),this.view=new Cg(a,{cursor:this.cursor_,formatter:b.formatter,lineCount:b.lineCount,maxValue:b.maxValue,minValue:b.minValue,value:this.value,viewProps:this.viewProps});if(!Ka(a))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const d=new Qa(this.view.element);d.emitter.on("down",this.onGraphPointerDown_),d.emitter.on("move",this.onGraphPointerMove_),d.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(a){const b=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(T(a.offsetX,0,b.width,0,this.value.rawValue.length))}onGraphPointerDown_(a){this.onGraphPointerMove_(a)}onGraphPointerMove_(a){if(!a.data.point){this.cursor_.index=-1;return}this.cursor_.index=Math.floor(T(a.data.point.x,0,a.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.index=-1}}function je(a){return"format"in a&&!A(a.format)?a.format:ja(2)}function Eg(a){var b;return a.value.rawValue.length===1?new ie(a.document,{formatter:je(a.params),value:a.value,viewProps:a.viewProps}):new he(a.document,{formatter:je(a.params),lineCount:(b=a.params.lineCount)!==null&&b!==void 0?b:sc.monitor.defaultLineCount,value:a.value,viewProps:a.viewProps})}function Fg(a){var b,d,f;return new Dg(a.document,{formatter:je(a.params),lineCount:(b=a.params.lineCount)!==null&&b!==void 0?b:sc.monitor.defaultLineCount,maxValue:(d="max"in a.params?a.params.max:null)!==null&&d!==void 0?d:100,minValue:(f="min"in a.params?a.params.min:null)!==null&&f!==void 0?f:0,value:a.value,viewProps:a.viewProps})}function Oe(a){return"view"in a&&a.view==="graph"}const Gg={id:"monitor-number",type:"monitor",accept:(a,b)=>{if(typeof a!=="number")return null;const d=S,f=N(b,{format:d.optional.function,lineCount:d.optional.number,max:d.optional.number,min:d.optional.number,view:d.optional.string});return f?{initialValue:a,params:f}:null},binding:{defaultBufferSize:a=>Oe(a)?64:1,reader:a=>Uc},controller:a=>Oe(a.params)?Fg(a):Eg(a)},Hg={id:"monitor-string",type:"monitor",accept:(a,b)=>{if(typeof a!=="string")return null;const d=S,f=N(b,{lineCount:d.optional.number,multiline:d.optional.boolean});return f?{initialValue:a,params:f}:null},binding:{reader:a=>ic},controller:a=>{var b;const d=a.value,f=d.rawValue.length>1||"multiline"in a.params&&a.params.multiline;return f?new he(a.document,{formatter:jc,lineCount:(b=a.params.lineCount)!==null&&b!==void 0?b:sc.monitor.defaultLineCount,value:d,viewProps:a.viewProps}):new ie(a.document,{formatter:jc,value:d,viewProps:a.viewProps})}};class Ig{constructor(a){this.onValueChange_=this.onValueChange_.bind(this),this.reader=a.reader,this.writer=a.writer,this.emitter=new v(),this.value=a.value,this.value.emitter.on("change",this.onValueChange_),this.target=a.target,this.read()}read(){const a=this.target.read();a!==void 0&&(this.value.rawValue=this.reader(a))}write_(a){this.writer(this.target,a)}onValueChange_(a){this.write_(a.rawValue),this.emitter.emit("change",{options:a.options,rawValue:a.rawValue,sender:this})}}function Jg(a,b){const d=a.accept(b.target.read(),b.params);if(A(d))return null;const f=S,i={target:b.target,initialValue:d.initialValue,params:d.params},l=a.binding.reader(i),r=a.binding.constraint?a.binding.constraint(i):void 0,x=Y(l(d.initialValue),{constraint:r,equals:a.binding.equals}),K=new Ig({reader:l,target:b.target,value:x,writer:a.binding.writer(i)}),D=f.optional.boolean(b.params.disabled).value,Q=f.optional.boolean(b.params.hidden).value,U=a.controller({constraint:r,document:b.document,initialValue:d.initialValue,params:d.params,value:K.value,viewProps:Ta.create({disabled:D,hidden:Q})}),tb=f.optional.string(b.params.label).value;return new oa(b.document,{binding:K,blade:La(),props:C.fromObject({label:tb||b.target.key}),valueController:U})}class Kg{constructor(a){this.onTick_=this.onTick_.bind(this),this.reader_=a.reader,this.target=a.target,this.emitter=new v(),this.value=a.value,this.ticker=a.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const a=this.target.read();if(a===void 0)return;const b=this.value.rawValue,d=this.reader_(a);this.value.rawValue=Pd(b,d),this.emitter.emit("update",{rawValue:d,sender:this})}onTick_(a){this.read()}}function Lg(a,b){return b===0?new ac():new Bb(a,b!==null&&b!==void 0?b:sc.monitor.defaultInterval)}function Mg(a,b){var d,f,i;const l=S,r=a.accept(b.target.read(),b.params);if(A(r))return null;const x={target:b.target,initialValue:r.initialValue,params:r.params},K=a.binding.reader(x),D=(f=(d=l.optional.number(b.params.bufferSize).value)!==null&&d!==void 0?d:a.binding.defaultBufferSize&&a.binding.defaultBufferSize(r.params))!==null&&f!==void 0?f:1,Q=l.optional.number(b.params.interval).value,U=new Kg({reader:K,target:b.target,ticker:Lg(b.document,Q),value:Od(D)}),tb=l.optional.boolean(b.params.disabled).value,tc=l.optional.boolean(b.params.hidden).value,Mb=a.controller({document:b.document,params:r.params,value:U.value,viewProps:Ta.create({disabled:tb,hidden:tc})}),Zg=(i=l.optional.string(b.params.label).value)!==null&&i!==void 0?i:b.target.key;return new Ma(b.document,{binding:U,blade:La(),props:C.fromObject({label:Zg}),valueController:Mb})}class Ng{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(a){a.type==="blade"?this.pluginsMap_.blades.unshift(a):a.type==="input"?this.pluginsMap_.inputs.unshift(a):a.type==="monitor"&&this.pluginsMap_.monitors.unshift(a)}createInput(a,b,d){const f=b.read();if(A(f))throw new n({context:{key:b.key},type:"nomatchingcontroller"});const i=this.pluginsMap_.inputs.reduce((l,r)=>l||Jg(r,{document:a,target:b,params:d}),null);if(i)return i;throw new n({context:{key:b.key},type:"nomatchingcontroller"})}createMonitor(a,b,d){const f=this.pluginsMap_.monitors.reduce((i,l)=>i||Mg(l,{document:a,params:d,target:b}),null);if(f)return f;throw new n({context:{key:b.key},type:"nomatchingcontroller"})}createBlade(a,b){const d=this.pluginsMap_.blades.reduce((f,i)=>f||Gc(i,{document:a,params:b}),null);if(!d)throw new n({type:"nomatchingview",context:{params:b}});return d}createBladeApi(a){if(a instanceof oa)return new Ub(a);if(a instanceof Ma)return new Sa(a);if(a instanceof mb)return new lb(a,this);const b=this.pluginsMap_.blades.reduce((d,f)=>d||f.api({controller:a,pool:this}),null);if(!b)throw n.shouldNeverHappen();return b}}function Og(){const a=new Ng();return[mg,qg,vg,xg,cg,Wf,Vf,Tf,ra,Ag,Hg,Gg,xb,td,Bc,Fc].forEach(b=>{a.register(b)}),a}class Pe extends q{constructor(a){super(a);this.emitter_=new v(),this.controller_.valueController.value.emitter.on("change",b=>{this.emitter_.emit("change",{event:new J(this,b.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(a){this.controller_.props.set("label",a)}get options(){return this.controller_.valueController.props.get("options")}set options(a){this.controller_.valueController.props.set("options",a)}get value(){return this.controller_.valueController.value.rawValue}set value(a){this.controller_.valueController.value.rawValue=a}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}}class Qe extends q{constructor(a){super(a);this.emitter_=new v(),this.controller_.valueController.value.emitter.on("change",b=>{this.emitter_.emit("change",{event:new J(this,b.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(a){this.controller_.props.set("label",a)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(a){this.controller_.valueController.sliderController.props.set("maxValue",a)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(a){this.controller_.valueController.sliderController.props.set("minValue",a)}get value(){return this.controller_.valueController.value.rawValue}set value(a){this.controller_.valueController.value.rawValue=a}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}}class Re extends q{constructor(a){super(a);this.emitter_=new v(),this.controller_.valueController.value.emitter.on("change",b=>{this.emitter_.emit("change",{event:new J(this,b.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(a){this.controller_.props.set("label",a)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(a){this.controller_.valueController.props.set("formatter",a)}get value(){return this.controller_.valueController.value.rawValue}set value(a){this.controller_.valueController.value.rawValue=a}on(a,b){const d=b.bind(this);return this.emitter_.on(a,f=>{d(f.event)}),this}}const Pg=function(){return{id:"list",type:"blade",accept(a){const b=S,d=N(a,{options:b.required.custom(Gb),value:b.required.raw,view:b.required.constant("list"),label:b.optional.string});return d?{params:d}:null},controller(a){const b=new ob(a.document,{props:C.fromObject({options:Zc(a.params.options)}),value:Y(a.params.value),viewProps:a.viewProps});return new _a(a.document,{blade:a.blade,props:C.fromObject({label:a.params.label}),valueController:b})},api(a){return a.controller instanceof _a?a.controller.valueController instanceof ob?new Pe(a.controller):null:null}}}();function Qg(a){return a.reduce((b,d)=>Object.assign(b,{[d.presetKey]:d.read()}),{})}function Rg(a,b){a.forEach(d=>{const f=b[d.presetKey];f!==void 0&&d.write(f)})}class Sg extends Vb{constructor(a,b){super(a,b)}get element(){return this.controller_.view.element}importPreset(a){const b=this.controller_.rackController.rack.find(oa).map(d=>d.binding.target);Rg(b,a),this.refresh()}exportPreset(){const a=this.controller_.rackController.rack.find(oa).map(b=>b.binding.target);return Qg(a)}refresh(){this.controller_.rackController.rack.find(oa).forEach(a=>{a.binding.read()}),this.controller_.rackController.rack.find(Ma).forEach(a=>{a.binding.read()})}}class Tg extends Yb{constructor(a,b){super(a,{expanded:b.expanded,blade:b.blade,props:b.props,root:!0,viewProps:b.viewProps})}}const Ug={id:"slider",type:"blade",accept(a){const b=S,d=N(a,{max:b.required.number,min:b.required.number,view:b.required.constant("slider"),format:b.optional.function,label:b.optional.string,value:b.optional.number});return d?{params:d}:null},controller(a){var b,d;const f=(b=a.params.value)!==null&&b!==void 0?b:0,i=new nc(a.document,{baseStep:1,parser:ia,sliderProps:C.fromObject({maxValue:a.params.max,minValue:a.params.min}),textProps:C.fromObject({draggingScale:h(void 0,f),formatter:(d=a.params.format)!==null&&d!==void 0?d:hc}),value:Y(f),viewProps:a.viewProps});return new _a(a.document,{blade:a.blade,props:C.fromObject({label:a.params.label}),valueController:i})},api(a){return a.controller instanceof _a?a.controller.valueController instanceof nc?new Qe(a.controller):null:null}},Vg=function(){return{id:"text",type:"blade",accept(a){const b=S,d=N(a,{parse:b.required.function,value:b.required.raw,view:b.required.constant("text"),format:b.optional.function,label:b.optional.string});return d?{params:d}:null},controller(a){var b;const d=new Cb(a.document,{parser:a.params.parse,props:C.fromObject({formatter:(b=a.params.format)!==null&&b!==void 0?b:f=>String(f)}),value:Y(a.params.value),viewProps:a.viewProps});return new _a(a.document,{blade:a.blade,props:C.fromObject({label:a.params.label}),valueController:d})},api(a){return a.controller instanceof _a?a.controller.valueController instanceof Cb?new Re(a.controller):null:null}}}();function Wg(a){const b=a.createElement("div");return b.classList.add(z("dfw")()),a.body&&a.body.appendChild(b),b}function Se(a,b,d){if(a.querySelector(`style[data-tp-style=${b}]`))return;const f=a.createElement("style");f.dataset.tpStyle=b,f.textContent=d,a.head.appendChild(f)}class Xg extends Sg{constructor(a){var b;const d=a||{},f=(b=d.document)!==null&&b!==void 0?b:w(),i=Og(),l=new Tg(f,{expanded:d.expanded,blade:La(),props:C.fromObject({title:d.title}),viewProps:Ta.create()});super(l,i);this.pool_=i,this.containerElem_=d.container||Wg(f),this.containerElem_.appendChild(this.element),this.doc_=f,this.usesDefaultWrapper_=!d.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw n.alreadyDisposed();return this.doc_}dispose(){const a=this.containerElem_;if(!a)throw n.alreadyDisposed();if(this.usesDefaultWrapper_){const b=a.parentElement;b&&b.removeChild(a)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(a){const b="plugin"in a?[a.plugin]:"plugins"in a?a.plugins:[];b.forEach(d=>{this.pool_.register(d),this.embedPluginStyle_(d)})}embedPluginStyle_(a){a.css&&Se(this.document,`plugin-${a.id}`,a.css)}setUpDefaultPlugins_(){Se(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(a=>{this.embedPluginStyle_(a)}),this.registerPlugin({plugins:[Ug,Pg,Fc,Vg]})}}const Yg=new m("3.0.8");t.BladeApi=q,t.ButtonApi=s,t.FolderApi=Vb,t.InputBindingApi=Ub,t.ListApi=Pe,t.MonitorBindingApi=Sa,t.Pane=Xg,t.SeparatorApi=Zb,t.SliderApi=Qe,t.TabApi=_b,t.TabPageApi=Ec,t.TextApi=Re,t.TpChangeEvent=J,t.VERSION=Yg,Object.defineProperty(t,"__esModule",{value:!0})})});var ke=ub((j,p)=>{(function(t,m){typeof j==="object"&&typeof p!=="undefined"?m(j):typeof define==="function"&&define.amd?define(["exports"],m):(t=typeof globalThis!=="undefined"?globalThis:t||self,m(t.TweakpaneEssentialsPlugin={}))})(j,function(t){"use strict";class m{constructor(c){this.controller_=c}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(c){this.controller_.viewProps.set("disabled",c)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(c){this.controller_.viewProps.set("hidden",c)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class q{constructor(c){this.target=c}}class E extends q{constructor(c,e,g,h){super(c);this.value=e,this.presetKey=g,this.last=h!==null&&h!==void 0?h:!0}}function J(c){return c}function L(c){return c===null||c===void 0}const _={alreadydisposed:()=>"View has been already disposed",invalidparams:c=>`Invalid parameters for '${c.name}'`,nomatchingcontroller:c=>`No matching controller for '${c.key}'`,nomatchingview:c=>`No matching view for '${JSON.stringify(c.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:c=>`Property '${c.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class H{constructor(c){var e;this.message=(e=_[c.type](J(c.context)))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=c.type}static alreadyDisposed(){return new H({type:"alreadydisposed"})}static notBindable(){return new H({type:"notbindable"})}static propertyNotFound(c){return new H({type:"propertynotfound",context:{name:c}})}static shouldNeverHappen(){return new H({type:"shouldneverhappen"})}}class A{constructor(){this.observers_={}}on(c,e){let g=this.observers_[c];return g||(g=this.observers_[c]=[]),g.push({handler:e}),this}off(c,e){const g=this.observers_[c];return g&&(this.observers_[c]=g.filter(h=>h.handler!==e)),this}emit(c,e){const g=this.observers_[c];if(!g)return;g.forEach(h=>{h.handler(e)})}}const ha="tp";function y(c){const e=(g,h)=>[ha,"-",c,"v",g?`_${g}`:"",h?`-${h}`:""].join("");return e}function n(c,e){return g=>e(c(g))}function B(c){return c.rawValue}function s(c,e){c.emitter.on("change",n(B,e)),e(c.rawValue)}function v(c,e,g){s(c.value(e),g)}function P(c,e,g){g?c.classList.add(e):c.classList.remove(e)}function z(c,e){return g=>{P(c,e,g)}}function Ra(c,e){s(c,g=>{e.textContent=g!==null&&g!==void 0?g:""})}const wa=y("btn");class aa{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(wa()),e.viewProps.bindClassModifiers(this.element);const g=c.createElement("button");g.classList.add(wa("b")),e.viewProps.bindDisabled(g),this.element.appendChild(g),this.buttonElement=g;const h=c.createElement("div");h.classList.add(wa("t")),Ra(e.props.value("title"),h),this.buttonElement.appendChild(h)}}class ${constructor(c,e){this.emitter=new A(),this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new aa(c,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class xa{constructor(c,e){var g;this.constraint_=e===null||e===void 0?void 0:e.constraint,this.equals_=(g=e===null||e===void 0?void 0:e.equals)!==null&&g!==void 0?g:(h,k)=>h===k,this.emitter=new A(),this.rawValue_=c}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(c){this.setRawValue(c,{forceEmit:!1,last:!0})}setRawValue(c,e){const g=e!==null&&e!==void 0?e:{forceEmit:!1,last:!0},h=this.constraint_?this.constraint_.constrain(c):c,k=!this.equals_(this.rawValue_,h);if(!k&&!g.forceEmit)return;this.emitter.emit("beforechange",{sender:this}),this.rawValue_=h,this.emitter.emit("change",{options:g,rawValue:h,sender:this})}}class ba{constructor(c){this.emitter=new A(),this.value_=c}get rawValue(){return this.value_}set rawValue(c){this.setRawValue(c,{forceEmit:!1,last:!0})}setRawValue(c,e){const g=e!==null&&e!==void 0?e:{forceEmit:!1,last:!0};if(this.value_===c&&!g.forceEmit)return;this.emitter.emit("beforechange",{sender:this}),this.value_=c,this.emitter.emit("change",{options:g,rawValue:this.value_,sender:this})}}function da(c,e){const g=e===null||e===void 0?void 0:e.constraint,h=e===null||e===void 0?void 0:e.equals;return!g&&!h?new ba(c):new xa(c,e)}class X{constructor(c){this.emitter=new A(),this.valMap_=c;for(const e in this.valMap_){const g=this.valMap_[e];g.emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}}static createCore(c){const e=Object.keys(c);return e.reduce((g,h)=>Object.assign(g,{[h]:da(c[h])}),{})}static fromObject(c){const e=this.createCore(c);return new X(e)}get(c){return this.valMap_[c].rawValue}set(c,e){this.valMap_[c].rawValue=e}value(c){return this.valMap_[c]}}function Nb(c,e){const g=Object.keys(e),h=g.reduce((k,o)=>{if(k===void 0)return;const u=e[o],G=u(c[o]);return G.succeeded?Object.assign(Object.assign({},k),{[o]:G.value}):void 0},{});return J(h)}function Ha(c,e){return c.reduce((g,h)=>{if(g===void 0)return;const k=e(h);return!k.succeeded||k.value===void 0?void 0:[...g,k.value]},[])}function Ia(c){return c===null?!1:typeof c==="object"}function ma(c){return e=>g=>{if(!e&&g===void 0)return{succeeded:!1,value:void 0};if(e&&g===void 0)return{succeeded:!0,value:void 0};const h=c(g);return h!==void 0?{succeeded:!0,value:h}:{succeeded:!1,value:void 0}}}function Y(c){return{custom:e=>ma(e)(c),boolean:ma(e=>typeof e==="boolean"?e:void 0)(c),number:ma(e=>typeof e==="number"?e:void 0)(c),string:ma(e=>typeof e==="string"?e:void 0)(c),function:ma(e=>typeof e==="function"?e:void 0)(c),constant:e=>ma(g=>g===e?e:void 0)(c),raw:ma(e=>e)(c),object:e=>ma(g=>Ia(g)?Nb(g,e):void 0)(c),array:e=>ma(g=>Array.isArray(g)?Ha(g,e):void 0)(c)}}const C={optional:Y(!0),required:Y(!1)};function R(c,e){const g=C.required.object(e)(c);return g.succeeded?g.value:void 0}function Wa(c){return c&&c.parentElement&&c.parentElement.removeChild(c),null}function Ob(){return["veryfirst","first","last","verylast"]}const na=y(""),Xa={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class S{constructor(c){this.parent_=null,this.blade=c.blade,this.view=c.view,this.viewProps=c.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Ob().forEach(g=>{e.classList.remove(na(void 0,Xa[g]))}),this.blade.get("positions").forEach(g=>{e.classList.add(na(void 0,Xa[g]))})}),this.viewProps.handleDispose(()=>{Wa(e)})}get parent(){return this.parent_}}const N="http://www.w3.org/2000/svg";function Ya(c){c.offsetHeight}function Pb(c,e){const g=c.style.transition;c.style.transition="none",e(),c.style.transition=g}function fb(c){return c.ontouchstart!==void 0}function vb(c){for(;c.childNodes.length>0;)c.removeChild(c.childNodes[0])}function Ja(c){return c.relatedTarget?J(c.relatedTarget):"explicitOriginalTarget"in c?c.explicitOriginalTarget:null}const ca=y("lbl");function Za(c,e){const g=c.createDocumentFragment(),h=e.split(`
`).map(k=>c.createTextNode(k));return h.forEach((k,o)=>{o>0&&g.appendChild(c.createElement("br")),g.appendChild(k)}),g}class wb{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(ca()),e.viewProps.bindClassModifiers(this.element);const g=c.createElement("div");g.classList.add(ca("l")),v(e.props,"label",k=>{L(k)?this.element.classList.add(ca(void 0,"nol")):(this.element.classList.remove(ca(void 0,"nol")),vb(g),g.appendChild(Za(c,k)))}),this.element.appendChild(g),this.labelElement=g;const h=c.createElement("div");h.classList.add(ca("v")),this.element.appendChild(h),this.valueElement=h}}class Ka extends S{constructor(c,e){const g=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new wb(c,{props:e.props,viewProps:g}),viewProps:g}));this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Qb extends S{constructor(c){super(c);this.value=c.value}}class w extends X{constructor(c){super(c)}static create(c){const e={completed:!0,expanded:c,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},g=X.createCore(e);return new w(g)}get styleExpanded(){var c;return(c=this.get("temporaryExpanded"))!==null&&c!==void 0?c:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const c=this.get("expandedHeight");return this.get("shouldFixHeight")&&!L(c)?`${c}px`:"auto"}bindExpandedClass(c,e){v(this,"expanded",()=>{const g=this.styleExpanded;g?c.classList.add(e):c.classList.remove(e)})}}function F(c){return w.create(c)}function Z(c,e){let g=0;return Pb(e,()=>{c.set("expandedHeight",null),c.set("temporaryExpanded",!0),Ya(e),g=e.clientHeight,c.set("temporaryExpanded",null),Ya(e)}),g}function I(c,e){e.style.height=c.styleHeight}function ea(c,e){c.value("expanded").emitter.on("beforechange",()=>{c.set("completed",!1),L(c.get("expandedHeight"))&&c.set("expandedHeight",Z(c,e)),c.set("shouldFixHeight",!0),Ya(e)}),c.emitter.on("change",()=>{I(c,e)}),I(c,e),e.addEventListener("transitionend",g=>{if(g.propertyName!=="height")return;c.set("shouldFixHeight",!1),c.set("expandedHeight",null),c.set("completed",!0)})}class ta{constructor(c,e){const g=y(e.viewName);this.element=c.createElement("div"),this.element.classList.add(g()),e.viewProps.bindClassModifiers(this.element)}}class ya extends Qb{constructor(c,e){const g=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new wb(c,{props:e.props,viewProps:g}),viewProps:g}));this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const gb=y("");function Rb(c,e){return z(c,gb(void 0,e))}class za extends X{constructor(c){super(c)}static create(c){var e,g;const h=c!==null&&c!==void 0?c:{},k={disabled:(e=h.disabled)!==null&&e!==void 0?e:!1,disposed:!1,hidden:(g=h.hidden)!==null&&g!==void 0?g:!1},o=X.createCore(k);return new za(o)}bindClassModifiers(c){v(this,"disabled",Rb(c,"disabled")),v(this,"hidden",Rb(c,"hidden"))}bindDisabled(c){v(this,"disabled",e=>{c.disabled=e})}bindTabIndex(c){v(this,"disabled",e=>{c.tabIndex=e?-1:0})}handleDispose(c){this.value("disposed").emitter.on("change",e=>{e&&c()})}}class gd{constructor(){this.disabled=!1,this.emitter=new A()}dispose(){}tick(){if(this.disabled)return;this.emitter.emit("tick",{sender:this})}}class wc{constructor(c,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=c,this.emitter=new A(),this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(c){this.disabled_=c,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const c=this.doc_.defaultView;c&&c.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){this.clearTimer_();if(this.interval_<=0)return;const c=this.doc_.defaultView;c&&(this.timerId_=c.setInterval(this.onTick_,this.interval_))}onTick_(){if(this.disabled_)return;this.emitter.emit("tick",{sender:this})}}class hb{constructor(c){this.constraints=c}constrain(c){return this.constraints.reduce((e,g)=>g.constrain(e),c)}}function xb(c,e){if(c instanceof e)return c;if(c instanceof hb){const g=c.constraints.reduce((h,k)=>h?h:k instanceof e?k:null,null);if(g)return g}return null}class Aa{constructor(c){this.maxValue=c.max,this.minValue=c.min}constrain(c){let e=c;return L(this.minValue)||(e=Math.max(e,this.minValue)),L(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}class La{constructor(c){this.step=c}constrain(c){const e=c<0?-Math.round(-c/this.step):Math.round(c/this.step);return e*this.step}}const ib=y("pop");class hd{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(ib()),e.viewProps.bindClassModifiers(this.element),s(e.shows,z(this.element,ib(void 0,"v")))}}class xc{constructor(c,e){this.shows=da(!1),this.viewProps=e.viewProps,this.view=new hd(c,{shows:this.shows,viewProps:this.viewProps})}}const yb=y("txt");class Sb{constructor(c,e){this.onChange_=this.onChange_.bind(this),this.element=c.createElement("div"),this.element.classList.add(yb()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const g=c.createElement("input");g.classList.add(yb("i")),g.type="text",e.viewProps.bindDisabled(g),this.element.appendChild(g),this.inputElement=g,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const c=this.props_.get("formatter");this.inputElement.value=c(this.value_.rawValue)}onChange_(){this.refresh()}}class id{constructor(c,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Sb(c,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(c){const e=J(c.currentTarget),g=e.value,h=this.parser_(g);L(h)||(this.value.rawValue=h),this.view.refresh()}}class jd{constructor(c){this.text=c}evaluate(){return Number(this.text)}toString(){return this.text}}const kd={"**":(c,e)=>Math.pow(c,e),"*":(c,e)=>c*e,"/":(c,e)=>c/e,"%":(c,e)=>c%e,"+":(c,e)=>c+e,"-":(c,e)=>c-e,"<<":(c,e)=>c<<e,">>":(c,e)=>c>>e,">>>":(c,e)=>c>>>e,"&":(c,e)=>c&e,"^":(c,e)=>c^e,"|":(c,e)=>c|e};class ld{constructor(c,e,g){this.left=e,this.operator=c,this.right=g}evaluate(){const c=kd[this.operator];if(!c)throw new Error(`unexpected binary operator: '${this.operator}`);return c(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Tb={"+":c=>c,"-":c=>-c,"~":c=>~c};class Ub{constructor(c,e){this.operator=c,this.expression=e}evaluate(){const c=Tb[this.operator];if(!c)throw new Error(`unexpected unary operator: '${this.operator}`);return c(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function oa(c){return(e,g)=>{for(let h=0;h<c.length;h++){const k=c[h](e,g);if(k!=="")return k}return""}}function Sa(c,e){var g;const h=c.substr(e).match(/^\s+/);return(g=h&&h[0])!==null&&g!==void 0?g:""}function Ma(c,e){const g=c.substr(e,1);return g.match(/^[1-9]$/)?g:""}function jb(c,e){var g;const h=c.substr(e).match(/^[0-9]+/);return(g=h&&h[0])!==null&&g!==void 0?g:""}function kb(c,e){const g=jb(c,e);if(g!=="")return g;const h=c.substr(e,1);e+=1;if(h!=="-"&&h!=="+")return"";const k=jb(c,e);return k===""?"":h+k}function zb(c,e){const g=c.substr(e,1);e+=1;if(g.toLowerCase()!=="e")return"";const h=kb(c,e);return h===""?"":g+h}function lb(c,e){const g=c.substr(e,1);if(g==="0")return g;const h=Ma(c,e);return e+=h.length,h===""?"":h+jb(c,e)}function Vb(c,e){const g=lb(c,e);e+=g.length;if(g==="")return"";const h=c.substr(e,1);e+=h.length;if(h!==".")return"";const k=jb(c,e);return e+=k.length,g+h+k+zb(c,e)}function Wb(c,e){const g=c.substr(e,1);e+=g.length;if(g!==".")return"";const h=jb(c,e);return e+=h.length,h===""?"":g+h+zb(c,e)}function md(c,e){const g=lb(c,e);return e+=g.length,g===""?"":g+zb(c,e)}const nd=oa([Vb,Wb,md]);function od(c,e){var g;const h=c.substr(e).match(/^[01]+/);return(g=h&&h[0])!==null&&g!==void 0?g:""}function pd(c,e){const g=c.substr(e,2);e+=g.length;if(g.toLowerCase()!=="0b")return"";const h=od(c,e);return h===""?"":g+h}function Xb(c,e){var g;const h=c.substr(e).match(/^[0-7]+/);return(g=h&&h[0])!==null&&g!==void 0?g:""}function qd(c,e){const g=c.substr(e,2);e+=g.length;if(g.toLowerCase()!=="0o")return"";const h=Xb(c,e);return h===""?"":g+h}function rd(c,e){var g;const h=c.substr(e).match(/^[0-9a-f]+/i);return(g=h&&h[0])!==null&&g!==void 0?g:""}function mb(c,e){const g=c.substr(e,2);e+=g.length;if(g.toLowerCase()!=="0x")return"";const h=rd(c,e);return h===""?"":g+h}const yc=oa([pd,qd,mb]),sd=oa([yc,nd]);function Yb(c,e){const g=sd(c,e);return e+=g.length,g===""?null:{evaluable:new jd(g),cursor:e}}function td(c,e){const g=c.substr(e,1);e+=g.length;if(g!=="(")return null;const h=Bc(c,e);if(!h)return null;e=h.cursor,e+=Sa(c,e).length;const k=c.substr(e,1);return e+=k.length,k!==")"?null:{evaluable:h.evaluable,cursor:e}}function _a(c,e){return Yb(c,e)||td(c,e)}function Zb(c,e){const g=_a(c,e);if(g)return g;const h=c.substr(e,1);e+=h.length;if(h!=="+"&&h!=="-"&&h!=="~")return null;const k=Zb(c,e);return k?(e=k.cursor,{cursor:e,evaluable:new Ub(h,k.evaluable)}):null}function zc(c,e,g){g+=Sa(e,g).length;const h=c.filter(k=>e.startsWith(k,g))[0];return h?(g+=h.length,g+=Sa(e,g).length,{cursor:g,operator:h}):null}function ud(c,e){return(g,h)=>{const k=c(g,h);if(!k)return null;h=k.cursor;let o=k.evaluable;for(;;){const u=zc(e,g,h);if(!u)break;h=u.cursor;const G=c(g,h);if(!G)return null;h=G.cursor,o=new ld(u.operator,o,G.evaluable)}return o?{cursor:h,evaluable:o}:null}}const Ac=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((c,e)=>ud(c,e),Zb);function Bc(c,e){return e+=Sa(c,e).length,Ac(c,e)}function vd(c){const e=Bc(c,0);if(!e)return null;const g=e.cursor+Sa(c,e.cursor).length;return g!==c.length?null:e.evaluable}function nb(c){var e;const g=vd(c);return(e=g===null||g===void 0?void 0:g.evaluate())!==null&&e!==void 0?e:null}function Ta(c){if(typeof c==="number")return c;if(typeof c==="string"){const e=nb(c);if(!L(e))return e}return 0}function Na(c){return e=>e.toFixed(Math.max(Math.min(c,20),0))}function Cc(c,e){for(;c.length<e;)c.push(void 0)}function wd(c){const e=[];return Cc(e,c),da(e)}function Dc(c){const e=c.indexOf(void 0);return J(e<0?c:c.slice(0,e))}function Ec(c,e){const g=[...Dc(c),e];return g.length>c.length?g.splice(0,g.length-c.length):Cc(g,c.length),g}function _b({primary:c,secondary:e,forward:g,backward:h}){let k=!1;function o(u){if(k)return;k=!0,u(),k=!1}c.emitter.on("change",u=>{o(()=>{e.setRawValue(g(c,e),u.options)})}),e.emitter.on("change",u=>{o(()=>{c.setRawValue(h(c,e),u.options)}),o(()=>{e.setRawValue(g(c,e),u.options)})}),o(()=>{e.setRawValue(g(c,e),{forceEmit:!1,last:!0})})}function Ba(c,e){const g=c*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+g:e.downKey?-g:0}function Ab(c){return{altKey:c.altKey,downKey:c.key==="ArrowDown",shiftKey:c.shiftKey,upKey:c.key==="ArrowUp"}}function $b(c){return{altKey:c.altKey,downKey:c.key==="ArrowLeft",shiftKey:c.shiftKey,upKey:c.key==="ArrowRight"}}function Fc(c){return c==="ArrowUp"||c==="ArrowDown"}function Gc(c){return Fc(c)||c==="ArrowLeft"||c==="ArrowRight"}function ac(c,e){const g=e.ownerDocument.defaultView,h=e.getBoundingClientRect();return{x:c.pageX-((g&&g.scrollX||0)+h.left),y:c.pageY-((g&&g.scrollY||0)+h.top)}}class Bb{constructor(c){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=c,this.emitter=new A(),c.addEventListener("touchstart",this.onTouchStart_),c.addEventListener("touchmove",this.onTouchMove_),c.addEventListener("touchend",this.onTouchEnd_),c.addEventListener("mousedown",this.onMouseDown_)}computePosition_(c){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:c?{x:c.x,y:c.y}:null}}onMouseDown_(c){var e;c.preventDefault(),(e=c.currentTarget)===null||e===void 0||e.focus();const g=this.elem_.ownerDocument;g.addEventListener("mousemove",this.onDocumentMouseMove_),g.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:c.altKey,data:this.computePosition_(ac(c,this.elem_)),sender:this,shiftKey:c.shiftKey})}onDocumentMouseMove_(c){this.emitter.emit("move",{altKey:c.altKey,data:this.computePosition_(ac(c,this.elem_)),sender:this,shiftKey:c.shiftKey})}onDocumentMouseUp_(c){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:c.altKey,data:this.computePosition_(ac(c,this.elem_)),sender:this,shiftKey:c.shiftKey})}onTouchStart_(c){c.preventDefault();const e=c.targetTouches.item(0),g=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:c.altKey,data:this.computePosition_(e?{x:e.clientX-g.left,y:e.clientY-g.top}:void 0),sender:this,shiftKey:c.shiftKey}),this.lastTouch_=e}onTouchMove_(c){const e=c.targetTouches.item(0),g=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:c.altKey,data:this.computePosition_(e?{x:e.clientX-g.left,y:e.clientY-g.top}:void 0),sender:this,shiftKey:c.shiftKey}),this.lastTouch_=e}onTouchEnd_(c){var e;const g=(e=c.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,h=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:c.altKey,data:this.computePosition_(g?{x:g.clientX-h.left,y:g.clientY-h.top}:void 0),sender:this,shiftKey:c.shiftKey})}}function V(c,e,g,h,k){const o=(c-e)/(g-e);return h+o*(k-h)}function sa(c){const e=String(c.toFixed(10)),g=e.split(".")[1];return g.replace(/0+$/,"").length}function Ca(c,e,g){return Math.min(Math.max(c,e),g)}const W=y("txt");class Ua{constructor(c,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=c.createElement("div"),this.element.classList.add(W(),W(void 0,"num")),e.arrayPosition&&this.element.classList.add(W(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const g=c.createElement("input");g.classList.add(W("i")),g.type="text",e.viewProps.bindDisabled(g),this.element.appendChild(g),this.inputElement=g,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(W()),this.inputElement.classList.add(W("i"));const h=c.createElement("div");h.classList.add(W("k")),this.element.appendChild(h),this.knobElement=h;const k=c.createElementNS(N,"svg");k.classList.add(W("g")),this.knobElement.appendChild(k);const o=c.createElementNS(N,"path");o.classList.add(W("gb")),k.appendChild(o),this.guideBodyElem_=o;const u=c.createElementNS(N,"path");u.classList.add(W("gh")),k.appendChild(u),this.guideHeadElem_=u;const G=c.createElement("div");G.classList.add(y("tt")()),this.knobElement.appendChild(G),this.tooltipElem_=G,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(c){if(c.rawValue===null){this.element.classList.remove(W(void 0,"drg"));return}this.element.classList.add(W(void 0,"drg"));const e=c.rawValue/this.props_.get("draggingScale"),g=e+(e>0?-1:e<0?1:0),h=Ca(-g,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${g+h},0 L${g},4 L${g+h},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const k=this.props_.get("formatter");this.tooltipElem_.textContent=k(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const c=this.props_.get("formatter");this.inputElement.value=c(this.value.rawValue)}onChange_(){this.refresh()}}class bc{constructor(c,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=da(null),this.view=new Ua(c,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const g=new Bb(this.view.knobElement);g.emitter.on("down",this.onPointerDown_),g.emitter.on("move",this.onPointerMove_),g.emitter.on("up",this.onPointerUp_)}onInputChange_(c){const e=J(c.currentTarget),g=e.value,h=this.parser_(g);L(h)||(this.value.rawValue=h),this.view.refresh()}onInputKeyDown_(c){const e=Ba(this.baseStep_,Ab(c));if(e===0)return;this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onInputKeyUp_(c){const e=Ba(this.baseStep_,Ab(c));if(e===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(c){if(!c.point)return null;const e=c.point.x-c.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}onPointerMove_(c){const e=this.computeDraggingValue_(c.data);if(e===null)return;this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_}onPointerUp_(c){const e=this.computeDraggingValue_(c.data);if(e===null)return;this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null}}function xd(c,e){c.write(e)}function ob(c){const e=c?xb(c,La):null;return e?e.step:null}function Hc(c,e){const g=c&&xb(c,La);return g?sa(g.step):Math.max(sa(e),2)}function Ic(c){const e=ob(c);return e!==null&&e!==void 0?e:1}function Jc(c,e){var g;const h=c&&xb(c,La),k=Math.abs((g=h===null||h===void 0?void 0:h.step)!==null&&g!==void 0?g:e);return k===0?.1:Math.pow(10,Math.floor(Math.log10(k))-1)}class Kc{constructor(c){this.components=c.components,this.asm_=c.assembly}constrain(c){const e=this.asm_.toComponents(c).map((g,h)=>{var k,o;return(o=(k=this.components[h])===null||k===void 0?void 0:k.constrain(g))!==null&&o!==void 0?o:g});return this.asm_.fromComponents(e)}}const Lc=y("pndtxt");class Cb{constructor(c,e){this.textViews=e.textViews,this.element=c.createElement("div"),this.element.classList.add(Lc()),this.textViews.forEach(g=>{const h=c.createElement("div");h.classList.add(Lc("a")),h.appendChild(g.element),this.element.appendChild(h)})}}function yd(c,e,g){return new bc(c,{arrayPosition:g===0?"fst":g===e.axes.length-1?"lst":"mid",baseStep:e.axes[g].baseStep,parser:e.parser,props:e.axes[g].textProps,value:da(0,{constraint:e.axes[g].constraint}),viewProps:e.viewProps})}class Db{constructor(c,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((g,h)=>yd(c,e,h)),this.acs_.forEach((g,h)=>{_b({primary:this.value,secondary:g.value,forward:k=>e.assembly.toComponents(k.rawValue)[h],backward:(k,o)=>{const u=e.assembly.toComponents(k.rawValue);return u[h]=o.rawValue,e.assembly.fromComponents(u)}})}),this.view=new Cb(c,{textViews:this.acs_.map(g=>g.view)})}}function Mc(c){return"step"in c&&!L(c.step)?new La(c.step):null}function zd(c){return"max"in c&&!L(c.max)||"min"in c&&!L(c.min)?new Aa({max:c.max,min:c.min}):null}const Ad={monitor:{defaultInterval:200,defaultLineCount:3}};class Bd{constructor(){this.emitter=new A(),this.index_=-1}get index(){return this.index_}set index(c){const e=this.index_!==c;e&&(this.index_=c,this.emitter.emit("change",{index:c,sender:this}))}}const Oa=y("grl");class Cd{constructor(c,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=c.createElement("div"),this.element.classList.add(Oa()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const g=c.createElementNS(N,"svg");g.classList.add(Oa("g")),g.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(g),this.svgElem_=g;const h=c.createElementNS(N,"polyline");this.svgElem_.appendChild(h),this.lineElem_=h;const k=c.createElement("div");k.classList.add(Oa("t"),y("tt")()),this.element.appendChild(k),this.tooltipElem_=k,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const c=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,g=this.minValue_,h=this.maxValue_,k=[];this.value.rawValue.forEach((fa,qc)=>{if(fa===void 0)return;const Vd=V(qc,0,e,0,c.width),Wd=V(fa,g,h,c.height,0);k.push([Vd,Wd].join(","))}),this.lineElem_.setAttributeNS(null,"points",k.join(" "));const o=this.tooltipElem_,u=this.value.rawValue[this.cursor_.index];if(u===void 0){o.classList.remove(Oa("t","a"));return}const G=V(this.cursor_.index,0,e,0,c.width),ra=V(u,g,h,c.height,0);o.style.left=`${G}px`,o.style.top=`${ra}px`,o.textContent=`${this.formatter_(u)}`,o.classList.contains(Oa("t","a"))||(o.classList.add(Oa("t","a"),Oa("t","in")),Ya(o),o.classList.remove(Oa("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class cc{constructor(c,e){this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.cursor_=new Bd(),this.view=new Cd(c,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:this.viewProps});if(!fb(c))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const g=new Bb(this.view.element);g.emitter.on("down",this.onGraphPointerDown_),g.emitter.on("move",this.onGraphPointerMove_),g.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(c){const e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(V(c.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(c){this.onGraphPointerMove_(c)}onGraphPointerMove_(c){if(!c.data.point){this.cursor_.index=-1;return}this.cursor_.index=Math.floor(V(c.data.point.x,0,c.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.index=-1}}class pb{constructor(c){this.controller_=c}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(c){this.controller_.viewProps.set("disabled",c)}get title(){var c;return(c=this.controller_.props.get("title"))!==null&&c!==void 0?c:""}set title(c){this.controller_.props.set("title",c)}on(c,e){const g=e.bind(this),h=this.controller_.emitter;return h.on(c,()=>{g(new q(this))}),this}}class Dd extends q{constructor(c,e,g){super(c);this.cell=e,this.index=g}}class qb extends m{constructor(c){super(c);this.cellToApiMap_=new Map(),this.emitter_=new A();const e=this.controller_.valueController;e.cellControllers.forEach((g,h)=>{const k=new pb(g);this.cellToApiMap_.set(g,k),g.emitter.on("click",()=>{const o=h%e.size[0],u=Math.floor(h/e.size[0]);this.emitter_.emit("click",{event:new Dd(this,k,[o,u])})})})}cell(c,e){const g=this.controller_.valueController,h=g.cellControllers[e*g.size[0]+c];return this.cellToApiMap_.get(h)}on(c,e){const g=e.bind(this);return this.emitter_.on(c,h=>{g(h.event)}),this}}class Nc{constructor(c,e){this.size=e.size;const[g,h]=this.size,k=[];for(let o=0;o<h;o++)for(let u=0;u<g;u++){const G=new $(c,{props:X.fromObject(Object.assign({},e.cellConfig(u,o))),viewProps:za.create()});k.push(G)}this.cellCs_=k,this.viewProps=za.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(o=>{o.viewProps.set("disposed",!0)})}),this.view=new ta(c,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${g}, 1fr)`,this.cellCs_.forEach(o=>{this.view.element.appendChild(o.view.element)})}get cellControllers(){return this.cellCs_}}const dc={id:"buttongrid",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept(c){const e=C,g=R(c,{cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string});return g?{params:g}:null},controller(c){return new Ka(c.document,{blade:c.blade,props:X.fromObject({label:c.params.label}),valueController:new Nc(c.document,{cellConfig:c.params.cells,size:c.params.size})})},api(c){return c.controller instanceof Ka?c.controller.valueController instanceof Nc?new qb(c.controller):null:null}};class Oc extends m{get label(){return this.controller_.props.get("label")}set label(c){this.controller_.props.set("label",c)}get value(){return this.controller_.valueController.value.rawValue}set value(c){this.controller_.valueController.value.rawValue=c}on(c,e){const g=e.bind(this);return this.controller_.valueController.value.emitter.on(c,h=>{g(new E(this,h.rawValue,void 0,h.options.last))}),this}}function pa(c,e,g){return c*(1-g)+e*g}const Ed=20,Fd=.001,ec=100;function Gd(c,e){let g=.25,h=.5,k=-1;for(let o=0;o<Ed;o++){const[u,G]=c.curve(h);h+=g*(u<e?1:-1),k=G,g*=.5;if(Math.abs(e-u)<Fd)break}return k}class Pa{constructor(c=0,e=0,g=1,h=1){this.cache_=[],this.comps_=[c,e,g,h]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(c){return L(c)?!1:Array.isArray(c)?typeof c[0]==="number"&&typeof c[1]==="number"&&typeof c[2]==="number"&&typeof c[3]==="number":!1}static equals(c,e){return c.x1===e.x1&&c.y1===e.y1&&c.x2===e.x2&&c.y2===e.y2}curve(c){const e=pa(0,this.x1,c),g=pa(0,this.y1,c),h=pa(this.x1,this.x2,c),k=pa(this.y1,this.y2,c),o=pa(this.x2,1,c),u=pa(this.y2,1,c),G=pa(e,h,c),ra=pa(g,k,c),fa=pa(h,o,c),qc=pa(k,u,c);return[pa(G,fa,c),pa(ra,qc,c)]}y(c){if(this.cache_.length===0){const e=[];for(let g=0;g<ec;g++)e.push(Gd(this,V(g,0,ec-1,0,1)));this.cache_=e}return this.cache_[Math.round(V(Ca(c,0,1),0,1,0,ec-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const Pc={toComponents:c=>c.toObject(),fromComponents:c=>new Pa(...c)};function Hd(c){const e=Na(2),g=c.toObject().map(h=>e(h));return`cubic-bezier(${g.join(", ")})`}const Qc=[0,.5,.5,1];function Id(c){const e=c.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new Pa(...Qc);const g=[e[1],e[2],e[3],e[4]].reduce((h,k)=>{if(!h)return null;const o=Number(k);return isNaN(o)?null:[...h,o]},[]);return new Pa(...g!==null&&g!==void 0?g:Qc)}const Va=y("cbz");class Jd{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(Va()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,Va(void 0,"expanded")),v(e.foldable,"completed",z(this.element,Va(void 0,"cpl")));const g=c.createElement("div");g.classList.add(Va("h")),this.element.appendChild(g);const h=c.createElement("button");h.classList.add(Va("b")),e.viewProps.bindDisabled(h);const k=c.createElementNS(N,"svg");k.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',h.appendChild(k),g.appendChild(h),this.buttonElement=h;const o=c.createElement("div");o.classList.add(Va("t")),g.appendChild(o),this.textElement=o;if(e.pickerLayout==="inline"){const u=c.createElement("div");u.classList.add(Va("p")),this.element.appendChild(u),this.pickerElement=u}else this.pickerElement=null}}const fc=y("cbzp");class Kd{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(fc()),e.viewProps.bindClassModifiers(this.element);const g=c.createElement("div");g.classList.add(fc("g")),this.element.appendChild(g),this.graphElement=g;const h=c.createElement("div");h.classList.add(fc("t")),this.element.appendChild(h),this.textElement=h}}function Rc(c,e){const g=new MutationObserver(k=>{for(const o of k){if(o.type!=="childList")continue;o.addedNodes.forEach(u=>{if(!u.contains(u))return;e(),g.disconnect()})}}),h=c.ownerDocument;g.observe(h.body,{attributes:!0,childList:!0,subtree:!0})}const Da=y("cbzg");function Ld(c,e){return g=>e(c(g))}class Md{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(Da()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const g=c.createElement("div");g.classList.add(Da("p")),this.element.appendChild(g),this.previewElement=g;const h=c.createElementNS(N,"svg");h.classList.add(Da("g")),this.element.appendChild(h),this.svgElem_=h;const k=c.createElementNS(N,"path");k.classList.add(Da("u")),this.svgElem_.appendChild(k),this.guideElem_=k;const o=c.createElementNS(N,"polyline");o.classList.add(Da("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[c.createElement("div"),c.createElement("div")],this.handleElems_.forEach(u=>{u.classList.add(Da("h")),this.element.appendChild(u)}),this.vectorElems_=[c.createElementNS(N,"line"),c.createElementNS(N,"line")],this.vectorElems_.forEach(u=>{u.classList.add(Da("v")),this.svgElem_.appendChild(u)}),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach((u,G)=>{s(this.sel_,Ld(ra=>ra===G,z(u,Da("h","sel"))))}),Rc(this.element,()=>{this.refresh()})}getVertMargin_(c){return c*.25}valueToPosition(c,e){const g=this.element.getBoundingClientRect(),h=g.width,k=g.height,o=this.getVertMargin_(k);return{x:V(c,0,1,0,h),y:V(e,0,1,k-o,o)}}positionToValue(c,e){const g=this.element.getBoundingClientRect(),h=g.width,k=g.height,o=this.getVertMargin_(k);return{x:Ca(V(c,0,h,0,1),0,1),y:V(e,k-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(k=>{const o=this.valueToPosition(0,k),u=this.valueToPosition(1,k);return[`M ${o.x},${o.y}`,`L ${u.x},${u.y}`].join(" ")}).join(" "));const c=this.value_.rawValue,e=[];let g=0;for(;;){const k=this.valueToPosition(...c.curve(g));e.push([k.x,k.y].join(","));if(g>=1)break;g=Math.min(g+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const h=c.toObject();[0,1].forEach(k=>{const o=this.valueToPosition(k,k),u=this.valueToPosition(h[k*2],h[k*2+1]),G=this.vectorElems_[k];G.setAttributeNS(null,"x1",String(o.x)),G.setAttributeNS(null,"y1",String(o.y)),G.setAttributeNS(null,"x2",String(u.x)),G.setAttributeNS(null,"y2",String(u.y));const ra=this.handleElems_[k];ra.style.left=`${u.x}px`,ra.style.top=`${u.y}px`})}onValueChange_(){this.refresh()}}const Sc=24,gc=400,Tc=1e3,ia=y("cbzprv");class Uc{constructor(c,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=c.createElement("div"),this.element.classList.add(ia()),e.viewProps.bindClassModifiers(this.element);const g=c.createElementNS(N,"svg");g.classList.add(ia("g")),this.element.appendChild(g),this.svgElem_=g;const h=c.createElementNS(N,"path");h.classList.add(ia("t")),this.svgElem_.appendChild(h),this.ticksElem_=h;const k=c.createElement("div");k.classList.add(ia("m")),this.element.appendChild(k),this.markerElem_=k,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),Rc(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(ia("m","a")),this.startTime_=new Date().getTime()+gc,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(ia("m","a"))}onDispose_(){this.stop()}updateMarker_(c){const e=this.value_.rawValue.y(Ca(c,0,1));this.markerElem_.style.left=`${e*100}%`}refresh(){const c=this.svgElem_.getBoundingClientRect(),e=c.width,g=c.height,h=[],k=this.value_.rawValue;for(let o=0;o<Sc;o++){const u=V(o,0,Sc-1,0,1),G=V(k.y(u),0,1,0,e);h.push(`M ${G},0 v${g}`)}this.ticksElem_.setAttributeNS(null,"d",h.join(" "))}onTimer_(){if(this.startTime_===null)return;const c=new Date().getTime()-this.startTime_,e=c/Tc;this.updateMarker_(e),c>Tc+gc&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function hc(c,e,g,h){const k=g-c,o=h-e;return Math.sqrt(k*k+o*o)}function ja(c,e,g,h){const k=hc(c,e,g,h),o=Math.atan2(h-e,g-c),u=Math.round(o/(Math.PI/4))*Math.PI/4;return{x:c+Math.cos(u)*k,y:e+Math.sin(u)*k}}class Nd{constructor(c,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.sel_=da(0),this.viewProps=e.viewProps,this.view=new Md(c,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new Uc(c,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",h=>{h.stopImmediatePropagation(),h.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const g=new Bb(this.view.element);g.emitter.on("down",this.onPointerDown_),g.emitter.on("move",this.onPointerMove_),g.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(c,e,g){const h=this.sel_.rawValue,k=this.value.rawValue.toObject(),o=this.view.positionToValue(c.x,c.y),u=e?ja(h,h,o.x,o.y):o;k[h*2]=u.x,k[h*2+1]=u.y,this.value.setRawValue(new Pa(...k),g)}onPointerDown_(c){const e=c.data;if(!e.point)return;const g=this.value.rawValue,h=this.view.valueToPosition(g.x1,g.y1),k=hc(e.point.x,e.point.y,h.x,h.y),o=this.view.valueToPosition(g.x2,g.y2),u=hc(e.point.x,e.point.y,o.x,o.y);this.sel_.rawValue=k<=u?0:1,this.updateValue_(e.point,c.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(c){const e=c.data;if(!e.point)return;this.updateValue_(e.point,c.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(c){const e=c.data;if(!e.point)return;this.updateValue_(e.point,c.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(c){Gc(c.key)&&c.preventDefault();const e=this.sel_.rawValue,g=this.value.rawValue.toObject();g[e*2]+=Ba(this.baseStep_,$b(c)),g[e*2+1]+=Ba(this.baseStep_,Ab(c)),this.value.setRawValue(new Pa(...g),{forceEmit:!1,last:!1})}onKeyUp_(c){Gc(c.key)&&c.preventDefault();const e=Ba(this.baseStep_,$b(c)),g=Ba(this.baseStep_,Ab(c));if(e===0&&g===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Eb{constructor(c,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Kd(c,{viewProps:this.viewProps}),this.gc_=new Nd(c,{baseStep:e.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const g=Object.assign(Object.assign({},e.axis),{constraint:new Aa({max:1,min:0})}),h=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new Db(c,{assembly:Pc,axes:[g,h,g,h],parser:nb,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(c=>c.inputElement)]}refresh(){this.gc_.refresh()}}class ic{constructor(c,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=F(e.expanded),this.view=new Jd(c,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new id(c,{parser:Id,props:X.fromObject({formatter:Hd}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=e.pickerLayout==="popup"?new xc(c,{viewProps:this.viewProps}):null;const g=new Eb(c,{axis:e.axis,value:this.value,viewProps:this.viewProps});g.allFocusableElements.forEach(h=>{h.addEventListener("blur",this.onPopupChildBlur_),h.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=g,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),s(this.popC_.shows,h=>{h&&g.refresh()}),_b({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:h=>h.rawValue,backward:(h,k)=>k.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ea(this.foldable_,this.view.pickerElement))}onButtonBlur_(c){if(!this.popC_)return;const e=J(c.relatedTarget);(!e||!this.popC_.view.element.contains(e))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(c){if(!this.popC_)return;const e=this.popC_.view.element,g=Ja(c);if(g&&e.contains(g))return;if(g&&g===this.view.buttonElement&&!fb(e.ownerDocument))return;this.popC_.shows.rawValue=!1}onPopupChildKeydown_(c){if(!this.popC_)return;c.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function jc(){return new Kc({assembly:Pc,components:[0,1,2,3].map(c=>c%2===0?new Aa({min:0,max:1}):void 0)})}const Vc={id:"cubic-bezier",type:"blade",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept(c){const e=C,g=R(c,{value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom(h=>h==="inline"||h==="popup"?h:void 0)});return g?{params:g}:null},controller(c){var e,g;const h=new Pa(...c.params.value),k=da(h,{constraint:jc(),equals:Pa.equals}),o=new ic(c.document,{axis:{baseStep:.1,textProps:X.fromObject({draggingScale:.01,formatter:Na(2)})},expanded:(e=c.params.expanded)!==null&&e!==void 0?e:!1,pickerLayout:(g=c.params.picker)!==null&&g!==void 0?g:"popup",value:k,viewProps:c.viewProps});return new ya(c.document,{blade:c.blade,props:X.fromObject({label:c.params.label}),valueController:o})},api(c){return c.controller instanceof ya?c.controller.valueController instanceof ic?new Oc(c.controller):null:null}};class Od extends m{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Wc=20;class Pd{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(c){this.start_=c.getTime()}calculateFps_(c){if(this.timestamps_.length===0)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(c-e.time)}compactTimestamps_(){if(this.timestamps_.length<=Wc)return;const c=this.timestamps_.length-Wc;this.timestamps_.splice(0,c);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach(g=>{g.frameCount-=e}),this.frameCount_-=e}end(c){if(this.start_===null)return;const e=c.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const Ea=y("fps");class ka{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(Ea()),e.viewProps.bindClassModifiers(this.element),this.graphElement=c.createElement("div"),this.graphElement.classList.add(Ea("g")),this.element.appendChild(this.graphElement);const g=c.createElement("div");g.classList.add(Ea("l")),this.element.appendChild(g);const h=c.createElement("span");h.classList.add(Ea("v")),h.textContent="--",g.appendChild(h),this.valueElement=h;const k=c.createElement("span");k.classList.add(Ea("u")),k.textContent="FPS",g.appendChild(k)}}class $a{constructor(c,e){this.stopwatch_=new Pd(),this.onTick_=this.onTick_.bind(this),this.ticker_=e.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=e.value,this.viewProps=e.viewProps,this.view=new ka(c,{viewProps:this.viewProps}),this.graphC_=new cc(c,{formatter:Na(0),lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()})}begin(){this.stopwatch_.begin(new Date())}end(){this.stopwatch_.end(new Date())}onTick_(){const c=this.stopwatch_.fps;if(c!==null){const e=this.value_.rawValue;this.value_.rawValue=Ec(e,c),this.view.valueElement.textContent=c.toFixed(0)}}}function Fa(c,e){return e===0?new gd():new wc(c,e!==null&&e!==void 0?e:Ad.monitor.defaultInterval)}const Qd={id:"fpsgraph",type:"blade",accept(c){const e=C,g=R(c,{view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,lineCount:e.optional.number,max:e.optional.number,min:e.optional.number});return g?{params:g}:null},controller(c){var e,g,h,k;const o=(e=c.params.interval)!==null&&e!==void 0?e:500;return new Ka(c.document,{blade:c.blade,props:X.fromObject({label:c.params.label}),valueController:new $a(c.document,{lineCount:(g=c.params.lineCount)!==null&&g!==void 0?g:2,maxValue:(h=c.params.max)!==null&&h!==void 0?h:90,minValue:(k=c.params.min)!==null&&k!==void 0?k:0,ticker:Fa(c.document,o),value:wd(80),viewProps:c.viewProps})})},api(c){return c.controller instanceof Ka?c.controller.valueController instanceof $a?new Od(c.controller):null:null}};class la{constructor(c,e){this.min=c,this.max=e}static isObject(c){if(typeof c!=="object"||c===null)return!1;const e=c.min,g=c.max;return typeof e!=="number"||typeof g!=="number"?!1:!0}static equals(c,e){return c.min===e.min&&c.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Fb={fromComponents:c=>new la(c[0],c[1]),toComponents:c=>[c.min,c.max]};class Qa{constructor(c){this.edge=c}constrain(c){var e,g,h,k,o,u,G,ra;if(c.min<=c.max)return new la((g=(e=this.edge)===null||e===void 0?void 0:e.constrain(c.min))!==null&&g!==void 0?g:c.min,(k=(h=this.edge)===null||h===void 0?void 0:h.constrain(c.max))!==null&&k!==void 0?k:c.max);const fa=(c.min+c.max)/2;return new la((u=(o=this.edge)===null||o===void 0?void 0:o.constrain(fa))!==null&&u!==void 0?u:fa,(ra=(G=this.edge)===null||G===void 0?void 0:G.constrain(fa))!==null&&ra!==void 0?ra:fa)}}const T=y("rsltxt");class Xc{constructor(c,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=c.createElement("div"),this.element.classList.add(T());const g=c.createElement("div");g.classList.add(T("s")),g.appendChild(this.sliderView_.element),this.element.appendChild(g);const h=c.createElement("div");h.classList.add(T("t")),h.appendChild(this.textView_.element),this.element.appendChild(h)}}const O=y("rsl");class kc{constructor(c,e){this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.element=c.createElement("div"),this.element.classList.add(O()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this));const g=c.createElement("div");g.classList.add(O("t")),this.element.appendChild(g),this.trackElement=g;const h=c.createElement("div");h.classList.add(O("b")),g.appendChild(h),this.barElement=h;const k=["min","max"].map(o=>{const u=c.createElement("div");return u.classList.add(O("k"),O("k",o)),g.appendChild(u),u});this.knobElements=[k[0],k[1]],this.update()}valueToX_(c){return Ca(V(c,this.minValue_,this.maxValue_,0,1),0,1)*100}update(){const c=this.value_.rawValue;c.length===0?this.element.classList.add(O(void 0,"zero")):this.element.classList.remove(O(void 0,"zero"));const e=[this.valueToX_(c.min),this.valueToX_(c.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=`${100-e[1]}%`,this.knobElements.forEach((g,h)=>{g.style.left=`${e[h]}%`})}onValueChange_(){this.update()}}class qa{constructor(c,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.maxValue_=e.maxValue,this.minValue_=e.minValue,this.viewProps=e.viewProps,this.value=e.value,this.view=new kc(c,{maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:e.viewProps});const g=new Bb(this.view.trackElement);g.emitter.on("down",this.onPointerDown_),g.emitter.on("move",this.onPointerMove_),g.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(c){if(!c.point)return null;const e=(c.point.x+this.ofs_())/c.bounds.width;return V(e,0,1,this.minValue_,this.maxValue_)}onPointerDown_(c){if(!c.data.point)return;const e=c.data.point.x/c.data.bounds.width,g=this.value.rawValue,h=V(g.min,this.minValue_,this.maxValue_,0,1),k=V(g.max,this.minValue_,this.maxValue_,0,1);Math.abs(k-e)<=.025?this.grabbing_="max":Math.abs(h-e)<=.025?this.grabbing_="min":e>=h&&e<=k?(this.grabbing_="length",this.grabOffset_=V(e-h,0,1,0,this.maxValue_-this.minValue_)):e<h?(this.grabbing_="min",this.onPointerMove_(c)):e>k&&(this.grabbing_="max",this.onPointerMove_(c))}applyPointToValue_(c,e){const g=this.valueFromData_(c);if(g===null)return;if(this.grabbing_==="min")this.value.setRawValue(new la(g,this.value.rawValue.max),e);else if(this.grabbing_==="max")this.value.setRawValue(new la(this.value.rawValue.min,g),e);else if(this.grabbing_==="length"){const h=this.value.rawValue.length;let k=g-this.grabOffset_,o=k+h;k<this.minValue_?(k=this.minValue_,o=this.minValue_+h):o>this.maxValue_&&(k=this.maxValue_-h,o=this.maxValue_),this.value.setRawValue(new la(k,o),e)}}onPointerMove_(c){this.applyPointToValue_(c.data,{forceEmit:!1,last:!1})}onPointerUp_(c){this.applyPointToValue_(c.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Rd{constructor(c,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new qa(c,e);const g={baseStep:e.baseStep,constraint:e.constraint,textProps:X.fromObject({draggingScale:e.draggingScale,formatter:e.formatter})};this.tc_=new Db(c,{assembly:Fb,axes:[g,g],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new Xc(c,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function rb(c){return la.isObject(c)?new la(c.min,c.max):new la(0,0)}function lc(c,e){c.writeProperty("max",e.max),c.writeProperty("min",e.min)}function Sd(c){const e=[],g=zd(c);g&&e.push(g);const h=Mc(c);return h&&e.push(h),new Qa(new hb(e))}const Td={id:"input-interval",type:"input",css:".tp-cbzv_b,.tp-rslv_k,.tp-radv_b,.tp-cbzgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-cbzv_b,.tp-rslv_k,.tp-radv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-cbzv_b:hover,.tp-rslv_k:hover,.tp-radv_b:hover{background-color:var(--btn-bg-h)}.tp-cbzv_b:focus,.tp-rslv_k:focus,.tp-radv_b:focus{background-color:var(--btn-bg-f)}.tp-cbzv_b:active,.tp-rslv_k:active,.tp-radv_b:active{background-color:var(--btn-bg-a)}.tp-cbzv_b:disabled,.tp-rslv_k:disabled,.tp-radv_b:disabled{opacity:0.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:0.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:0.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:0.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:0.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us) * 5);width:100%}.tp-cbzgv_u{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:transparent;stroke:var(--in-fg)}.tp-cbzgv_v{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:0.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity 0.2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:0.2em;opacity:0.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:0.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:'';height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px) / -2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:0.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:0.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:0.5}.tp-radgridv .tp-radv_b{border-radius:0}",accept:(c,e)=>{if(!la.isObject(c))return null;const g=C,h=R(e,{format:g.optional.function,max:g.optional.number,min:g.optional.number,step:g.optional.number});return h?{initialValue:new la(c.min,c.max),params:h}:null},binding:{reader:c=>rb,constraint:c=>Sd(c.params),equals:la.equals,writer:c=>lc},controller(c){var e;const g=c.value,h=c.constraint;if(!(h instanceof Qa))throw H.shouldNeverHappen();const k=(g.rawValue.min+g.rawValue.max)/2,o=(e=c.params.format)!==null&&e!==void 0?e:Na(Hc(h.edge,k)),u=h.edge&&xb(h.edge,Aa);if((u===null||u===void 0?void 0:u.minValue)!==void 0&&(u===null||u===void 0?void 0:u.maxValue)!==void 0)return new Rd(c.document,{baseStep:Ic(h.edge),constraint:h.edge,draggingScale:Jc(u,k),formatter:o,maxValue:u.maxValue,minValue:u.minValue,parser:nb,value:g,viewProps:c.viewProps});const G={baseStep:Ic(h.edge),constraint:h.edge,textProps:X.fromObject({draggingScale:k,formatter:o})};return new Db(c.document,{assembly:Fb,axes:[G,G],parser:nb,value:g,viewProps:c.viewProps})}};class mc{constructor(c){this.controller_=c}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(c){this.controller_.viewProps.set("disabled",c)}get title(){var c;return(c=this.controller_.props.get("title"))!==null&&c!==void 0?c:""}set title(c){this.controller_.props.set("title",c)}}class Ud extends E{constructor(c,e,g,h,k){super(c,h,k);this.cell=e,this.index=g}}class nc extends m{constructor(c){super(c);this.cellToApiMap_=new Map();const e=this.controller_.valueController;e.cellControllers.forEach(g=>{const h=new mc(g);this.cellToApiMap_.set(g,h)})}get value(){return this.controller_.value}cell(c,e){const g=this.controller_.valueController,h=g.cellControllers[e*g.size[0]+c];return this.cellToApiMap_.get(h)}on(c,e){const g=e.bind(this);this.controller_.value.emitter.on(c,h=>{const k=this.controller_.valueController,o=k.findCellByValue(h.rawValue);if(!o)return;const u=this.cellToApiMap_.get(o);if(!u)return;const G=k.cellControllers.indexOf(o);g(new Ud(this,u,[G%k.size[0],Math.floor(G/k.size[0])],h.rawValue,void 0))})}}const Ga=y("rad");class Gb{constructor(c,e){this.element=c.createElement("div"),this.element.classList.add(Ga()),e.viewProps.bindClassModifiers(this.element);const g=c.createElement("label");g.classList.add(Ga("l")),this.element.appendChild(g);const h=c.createElement("input");h.classList.add(Ga("i")),h.name=e.name,h.type="radio",e.viewProps.bindDisabled(h),g.appendChild(h),this.inputElement=h;const k=c.createElement("div");k.classList.add(Ga("b")),g.appendChild(k);const o=c.createElement("div");o.classList.add(Ga("t")),k.appendChild(o),v(e.props,"title",u=>{o.textContent=u})}}class Yc{constructor(c,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Gb(c,{name:e.name,props:this.props,viewProps:this.viewProps})}}class ua{constructor(c,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[g,h]=this.size;for(let k=0;k<h;k++)for(let o=0;o<g;o++){const u=new Yc(c,{name:e.groupName,props:X.fromObject(Object.assign({},e.cellConfig(o,k))),viewProps:za.create()});this.cellCs_.push(u),this.cellValues_.push(e.cellConfig(o,k).value)}this.value=e.value,s(this.value,k=>{const o=this.findCellByValue(k);if(!o)return;o.view.inputElement.checked=!0}),this.viewProps=za.create(),this.view=new ta(c,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${g}, 1fr)`,this.cellCs_.forEach(k=>{k.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(k.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(c){const e=this.cellValues_.findIndex(g=>g===c);return e<0?null:this.cellCs_[e]}onCellInputChange_(c){const e=c.currentTarget,g=this.cellCs_.findIndex(h=>h.view.inputElement===e);if(g<0)return;this.value.rawValue=this.cellValues_[g]}}const Zc=function(){return{id:"radiogrid",type:"blade",accept(c){const e=C,g=R(c,{cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string});return g?{params:g}:null},controller(c){return new ya(c.document,{blade:c.blade,props:X.fromObject({label:c.params.label}),valueController:new ua(c.document,{groupName:c.params.groupName,cellConfig:c.params.cells,size:c.params.size,value:da(c.params.value)})})},api(c){return c.controller instanceof ya?c.controller.valueController instanceof ua?new nc(c.controller):null:null}}}(),oc={id:"input-radiogrid",type:"input",accept(c,e){if(typeof c!=="number")return null;const g=C,h=R(e,{cells:g.required.function,groupName:g.required.string,size:g.required.array(g.required.number),view:g.required.constant("radiogrid")});return h?{initialValue:c,params:h}:null},binding:{reader:c=>Ta,writer:c=>xd},controller:c=>new ua(c.document,{cellConfig:c.params.cells,groupName:c.params.groupName,size:c.params.size,value:c.value})},pc=[dc,Vc,Qd,Td,Zc,oc];t.CubicBezier=Pa,t.plugins=pc,Object.defineProperty(t,"__esModule",{value:!0})})});var oe=ub((j,p)=>{"use strict";(function(){function t(n,B){let s={};return[n,B].forEach(function(v){for(let P in v)Object.prototype.hasOwnProperty.call(v,P)&&(s[P]=v[P])}),s}function m(n){if(typeof n!=="string"||!n.match(/^data:image\/webp;base64,/i))throw new Error("Failed to decode WebP Base64 URL");return window.atob(n.substring("data:image/webp;base64,".length))}function q(n,B){let s=typeof n==="string"&&/^data:image\/webp/.test(n)?n:n.toDataURL("image/webp",B);return m(s)}function E(n){let B=n.charCodeAt(0),s=n.charCodeAt(1),v=n.charCodeAt(2),P=n.charCodeAt(3);return(B|s<<8|v<<16|P<<24)>>>0}function J(n){let B=n.indexOf("VP8",12);if(B===-1)throw new Error("Bad image format, does this browser support WebP?");let s=!1;for(;B<n.length-8;){let v,P;P=n.substring(B,B+4),B+=4,v=E(n.substring(B,B+4)),B+=4;switch(P){case"VP8 ":return{frame:n.substring(B,B+v),hasAlpha:s};case"ALPH":s=!0;break}B+=v,(v&1)!==0&&B++}throw new Error("Failed to find VP8 keyframe in WebP image, is this image mistakenly encoded in the Lossless WebP format?")}const L=-1,_=-2;function H(n){this.value=n}function A(n){this.value=n}function ha(n,B,s){if(Array.isArray(s))for(let v=0;v<s.length;v++)ha(n,B,s[v]);else if(typeof s==="string")n.writeString(s);else if(s instanceof Uint8Array)n.writeBytes(s);else if(s.id){s.offset=n.pos+B,n.writeUnsignedIntBE(s.id);if(Array.isArray(s.data)){let v,P,z;s.size===L?n.writeByte(255):s.size===_?(v=n.pos,n.writeBytes([15,255,255,255,255])):(v=n.pos,n.writeBytes([0,0,0,0])),P=n.pos,s.dataOffset=P+B,ha(n,B,s.data),s.size!==L&&s.size!==_&&(z=n.pos,s.size=z-P,n.seek(v),n.writeEBMLVarIntWidth(s.size,4),n.seek(z))}else if(typeof s.data==="string")n.writeEBMLVarInt(s.data.length),s.dataOffset=n.pos+B,n.writeString(s.data);else if(typeof s.data==="number")s.size||(s.size=n.measureUnsignedInt(s.data)),n.writeEBMLVarInt(s.size),s.dataOffset=n.pos+B,n.writeUnsignedIntBE(s.data,s.size);else if(s.data instanceof A)n.writeEBMLVarInt(8),s.dataOffset=n.pos+B,n.writeDoubleBE(s.data.value);else if(s.data instanceof H)n.writeEBMLVarInt(4),s.dataOffset=n.pos+B,n.writeFloatBE(s.data.value);else if(s.data instanceof Uint8Array)n.writeEBMLVarInt(s.data.byteLength),s.dataOffset=n.pos+B,n.writeBytes(s.data);else throw new Error("Bad EBML datatype "+typeof s.data)}else throw new Error("Bad EBML datatype "+typeof s.data)}let y=function(n,B){return function(s){let v=5e3,P=1,z=!1,Ra=0,wa=0,aa=null,$=null,xa=null,ba=[],da=0,X=0,Nb={quality:.95,transparent:!1,alphaQuality:void 0,fileWriter:null,fd:null,frameDuration:null,frameRate:null},Ha={Cues:{id:new Uint8Array([28,83,187,107]),positionEBML:null},SegmentInfo:{id:new Uint8Array([21,73,169,102]),positionEBML:null},Tracks:{id:new Uint8Array([22,84,174,107]),positionEBML:null}},Ia,ma={id:17545,data:new A(0)},Y,C=[],R=new B(s.fileWriter||s.fd);function Wa(w){return w-Ia.dataOffset}function Ob(w){(aa===null||aa.width!==w.width||aa.height!==w.height)&&(aa=document.createElement("canvas"),aa.width=w.width,aa.height=w.height,$=aa.getContext("2d"),xa=$.createImageData(aa.width,aa.height));let F=w.getContext("2d"),Z=F.getImageData(0,0,w.width,w.height).data,I=xa.data,ea=0,ta=w.width*w.height*4;for(let ya=3;ya<ta;ya+=4){let gb=Z[ya];I[ea++]=gb,I[ea++]=gb,I[ea++]=gb,I[ea++]=255}return $.putImageData(xa,0,0),aa}function na(){let w={id:21420,size:5,data:0},F={id:290298740,data:[]};for(let Z in Ha){let I=Ha[Z];I.positionEBML=Object.create(w),F.data.push({id:19899,data:[{id:21419,data:I.id},I.positionEBML]})}return F}function Xa(){Y=na();let w={id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:"webm"},{id:17031,data:2},{id:17029,data:2}]},F={id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:"webm-writer-js"},{id:22337,data:"webm-writer-js"},ma]},Z=[{id:176,data:Ra},{id:186,data:wa}];s.transparent&&Z.push({id:21440,data:1});let I={id:374648427,data:[{id:174,data:[{id:215,data:P},{id:29637,data:P},{id:156,data:0},{id:2274716,data:"und"},{id:134,data:"V_VP8"},{id:2459272,data:"VP8"},{id:131,data:1},{id:224,data:Z}]}]};Ia={id:408125543,size:_,data:[Y,F,I]};let ea=new n(256);ha(ea,R.pos,[w,Ia]),R.write(ea.getAsDataArray()),Ha.SegmentInfo.positionEBML.data=Wa(F.offset),Ha.Tracks.positionEBML.data=Wa(I.offset),z=!0}function S(w){let F,Z,I=new n(1+2+1);if(!(w.trackNumber>0&&w.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return I.writeEBMLVarInt(w.trackNumber),I.writeU16BE(w.timecode),I.writeByte(0),F={id:161,data:[I.getAsDataArray(),w.frame]},Z={id:30113,data:[{id:166,data:[{id:238,data:1},{id:165,data:w.alpha}]}]},{id:160,data:[F,Z]}}function N(w){let F=new n(1+2+1);if(!(w.trackNumber>0&&w.trackNumber<127))throw new Error("TrackNumber must be > 0 and < 127");return F.writeEBMLVarInt(w.trackNumber),F.writeU16BE(w.timecode),F.writeByte(1<<7),{id:163,data:[F.getAsDataArray(),w.frame]}}function Ya(w){return w.alpha?S(w):N(w)}function Pb(w){return{id:524531317,data:[{id:231,data:Math.round(w.timecode)}]}}function fb(w,F,Z){C.push({id:187,data:[{id:179,data:F},{id:183,data:[{id:247,data:w},{id:241,data:Wa(Z)}]}]})}function vb(){let w={id:475249515,data:C},F=new n(16+C.length*32);ha(F,R.pos,w),R.write(F.getAsDataArray()),Ha.Cues.positionEBML.data=Wa(w.offset)}function Ja(){if(ba.length===0)return;let w=0;for(let I=0;I<ba.length;I++)w+=ba[I].frame.length+(ba[I].alpha?ba[I].alpha.length:0);let F=new n(w+ba.length*64),Z=Pb({timecode:Math.round(da)});for(let I=0;I<ba.length;I++)Z.data.push(Ya(ba[I]));ha(F,R.pos,Z),R.write(F.getAsDataArray()),fb(P,Math.round(da),Z.offset),ba=[],da+=X,X=0}function ca(){if(!s.frameDuration)if(s.frameRate)s.frameDuration=1e3/s.frameRate;else throw new Error("Missing required frameDuration or frameRate setting");s.quality=Math.max(Math.min(s.quality,.99999),0),s.alphaQuality===void 0?s.alphaQuality=s.quality:s.alphaQuality=Math.max(Math.min(s.alphaQuality,.99999),0)}function Za(w){w.trackNumber=P,w.timecode=Math.round(X),ba.push(w),X+=w.duration,X>=v&&Ja()}function wb(){let w=new n(Y.size),F=R.pos;ha(w,Y.dataOffset,Y.data),R.seek(Y.dataOffset),R.write(w.getAsDataArray()),R.seek(F)}function Ka(){let w=new n(8),F=R.pos;w.writeDoubleBE(da),R.seek(ma.dataOffset),R.write(w.getAsDataArray()),R.seek(F)}function Qb(){let w=new n(10),F=R.pos;w.writeUnsignedIntBE(Ia.id),w.writeEBMLVarIntWidth(R.pos-Ia.dataOffset,5),R.seek(Ia.offset),R.write(w.getAsDataArray()),R.seek(F)}this.addFrame=function(w,F,Z){z||(Ra=w.width||0,wa=w.height||0,Xa());let I=J(q(w,s.quality)),ea,ta=null;Z?ea=Z:typeof F=="number"?ea=F:ea=s.frameDuration,s.transparent&&(F instanceof HTMLCanvasElement||typeof F==="string"?ta=F:I.hasAlpha&&(ta=Ob(w))),Za({frame:I.frame,duration:ea,alpha:ta?J(q(ta,s.alphaQuality)).frame:null})},this.complete=function(){return z||Xa(),Ja(),vb(),wb(),Ka(),Qb(),R.complete("video/webm")},this.getWrittenSize=function(){return R.length},s=t(Nb,s||{}),ca()}};typeof p!=="undefined"&&typeof p.exports!=="undefined"?p.exports=y:window.WebMWriter=y(window.ArrayBufferDataStream,window.BlobBuffer)})()});var me=ub((j,p)=>{"use strict";(function(){let t=function(m){this.data=new Uint8Array(m),this.pos=0};t.prototype.seek=function(m){this.pos=m},t.prototype.writeBytes=function(m){for(let q=0;q<m.length;q++)this.data[this.pos++]=m[q]},t.prototype.writeByte=function(m){this.data[this.pos++]=m},t.prototype.writeU8=t.prototype.writeByte,t.prototype.writeU16BE=function(m){this.data[this.pos++]=m>>8,this.data[this.pos++]=m},t.prototype.writeDoubleBE=function(m){let q=new Uint8Array(new Float64Array([m]).buffer);for(let E=q.length-1;E>=0;E--)this.writeByte(q[E])},t.prototype.writeFloatBE=function(m){let q=new Uint8Array(new Float32Array([m]).buffer);for(let E=q.length-1;E>=0;E--)this.writeByte(q[E])},t.prototype.writeString=function(m){for(let q=0;q<m.length;q++)this.data[this.pos++]=m.charCodeAt(q)},t.prototype.writeEBMLVarIntWidth=function(m,q){switch(q){case 1:this.writeU8(1<<7|m);break;case 2:this.writeU8(1<<6|m>>8),this.writeU8(m);break;case 3:this.writeU8(1<<5|m>>16),this.writeU8(m>>8),this.writeU8(m);break;case 4:this.writeU8(1<<4|m>>24),this.writeU8(m>>16),this.writeU8(m>>8),this.writeU8(m);break;case 5:this.writeU8(1<<3|m/4294967296&7),this.writeU8(m>>24),this.writeU8(m>>16),this.writeU8(m>>8),this.writeU8(m);break;default:throw new Error("Bad EBML VINT size "+q)}},t.prototype.measureEBMLVarInt=function(m){if(m<(1<<7)-1)return 1;{if(m<(1<<14)-1)return 2;{if(m<(1<<21)-1)return 3;{if(m<(1<<28)-1)return 4;{if(m<34359738367)return 5;throw new Error("EBML VINT size not supported "+m)}}}}},t.prototype.writeEBMLVarInt=function(m){this.writeEBMLVarIntWidth(m,this.measureEBMLVarInt(m))},t.prototype.writeUnsignedIntBE=function(m,q){q===void 0&&(q=this.measureUnsignedInt(m));switch(q){case 5:this.writeU8(Math.floor(m/4294967296));case 4:this.writeU8(m>>24);case 3:this.writeU8(m>>16);case 2:this.writeU8(m>>8);case 1:this.writeU8(m);break;default:throw new Error("Bad UINT size "+q)}},t.prototype.measureUnsignedInt=function(m){return m<1<<8?1:m<1<<16?2:m<1<<24?3:m<4294967296?4:5},t.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);{if(this.pos==this.data.byteLength)return this.data;throw new Error("ArrayBufferDataStream's pos lies beyond end of buffer")}},typeof p!=="undefined"&&typeof p.exports!=="undefined"?p.exports=t:window.ArrayBufferDataStream=t})()});var ne=ub((j,p)=>{"use strict";(function(){let t=function(m){return function(q){let E=[],J=Promise.resolve(),L=null,_=null;q&&q.constructor.name==="FileWriter"?L=q:m&&q&&(_=q),this.pos=0,this.length=0;function H(y){return new Promise(function(n,B){let s=new FileReader();s.addEventListener("loadend",function(){n(s.result)}),s.readAsArrayBuffer(y)})}function A(y){return new Promise(function(n,B){y instanceof Uint8Array?n(y):y instanceof ArrayBuffer||ArrayBuffer.isView(y)?n(new Uint8Array(y)):y instanceof Blob?n(H(y).then(function(s){return new Uint8Array(s)})):n(H(new Blob([y])).then(function(s){return new Uint8Array(s)}))})}function ha(y){let n=y.byteLength||y.length||y.size;if(!Number.isInteger(n))throw new Error("Failed to determine size of element");return n}this.seek=function(y){if(y<0)throw new Error("Offset may not be negative");if(isNaN(y))throw new Error("Offset may not be NaN");if(y>this.length)throw new Error("Seeking beyond the end of file is not allowed");this.pos=y},this.write=function(y){let n={offset:this.pos,data:y,length:ha(y)},B=n.offset>=this.length;this.pos+=n.length,this.length=Math.max(this.length,this.pos),J=J.then(function(){if(_)return new Promise(function(s,v){A(n.data).then(function(P){let z=0,Ra=Buffer.from(P.buffer),wa=function(aa,$,xa){z+=$,z>=xa.length?s():m.write(_,xa,z,xa.length-z,n.offset+z,wa)};m.write(_,Ra,0,Ra.length,n.offset,wa)})});{if(L)return new Promise(function(s,v){L.onwriteend=s,L.seek(n.offset),L.write(new Blob([n.data]))});if(!B)for(let s=0;s<E.length;s++){let v=E[s];if(!(n.offset+n.length<=v.offset||n.offset>=v.offset+v.length)){if(n.offset<v.offset||n.offset+n.length>v.offset+v.length)throw new Error("Overwrite crosses blob boundaries");if(n.offset==v.offset&&n.length==v.length){v.data=n.data;return}else return A(v.data).then(function(P){return v.data=P,A(n.data)}).then(function(P){n.data=P,v.data.set(n.data,n.offset-v.offset)})}}}E.push(n)})},this.complete=function(y){return _||L?J=J.then(function(){return null}):J=J.then(function(){let n=[];for(let B=0;B<E.length;B++)n.push(E[B].data);return new Blob(n,{type:y})}),J}}};typeof p!=="undefined"&&typeof p.exports!=="undefined"?p.exports=t:window.BlobBuffer=t(null)})()});var pe=ub((j,p)=>{p.exports=oe()(me(),ne()(null))});class Ze{constructor(j){this.matrix=new DOMMatrix(),this.scale=1,this.rotation=0}setScale(j){this.scale=j,this.update()}setRotation(j){this.rotation=j,this.update()}setPattern(j){this.pattern=j,this.update()}update(){if(!this.pattern)return;try{this.pattern.setTransform(this.matrix.scale(this.scale).rotate(this.rotation))}catch(j){this.matrix=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this.pattern.setTransform(this.matrix.scale(this.scale).rotate(this.rotation))}}render(j,p){const t=j.canvas.width,m=j.canvas.height,q=t/2,E=m/2,J=Math.sqrt(t*t+m*m),L=J/2;j.save(),j.fillStyle=p.backgroundColor,j.fillRect(0,0,j.canvas.width,j.canvas.height);let _=Math.PI/p.symmetries;j.translate(q,E),j.rotate(p.angle/180*Math.PI);for(let H=0;H<p.symmetries;H++)j.rotate(_*2),this.drawSlice(j,L,1,_,p.offset.x*t,p.offset.y*m),j.scale(1,-1),this.drawSlice(j,L,1,_,p.offset.x*t,p.offset.y*m),j.scale(1,-1);j.restore()}drawSlice(j,p,t,m,q,E){j.save(),q=(q||0)*t,E=(E||0)*t,j.translate(q,E),j.fillStyle=this.pattern,j.beginPath(),j.moveTo(-q,-E),j.lineTo(p-q,-E),j.lineTo(p-q,Math.tan(m)*p-E),j.closePath(),j.fill(),j.restore()}}var se=Ze;class $e{constructor(j){this.canvas=j,this.width=this.canvas.width,this.height=this.canvas.height,this.ctx=j.getContext("2d")}clear(j){j?(this.ctx.save(),this.ctx.fillStyle=j,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.restore()):this.ctx.clearRect(0,0,this.width,this.height)}drawText(j,p="bold 48px sans-serif"){this.ctx.font=p;const t=this.ctx.measureText(j).width;this.ctx.fillText(j,this.width/2-t/2,this.height/2)}setScale(j){this.scale=j,this.resize()}setWidth(j){this.width=j,this.resize()}setHeight(j){this.height=j,this.resize()}resize(){this.canvas.width=this.width,this.canvas.style.width=`${this.width/this.scale}px`,this.canvas.height=this.height,this.canvas.style.height=`${this.height/this.scale}px`}}var te=$e;const Te={linear:j=>j,easeInQuad:j=>j*j,easeOutQuad:j=>j*(2-j),easeInOutQuad:j=>j<.5?2*j*j:-1+(4-2*j)*j,easeInCubic:j=>j*j*j,easeOutCubic:j=>--j*j*j+1,easeInOutCubic:j=>j<.5?4*j*j*j:(j-1)*(2*j-2)*(2*j-2)+1,easeInQuart:j=>j*j*j*j,easeOutQuart:j=>1- --j*j*j*j,easeInOutQuart:j=>j<.5?8*j*j*j*j:1-8*--j*j*j*j,easeInQuint:j=>j*j*j*j*j,easeOutQuint:j=>1+--j*j*j*j*j,easeInOutQuint:j=>j<.5?16*j*j*j*j*j:1+16*--j*j*j*j*j};var uc=Te;class Ue{constructor(){this.listeners={}}addEventListener(j,p){this.listeners[j]=this.listeners[j]||[],this.listeners[j].push(p)}removeEventListener(j,p){this.listeners[j]=this.listeners[j]||[],this.listeners[j]=this.listeners[j].filter(t=>t!==p)}trigger(j,p,t){this.listeners[j]&&this.listeners[j].forEach(m=>m({type:j,name:p,value:t}))}}var vc=Ue;const bh=fd(le()),We=fd(ke());class Xe extends vc{constructor(j){super();this.listeners={},this.config=j,this.gui=new bh.Pane({load:JSON}),this.gui.registerPlugin(We);const p=v=>P=>{this.triggerChange(v,P)},t=this.gui.addFolder({title:"Canvas",expanded:!0});t.addInput(j,"backgroundColor",{label:"Background color"}).on("change",p("backgroundColor")),t.addInput(j,"width",{min:10,max:4096,step:1}).on("change",p("width")),t.addInput(j,"height",{min:10,max:4096,step:1}).on("change",p("height")),t.addInput(j,"scale",{min:1,max:4,step:1}).on("change",p("scale")),t.addInput(j,"angle",{min:-360,max:360}).on("change",p("angle"));const m=this.gui.addFolder({title:"Pattern",expanded:!0});m.addInput(j,"symmetries",{min:4,max:32,step:1}).on("change",p("symmetries")),m.addInput(j,"patternScale",{label:"scale",min:.05,max:4,step:.05}).on("change",p("patternScale")),m.addInput(j,"patternAngle",{label:"angle",min:-360,max:360,step:1}).on("change",p("patternAngle")),m.addInput(j,"offset",{x:{min:-1,max:1,step:.01},y:{min:-1,max:1,step:.01}}).on("change",p("offset")),m.addButton({title:"Load pattern..."}).on("click",()=>{document.getElementById("patternFile").click()}),m.addButton({title:"Save Image..."}).on("click",()=>this.trigger("click","saveImage"));const q=this.gui.addFolder({title:"Animation",expanded:!0});q.addInput(j,"duration",{label:"Duration",min:1,max:600,step:1}).on("change",p("duration")),q.addInput(j,"easing",{label:"Easing",options:Object.keys(uc).reduce((v,P)=>(v[P]=P,v),{})}).on("change",p("easing")),q.addInput(j,"currentKeyframe",{label:"Current Keyframe",disabled:!0,step:1});let E,J,L,_,H,A,ha,y,n,B,s;this.updateAnimationGui=()=>{this.config.isPlayingAnimation?(J.hidden=!0,L.hidden=!1):(J.hidden=!1,L.hidden=!0);const v=this.config.isPlayingAnimation||this.config.isRecordingAnimation||this.config.isBusy;if(v){_.disabled=A.disabled=H.disabled=ha.disabled=y.disabled=B.disabled=s.disabled=E.disabled=n.disabled=!0;return}J.disabled=_.disabled=this.config.keyframes.length<2,this.config.isPlayingAnimation&&(J.disabled=!1),A.disabled=this.config.currentKeyframe<=0,H.disabled=this.config.currentKeyframe<0||this.config.currentKeyframe>=this.config.totalKeyframes-1,ha.disabled=this.config.totalKeyframes<=1,y.disabled=this.config.totalKeyframes<=1,B.disabled=!this.config.keyframeClipboard,s.disabled=E.disabled=n.disabled=!this.config.file},A=q.addButton({title:"Previous keyframe",disabled:!0}).on("click",()=>{this.trigger("click","prevKeyframe"),this.updateAnimationGui()}),H=q.addButton({title:"Next keyframe",disabled:!0}).on("click",()=>{this.trigger("click","nextKeyframe"),this.updateAnimationGui()}),q.addSeparator(),E=q.addButton({title:"New keyframe",disabled:!0}).on("click",()=>{this.trigger("click","newKeyframe"),this.updateAnimationGui()}),ha=q.addButton({title:"Delete keyframe",disabled:!0}).on("click",()=>{this.trigger("click","deleteKeyframe"),this.updateAnimationGui()}),y=q.addButton({title:"Clear keyframes",disabled:!0}).on("click",()=>{this.trigger("click","resetKeyframes"),this.updateAnimationGui()}),q.addSeparator(),n=q.addButton({title:"Copy keyframe",disabled:!0}).on("click",()=>{this.trigger("click","copyKeyframe"),this.updateAnimationGui()}),B=q.addButton({title:"Paste keyframe",disabled:!0}).on("click",()=>{this.trigger("click","pasteKeyframe"),this.updateAnimationGui()}),s=q.addButton({title:"Randomize",disabled:!0}).on("click",()=>this.trigger("click","randomize")),q.addSeparator(),q.addInput(j,"fps",{label:"FPS",min:1,max:60,step:1}).on("change",p("fps")),q.addInput(j,"loop",{label:"Loop"}),q.addInput(j,"editAllKeyframes",{label:"Edit All Keyframes"}).on("change",p("editAllKeyframes")),q.addInput(j,"firstFrameAsLastFrame",{label:"First frame as last"}),J=q.addButton({title:"Play animation",disabled:!0}).on("click",()=>{this.trigger("click","playAnimation"),this.updateAnimationGui()}),L=q.addButton({title:"Stop",hidden:!0}).on("click",()=>{this.trigger("click","stopAnimation"),this.updateAnimationGui()}),_=q.addButton({title:"Export animation...",disabled:!0}).on("click",()=>{this.trigger("click","exportAnimation"),this.updateAnimationGui()})}triggerChange(j,p){this.trigger("change",j,p)}getValue(j){return this.config[j]}setValue(j,p){this.config[j]=p,this.update()}update(){this.gui.refresh(),this.updateAnimationGui&&this.updateAnimationGui()}increaseValue(j,p){this.setValue(j,this.getValue(j)+p)}}var re=Xe;function qe(j){j=j||{},this.width=j.width||2048,this.height=j.height||2048,this.scale=j.scale||4,this.angle=j.angle||0,this.offset=j.offset||{x:0,y:0},this.patternScale=j.patternScale||1,this.patternAngle=j.patternAngle||0,this.symmetries=j.symmetries||7,this.backgroundColor="#000",this.isPlayingAnimation=!1,this.isRecordingAnimation=!1,this.isBusy=!1,this.loop=!1,this.firstFrameAsLastFrame=!1,this.randomize=()=>{this.angle=Math.floor(Math.random()*360),this.offset.x=Math.random(),this.offset.y=Math.random(),this.patternScale=Math.random()*4,this.patternAngle=Math.floor(Math.random()*360),this.symmetries=Math.floor(Math.random()*16)+4},this.file=void 0,this.keyframes=[],this.keyframeClipboard=void 0,this.fps=j.fps||30,this.editAllKeyframes=!1,this.duration=this.fps,this.totalKeyframes=0,this.currentKeyframe=0,this.toKeyframe=()=>({angle:this.angle,offset:{x:this.offset.x,y:this.offset.y},patternScale:this.patternScale,patternAngle:this.patternAngle,symmetries:this.symmetries,easing:this.easing,duration:this.duration}),this.fromKeyframe=()=>{const p=this.keyframes[this.currentKeyframe];this.angle=p.angle,this.offset={x:p.offset.x,y:p.offset.y},this.patternScale=p.patternScale,this.patternAngle=p.patternAngle,this.symmetries=p.symmetries,this.easing=p.easing,this.duration=p.duration},this.updateKeyframe=p=>{this.keyframes[this.currentKeyframe]=p||this.toKeyframe()},this.addKeyframe=()=>{this.keyframes[this.currentKeyframe]=this.toKeyframe(),this.keyframes.splice(this.currentKeyframe,0,this.toKeyframe()),this.currentKeyframe++,this.totalKeyframes=this.keyframes.length},this.nextKeyframe=()=>{this.updateKeyframe(),this.currentKeyframe<this.totalKeyframes-1&&(this.currentKeyframe++,this.fromKeyframe())},this.prevKeyframe=()=>{this.updateKeyframe(),this.currentKeyframe>0&&(this.currentKeyframe--,this.fromKeyframe())},this.copyKeyframe=()=>this.keyframeClipboard=this.toKeyframe(),this.pasteKeyframe=()=>{this.updateKeyframe(this.keyframeClipboard),this.fromKeyframe()},this.deleteKeyframe=()=>{this.totalKeyframes>0&&(this.keyframes.splice(this.currentKeyframe,1),Math.max(0,this.currentKeyframe--),this.totalKeyframes=this.keyframes.length)},this.resetKeyframes=()=>{this.keyframes=[this.keyframes[0]],this.totalKeyframes=this.keyframes.length,this.currentKeyframe=0},this.record=()=>{},this.easing="linear"}const sh=fd(pe());class bf{constructor(j={}){this.config={quality:j.quality||.95,frameRate:j.frameRate||30,transparent:!1,alphaQuality:void 0},this.reset()}reset(){this.video=new sh.default(this.config)}save(j="mandala.webm"){this.video.complete().then(p=>{const t=document.createElement("a");t.href=(window.webkitURL||window.URL).createObjectURL(p),t.download=j,t.click()})}addFrame(j){this.video.addFrame(j)}}var ue=bf;class _e extends vc{play(j,p,t){this.mandala=j,window.OffscreenCanvas?this.ctx=new OffscreenCanvas(p.width,p.height).getContext("2d"):this.ctx=p.ctx,this.keyframes=[...t.keyframes],t.firstFrameAsLastFrame&&this.keyframes.push(this.keyframes[0]),this.currentFrame=0,this.currentKeyframe=-1,this.nextKeyframe(),this.trigger("started",this),this.delay=t.isRecordingAnimation?1:1e3/t.fps,this.loop=!t.isRecordingAnimation&&t.loop,this.isPlaying=!0,this.render()}stop(){this.isPlaying=!1}nextKeyframe(){this.currentKeyframe++,this.currentFrame=0;if(this.currentKeyframe>=this.keyframes.length-1)return this.loop?(this.currentFrame=0,this.currentKeyframe=-1,this.nextKeyframe()):void 0;const j=this.keyframes[this.currentKeyframe];this.easing=uc[j.easing]}interpolate(j,p,t){const m=this.easing(t);return{angle:(p.angle-j.angle)*m+j.angle,offset:{x:(p.offset.x-j.offset.x)*m+j.offset.x,y:(p.offset.y-j.offset.y)*m+j.offset.y},patternScale:(p.patternScale-j.patternScale)*m+j.patternScale,patternAngle:(p.patternAngle-j.patternAngle)*m+j.patternAngle,symmetries:(p.symmetries-j.symmetries)*m+j.symmetries}}render(){clearTimeout(this.renderTimeout);if(!this.isPlaying)return;this.renderTimeout=setTimeout(()=>{if(this.currentKeyframe>=this.keyframes.length-1){this.trigger("ended",this);return}const j=this.keyframes[this.currentKeyframe],p=this.keyframes[this.currentKeyframe+1];let t=this.currentFrame/j.duration;const m=this.interpolate(j,p,t);this.mandala.setScale(m.patternScale),this.mandala.setRotation(m.patternAngle),this.mandala.render(this.ctx,m),this.trigger("change",this),this.currentFrame++,this.currentFrame>j.duration&&this.nextKeyframe(),this.render()},this.delay)}}var ve=_e;const ga=(j,p,t,m)=>{if(j&&p&&t)for(var q=String(p).split(" ");q.length;)p=q.pop(),j.addEventListener?j.addEventListener(p,t,m):j.attachEvent("on"+p,t,m)};class Ye{constructor(j){const p=document.querySelector(j);this.config=new qe(),this.gui=new re(this.config),this.mandala=new se(),this.player=new ve(),this.stage=new te(p),this.stage.clear("white"),this.stage.setScale(this.gui.getValue("scale")),this.stage.drawText("DROP IMAGE HERE"),this.bindEvents()}bindEvents(){let j=!1;ga(document.getElementById("patternFile"),"change",m=>{this.onFileChange(m.target.files[0])}),ga(this.stage.canvas,"mousedown",m=>{m.button===0&&(j=!0)}),ga(document,"mouseup",m=>{j=!1}),ga(document,"mousemove",m=>{if(!j)return;if(m.shiftKey)this.gui.increaseValue("angle",m.movementX/10);else if(m.altKey)this.gui.increaseValue("patternAngle",m.movementX/10);else{const q=this.gui.getValue("offset");this.gui.setValue("offset",{y:q.y-m.movementY/this.stage.height,x:q.x-m.movementX/this.stage.width})}});const p={x:void 0,y:void 0};ga(this.stage.canvas,"touchstart",m=>{j=!0;const q=event.changedTouches[0];p.x=q.clientX,p.y=q.clientY}),ga(document,"touchend touchcancel",m=>{j=!1}),ga(document,"touchmove",m=>{if(!j)return;const q=event.changedTouches[0],E=q.clientX-p.x,J=q.clientY-p.y;p.x=q.clientX,p.y=q.clientY;const L=this.gui.getValue("offset");this.gui.setValue("offset",{y:L.y-J/this.stage.height,x:L.x-E/this.stage.width})}),ga(this.stage.canvas,"wheel",m=>{m.preventDefault(),this.gui.increaseValue("patternScale",m.deltaY*-.001)}),ga(window,"dragover",m=>m.preventDefault()),ga(window,"drop",m=>{m.preventDefault();const q=m.dataTransfer.files[0];this.onFileChange(q)});const t=(m,q)=>{this.config.editAllKeyframes&&this.config.keyframes.forEach(E=>E[m]=q)};ga(this.gui,"change",({name:m,value:{value:q}})=>{switch(m){case"patternAngle":this.mandala.setRotation(q),t(m,q);break;case"patternScale":this.mandala.setScale(q),t(m,q);break;case"scale":this.stage.setScale(q),t(m,q);break;case"width":this.stage.setWidth(q);break;case"height":this.stage.setHeight(q);break;case"editAllKeyframes":q?document.body.classList.add("warning"):document.body.classList.remove("warning");break;case"duration":case"angle":case"offset":case"symmetries":case"easing":t(m,q);break}this.render()}),ga(this.gui,"click",({name:m})=>{switch(m){case"saveImage":const q=document.createElement("a");q.download="mandala.png",q.href=document.getElementById("stage").toDataURL("image/png").replace(/^data:image\/[^;]/,"data:application/octet-stream"),q.click();break;case"pasteKeyframe":this.config.pasteKeyframe(),this.gui.update();break;case"copyKeyframe":this.config.copyKeyframe(),this.gui.update();break;case"deleteKeyframe":this.config.deleteKeyframe(),this.gui.update();break;case"resetKeyframes":this.config.resetKeyframes(),this.gui.update();break;case"newKeyframe":this.config.addKeyframe(),this.gui.update();break;case"nextKeyframe":this.config.nextKeyframe(),this.gui.update();break;case"prevKeyframe":this.config.prevKeyframe(),this.gui.update();break;case"loadFile":document.getElementById("filePattern").click();break;case"exportAnimation":this.config.isRecordingAnimation=!0;case"playAnimation":this.config.updateKeyframe(),this.config.busy=!0,this.gui.update(),this.player.play(this.mandala,this.stage,this.config);break;case"stopAnimation":this.config.isRecordingAnimation=!1,this.config.isPlayingAnimation=!1,this.config.busy=!1,this.gui.update(),this.player.stop();break;case"randomize":this.config.randomize(),this.mandala.setScale(this.config.patternScale),this.mandala.setRotation(this.config.patternRotation),this.gui.update();break}}),ga(this.player,"started",()=>{this.config.isPlayingAnimation=!0,this.config.isRecordingAnimation&&(this.video=new ue({frameRate:this.config.fps}))}),ga(this.player,"ended",()=>{this.config.isRecordingAnimation&&this.video.save(),this.config.isPlayingAnimation=!1,this.config.isRecordingAnimation=!1,this.config.busy=!1,this.gui.update()}),ga(this.player,"change",()=>{this.config.isRecordingAnimation&&this.video.addFrame(this.player.ctx.canvas)})}onFileChange(j){if(!j)return;const p=new Image();p.src=URL.createObjectURL(j),p.addEventListener("load",()=>{this.mandala.setPattern(this.stage.ctx.createPattern(p,"repeat")),this.config.file=j,this.gui.update(),this.render()})}render(){clearTimeout(this.renderTimeout),this.renderTimeout=setTimeout(()=>{this.stage.clear(),this.mandala.render(this.stage.ctx,this.config)},1)}}window.MandalaApp=Ye;})();
/*! Tweakpane 3.0.8 (c) 2016 cocopon, licensed under the MIT license. */
