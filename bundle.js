(()=>{class bb{constructor(c){this.matrix=new DOMMatrix(),this.scale=1,this.rotation=0}setScale(c){this.scale=c,this.update()}setRotation(c){this.rotation=c,this.update()}setPattern(c){this.pattern=c,this.update()}update(){if(!this.pattern)return;try{this.pattern.setTransform(this.matrix.scale(this.scale).rotate(this.rotation))}catch(c){this.matrix=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),this.pattern.setTransform(this.matrix.scale(this.scale).rotate(this.rotation))}}render(c,a){const b=c.canvas.width,d=c.canvas.height,e=b/2,f=d/2,i=Math.sqrt(b*b+d*d),j=i/2;c.save();let k=Math.PI/a.symmetries;c.translate(e,f),c.rotate(a.angle/180*Math.PI);for(let l=0;l<a.symmetries;l++)c.rotate(k*2),this.drawSlice(c,j,a.patternScale,k,a.offset.s*b,a.offset.v*d),c.scale(1,-1),this.drawSlice(c,j,a.patternScale,k,a.offset.s*b,a.offset.v*d),c.scale(1,-1);c.restore()}drawSlice(c,a,b,d,e,f){c.save(),e=(e||0)*b,f=(f||0)*b,c.translate(e,f),c.fillStyle=this.pattern,c.beginPath(),c.moveTo(-e,-f),c.lineTo(a-e,-f),c.lineTo(a-e,Math.tan(d)*a-f),c.closePath(),c.fill(),c.restore()}}var Aa=bb;class cb{constructor(c){this.canvas=c,this.width=this.canvas.width,this.height=this.canvas.height,this.ctx=c.getContext("2d")}clear(c){c?(this.ctx.save(),this.ctx.fillStyle=c,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.restore()):this.ctx.clearRect(0,0,this.width,this.height)}drawText(c,a="bold 48px sans-serif"){this.ctx.font=a;const b=this.ctx.measureText(c).width;this.ctx.fillText(c,this.width/2-b/2,this.height/2)}setScale(c){this.scale=c,this.resize()}setWidth(c){this.width=c,this.resize()}setHeight(c){this.height=c,this.resize()}resize(){this.canvas.width=this.width,this.canvas.style.width=`${this.width/this.scale}px`,this.canvas.height=this.height,this.canvas.style.height=`${this.height/this.scale}px`}}var Ba=cb;function Ca(c){if(!c)return;if(typeof window==="undefined")return;var a=document.createElement("style");return a.setAttribute("type","text/css"),a.innerHTML=c,document.head.appendChild(a),c}function F(c,a){var b=c.__state.conversionName.toString(),d=Math.round(c.r),e=Math.round(c.g),f=Math.round(c.b),i=c.a,j=Math.round(c.h),k=c.s.toFixed(1),l=c.v.toFixed(1);if(a||b==="THREE_CHAR_HEX"||b==="SIX_CHAR_HEX"){for(var q=c.hex.toString(16);q.length<6;)q="0"+q;return"#"+q}else{if(b==="CSS_RGB")return"rgb("+d+","+e+","+f+")";{if(b==="CSS_RGBA")return"rgba("+d+","+e+","+f+","+i+")";{if(b==="HEX")return"0x"+c.hex.toString(16);{if(b==="RGB_ARRAY")return"["+d+","+e+","+f+"]";{if(b==="RGBA_ARRAY")return"["+d+","+e+","+f+","+i+"]";{if(b==="RGB_OBJ")return"{r:"+d+",g:"+e+",b:"+f+"}";{if(b==="RGBA_OBJ")return"{r:"+d+",g:"+e+",b:"+f+",a:"+i+"}";{if(b==="HSV_OBJ")return"{h:"+j+",s:"+k+",v:"+l+"}";if(b==="HSVA_OBJ")return"{h:"+j+",s:"+k+",v:"+l+",a:"+i+"}"}}}}}}}}return"unknown format"}var ga=Array.prototype.forEach,I=Array.prototype.slice,h={BREAK:{},extend:function c(a){return this.each(I.call(arguments,1),function(b){var d=this.isObject(b)?Object.keys(b):[];d.forEach(function(e){this.isUndefined(b[e])||(a[e]=b[e])}.bind(this))},this),a},defaults:function c(a){return this.each(I.call(arguments,1),function(b){var d=this.isObject(b)?Object.keys(b):[];d.forEach(function(e){this.isUndefined(a[e])&&(a[e]=b[e])}.bind(this))},this),a},compose:function c(){var a=I.call(arguments);return function(){for(var b=I.call(arguments),d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}},each:function c(a,b,d){if(!a)return;if(ga&&a.forEach&&a.forEach===ga)a.forEach(b,d);else if(a.length===a.length+0){var e=void 0,f=void 0;for(e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e)===this.BREAK)return}else for(var i in a)if(b.call(d,a[i],i)===this.BREAK)return},defer:function c(a){setTimeout(a,0)},debounce:function c(a,b,d){var e=void 0;return function(){var f=this,i=arguments;function j(){e=null,d||a.apply(f,i)}var k=d||!e;clearTimeout(e),e=setTimeout(j,b),k&&a.apply(f,i)}},toArray:function c(a){return a.toArray?a.toArray():I.call(a)},isUndefined:function c(a){return a===void 0},isNull:function c(a){return a===null},isNaN:function(c){function a(b){return c.apply(this,arguments)}return a.toString=function(){return c.toString()},a}(function(c){return isNaN(c)}),isArray:Array.isArray||function(c){return c.constructor===Array},isObject:function c(a){return a===Object(a)},isNumber:function c(a){return a===a+0},isString:function c(a){return a===a+""},isBoolean:function c(a){return a===!1||a===!0},isFunction:function c(a){return a instanceof Function}},Da=[{litmus:h.isString,conversions:{THREE_CHAR_HEX:{read:function c(a){var b=a.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return b===null?!1:{space:"HEX",hex:parseInt("0x"+b[1].toString()+b[1].toString()+b[2].toString()+b[2].toString()+b[3].toString()+b[3].toString(),0)}},write:F},SIX_CHAR_HEX:{read:function c(a){var b=a.match(/^#([A-F0-9]{6})$/i);return b===null?!1:{space:"HEX",hex:parseInt("0x"+b[1].toString(),0)}},write:F},CSS_RGB:{read:function c(a){var b=a.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return b===null?!1:{space:"RGB",r:parseFloat(b[1]),g:parseFloat(b[2]),b:parseFloat(b[3])}},write:F},CSS_RGBA:{read:function c(a){var b=a.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return b===null?!1:{space:"RGB",r:parseFloat(b[1]),g:parseFloat(b[2]),b:parseFloat(b[3]),a:parseFloat(b[4])}},write:F}}},{litmus:h.isNumber,conversions:{HEX:{read:function c(a){return{space:"HEX",hex:a,conversionName:"HEX"}},write:function c(a){return a.hex}}}},{litmus:h.isArray,conversions:{RGB_ARRAY:{read:function c(a){return a.length!==3?!1:{space:"RGB",r:a[0],g:a[1],b:a[2]}},write:function c(a){return[a.r,a.g,a.b]}},RGBA_ARRAY:{read:function c(a){return a.length!==4?!1:{space:"RGB",r:a[0],g:a[1],b:a[2],a:a[3]}},write:function c(a){return[a.r,a.g,a.b,a.a]}}}},{litmus:h.isObject,conversions:{RGBA_OBJ:{read:function c(a){return h.isNumber(a.r)&&h.isNumber(a.g)&&h.isNumber(a.b)&&h.isNumber(a.a)?{space:"RGB",r:a.r,g:a.g,b:a.b,a:a.a}:!1},write:function c(a){return{r:a.r,g:a.g,b:a.b,a:a.a}}},RGB_OBJ:{read:function c(a){return h.isNumber(a.r)&&h.isNumber(a.g)&&h.isNumber(a.b)?{space:"RGB",r:a.r,g:a.g,b:a.b}:!1},write:function c(a){return{r:a.r,g:a.g,b:a.b}}},HSVA_OBJ:{read:function c(a){return h.isNumber(a.h)&&h.isNumber(a.s)&&h.isNumber(a.v)&&h.isNumber(a.a)?{space:"HSV",h:a.h,s:a.s,v:a.v,a:a.a}:!1},write:function c(a){return{h:a.h,s:a.s,v:a.v,a:a.a}}},HSV_OBJ:{read:function c(a){return h.isNumber(a.h)&&h.isNumber(a.s)&&h.isNumber(a.v)?{space:"HSV",h:a.h,s:a.s,v:a.v}:!1},write:function c(a){return{h:a.h,s:a.s,v:a.v}}}}}],J=void 0,S=void 0,T=function c(){S=!1;var a=arguments.length>1?h.toArray(arguments):arguments[0];return h.each(Da,function(b){if(b.litmus(a))return h.each(b.conversions,function(d,e){J=d.read(a);if(S===!1&&J!==!1)return S=J,J.conversionName=e,J.conversion=d,h.BREAK}),h.BREAK}),S},ha=void 0,K={hsv_to_rgb:function c(a,b,d){var e=Math.floor(a/60)%6,f=a/60-Math.floor(a/60),i=d*(1-b),j=d*(1-f*b),k=d*(1-(1-f)*b),l=[[d,k,i],[j,d,i],[i,d,k],[i,j,d],[k,i,d],[d,i,j]][e];return{r:l[0]*255,g:l[1]*255,b:l[2]*255}},rgb_to_hsv:function c(a,b,d){var e=Math.min(a,b,d),f=Math.max(a,b,d),i=f-e,j=void 0,k=void 0;if(f!==0)k=i/f;else return{h:NaN,s:0,v:0};return a===f?j=(b-d)/i:b===f?j=2+(d-a)/i:j=4+(a-b)/i,j/=6,j<0&&(j+=1),{h:j*360,s:k,v:f/255}},rgb_to_hex:function c(a,b,d){var e=this.hex_with_component(0,2,a);return e=this.hex_with_component(e,1,b),e=this.hex_with_component(e,0,d),e},component_from_hex:function c(a,b){return a>>b*8&255},hex_with_component:function c(a,b,d){return d<<(ha=b*8)|a&~(255<<ha)}},Ea=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol==="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},v=function(c,a){if(!(c instanceof a))throw new TypeError("Cannot call a class as a function")},w=function(){function c(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(a,e.key,e)}}return function(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}}(),z=function c(a,b,d){a===null&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,b);if(e===void 0){var f=Object.getPrototypeOf(a);return f===null?void 0:c(f,b,d)}else{if("value"in e)return e.value;{var i=e.get;return i===void 0?void 0:i.call(d)}}},A=function(c,a){if(typeof a!=="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);c.prototype=Object.create(a&&a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(c,a):c.__proto__=a)},B=function(c,a){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a==="object"||typeof a==="function")?a:c},r=function(){function c(){v(this,c),this.__state=T.apply(this,arguments);if(this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return w(c,[{key:"toString",value:function a(){return F(this)}},{key:"toHexString",value:function a(){return F(this,!0)}},{key:"toOriginal",value:function a(){return this.__state.conversion.write(this)}}]),c}();function X(c,a,b){Object.defineProperty(c,a,{get:function d(){return this.__state.space==="RGB"?this.__state[a]:(r.recalculateRGB(this,a,b),this.__state[a])},set:function d(e){this.__state.space!=="RGB"&&(r.recalculateRGB(this,a,b),this.__state.space="RGB"),this.__state[a]=e}})}function Y(c,a){Object.defineProperty(c,a,{get:function b(){return this.__state.space==="HSV"?this.__state[a]:(r.recalculateHSV(this),this.__state[a])},set:function b(d){this.__state.space!=="HSV"&&(r.recalculateHSV(this),this.__state.space="HSV"),this.__state[a]=d}})}r.recalculateRGB=function(c,a,b){if(c.__state.space==="HEX")c.__state[a]=K.component_from_hex(c.__state.hex,b);else if(c.__state.space==="HSV")h.extend(c.__state,K.hsv_to_rgb(c.__state.h,c.__state.s,c.__state.v));else throw new Error("Corrupted color state")};r.recalculateHSV=function(c){var a=K.rgb_to_hsv(c.r,c.g,c.b);h.extend(c.__state,{s:a.s,v:a.v}),h.isNaN(a.h)?h.isUndefined(c.__state.h)&&(c.__state.h=0):c.__state.h=a.h};r.COMPONENTS=["r","g","b","h","s","v","hex","a"];X(r.prototype,"r",2);X(r.prototype,"g",1);X(r.prototype,"b",0);Y(r.prototype,"h");Y(r.prototype,"s");Y(r.prototype,"v");Object.defineProperty(r.prototype,"a",{get:function c(){return this.__state.a},set:function c(a){this.__state.a=a}});Object.defineProperty(r.prototype,"hex",{get:function c(){return this.__state.space!=="HEX"&&(this.__state.hex=K.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function c(a){this.__state.space="HEX",this.__state.hex=a}});var C=function(){function c(a,b){v(this,c),this.initialValue=a[b],this.domElement=document.createElement("div"),this.object=a,this.property=b,this.__onChange=void 0,this.__onFinishChange=void 0}return w(c,[{key:"onChange",value:function a(b){return this.__onChange=b,this}},{key:"onFinishChange",value:function a(b){return this.__onFinishChange=b,this}},{key:"setValue",value:function a(b){return this.object[this.property]=b,this.__onChange&&this.__onChange.call(this,b),this.updateDisplay(),this}},{key:"getValue",value:function a(){return this.object[this.property]}},{key:"updateDisplay",value:function a(){return this}},{key:"isModified",value:function a(){return this.initialValue!==this.getValue()}}]),c}(),Fa={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},ia={};h.each(Fa,function(c,a){h.each(c,function(b){ia[b]=a})});var Ga=/(\d+(\.\d+)?)px/;function y(c){if(c==="0"||h.isUndefined(c))return 0;var a=c.match(Ga);return h.isNull(a)?0:parseFloat(a[1])}var g={makeSelectable:function c(a,b){if(a===void 0||a.style===void 0)return;a.onselectstart=b?function(){return!1}:function(){},a.style.MozUserSelect=b?"auto":"none",a.style.KhtmlUserSelect=b?"auto":"none",a.unselectable=b?"on":"off"},makeFullscreen:function c(a,b,d){var e=d,f=b;h.isUndefined(f)&&(f=!0),h.isUndefined(e)&&(e=!0),a.style.position="absolute",f&&(a.style.left=0,a.style.right=0),e&&(a.style.top=0,a.style.bottom=0)},fakeEvent:function c(a,b,d,e){var f=d||{},i=ia[b];if(!i)throw new Error("Event type "+b+" not supported.");var j=document.createEvent(i);switch(i){case"MouseEvents":{var k=f.x||f.clientX||0,l=f.y||f.clientY||0;j.initMouseEvent(b,f.bubbles||!1,f.cancelable||!0,window,f.clickCount||1,0,0,k,l,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var q=j.initKeyboardEvent||j.initKeyEvent;h.defaults(f,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),q(b,f.bubbles||!1,f.cancelable,window,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.keyCode,f.charCode);break}default:{j.initEvent(b,f.bubbles||!1,f.cancelable||!0);break}}h.defaults(j,e),a.dispatchEvent(j)},bind:function c(a,b,d,e){var f=e||!1;return a.addEventListener?a.addEventListener(b,d,f):a.attachEvent&&a.attachEvent("on"+b,d),g},unbind:function c(a,b,d,e){var f=e||!1;return a.removeEventListener?a.removeEventListener(b,d,f):a.detachEvent&&a.detachEvent("on"+b,d),g},addClass:function c(a,b){if(a.className===void 0)a.className=b;else if(a.className!==b){var d=a.className.split(/ +/);d.indexOf(b)===-1&&(d.push(b),a.className=d.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return g},removeClass:function c(a,b){if(b)if(a.className===b)a.removeAttribute("class");else{var d=a.className.split(/ +/),e=d.indexOf(b);e!==-1&&(d.splice(e,1),a.className=d.join(" "))}else a.className=void 0;return g},hasClass:function c(a,b){return new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)").test(a.className)||!1},getWidth:function c(a){var b=getComputedStyle(a);return y(b["border-left-width"])+y(b["border-right-width"])+y(b["padding-left"])+y(b["padding-right"])+y(b.width)},getHeight:function c(a){var b=getComputedStyle(a);return y(b["border-top-width"])+y(b["border-bottom-width"])+y(b["padding-top"])+y(b["padding-bottom"])+y(b.height)},getOffset:function c(a){var b=a,d={left:0,top:0};if(b.offsetParent)do d.left+=b.offsetLeft,d.top+=b.offsetTop,b=b.offsetParent;while(b);return d},isActive:function c(a){return a===document.activeElement&&(a.type||a.href)}},Z=function(c){A(a,c);function a(b,d){v(this,a);var e=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d)),f=e;e.__prev=e.getValue(),e.__checkbox=document.createElement("input"),e.__checkbox.setAttribute("type","checkbox");function i(){f.setValue(!f.__prev)}return g.bind(e.__checkbox,"change",i,!1),e.domElement.appendChild(e.__checkbox),e.updateDisplay(),e}return w(a,[{key:"setValue",value:function b(d){var e=z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"setValue",this).call(this,d);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e}},{key:"updateDisplay",value:function b(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"updateDisplay",this).call(this)}}]),a}(C),ja=function(c){A(a,c);function a(b,d,e){v(this,a);var f=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d)),i=e,j=f;f.__select=document.createElement("select");if(h.isArray(i)){var k={};h.each(i,function(l){k[l]=l}),i=k}return h.each(i,function(l,q){var n=document.createElement("option");n.innerHTML=q,n.setAttribute("value",l),j.__select.appendChild(n)}),f.updateDisplay(),g.bind(f.__select,"change",function(){var l=this.options[this.selectedIndex].value;j.setValue(l)}),f.domElement.appendChild(f.__select),f}return w(a,[{key:"setValue",value:function b(d){var e=z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"setValue",this).call(this,d);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e}},{key:"updateDisplay",value:function b(){return g.isActive(this.__select)?this:(this.__select.value=this.getValue(),z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"updateDisplay",this).call(this))}}]),a}(C),ka=function(c){A(a,c);function a(b,d){v(this,a);var e=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d)),f=e;function i(){f.setValue(f.__input.value)}function j(){f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}return e.__input=document.createElement("input"),e.__input.setAttribute("type","text"),g.bind(e.__input,"keyup",i),g.bind(e.__input,"change",i),g.bind(e.__input,"blur",j),g.bind(e.__input,"keydown",function(k){k.keyCode===13&&this.blur()}),e.updateDisplay(),e.domElement.appendChild(e.__input),e}return w(a,[{key:"updateDisplay",value:function b(){return g.isActive(this.__input)||(this.__input.value=this.getValue()),z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"updateDisplay",this).call(this)}}]),a}(C);function la(c){var a=c.toString();return a.indexOf(".")>-1?a.length-a.indexOf(".")-1:0}var _=function(c){A(a,c);function a(b,d,e){v(this,a);var f=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d)),i=e||{};return f.__min=i.min,f.__max=i.max,f.__step=i.step,h.isUndefined(f.__step)?f.initialValue===0?f.__impliedStep=1:f.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(f.initialValue))/Math.LN10))/10:f.__impliedStep=f.__step,f.__precision=la(f.__impliedStep),f}return w(a,[{key:"setValue",value:function b(d){var e=d;return this.__min!==void 0&&e<this.__min?e=this.__min:this.__max!==void 0&&e>this.__max&&(e=this.__max),this.__step!==void 0&&e%this.__step!==0&&(e=Math.round(e/this.__step)*this.__step),z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"setValue",this).call(this,e)}},{key:"min",value:function b(d){return this.__min=d,this}},{key:"max",value:function b(d){return this.__max=d,this}},{key:"step",value:function b(d){return this.__step=d,this.__impliedStep=d,this.__precision=la(d),this}}]),a}(C);function Ha(c,a){var b=Math.pow(10,a);return Math.round(c*b)/b}var L=function(c){A(a,c);function a(b,d,e){v(this,a);var f=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d,e));f.__truncationSuspended=!1;var i=f,j=void 0;function k(){var s=parseFloat(i.__input.value);h.isNaN(s)||i.setValue(s)}function l(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}function q(){l()}function n(s){var m=j-s.clientY;i.setValue(i.getValue()+m*i.__impliedStep),j=s.clientY}function p(){g.unbind(window,"mousemove",n),g.unbind(window,"mouseup",p),l()}function x(s){g.bind(window,"mousemove",n),g.bind(window,"mouseup",p),j=s.clientY}return f.__input=document.createElement("input"),f.__input.setAttribute("type","text"),g.bind(f.__input,"change",k),g.bind(f.__input,"blur",q),g.bind(f.__input,"mousedown",x),g.bind(f.__input,"keydown",function(s){s.keyCode===13&&(i.__truncationSuspended=!0,this.blur(),i.__truncationSuspended=!1,l())}),f.updateDisplay(),f.domElement.appendChild(f.__input),f}return w(a,[{key:"updateDisplay",value:function b(){return this.__input.value=this.__truncationSuspended?this.getValue():Ha(this.getValue(),this.__precision),z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"updateDisplay",this).call(this)}}]),a}(_);function ma(c,a,b,d,e){return d+(e-d)*((c-a)/(b-a))}var U=function(c){A(a,c);function a(b,d,e,f,i){v(this,a);var j=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d,{min:e,max:f,step:i})),k=j;j.__background=document.createElement("div"),j.__foreground=document.createElement("div"),g.bind(j.__background,"mousedown",l),g.bind(j.__background,"touchstart",p),g.addClass(j.__background,"slider"),g.addClass(j.__foreground,"slider-fg");function l(m){document.activeElement.blur(),g.bind(window,"mousemove",q),g.bind(window,"mouseup",n),q(m)}function q(m){m.preventDefault();var t=k.__background.getBoundingClientRect();return k.setValue(ma(m.clientX,t.left,t.right,k.__min,k.__max)),!1}function n(){g.unbind(window,"mousemove",q),g.unbind(window,"mouseup",n),k.__onFinishChange&&k.__onFinishChange.call(k,k.getValue())}function p(m){if(m.touches.length!==1)return;g.bind(window,"touchmove",x),g.bind(window,"touchend",s),x(m)}function x(m){var t=m.touches[0].clientX,D=k.__background.getBoundingClientRect();k.setValue(ma(t,D.left,D.right,k.__min,k.__max))}function s(){g.unbind(window,"touchmove",x),g.unbind(window,"touchend",s),k.__onFinishChange&&k.__onFinishChange.call(k,k.getValue())}return j.updateDisplay(),j.__background.appendChild(j.__foreground),j.domElement.appendChild(j.__background),j}return w(a,[{key:"updateDisplay",value:function b(){var d=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=d*100+"%",z(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"updateDisplay",this).call(this)}}]),a}(_),$=function(c){A(a,c);function a(b,d,e){v(this,a);var f=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d)),i=f;return f.__button=document.createElement("div"),f.__button.innerHTML=e===void 0?"Fire":e,g.bind(f.__button,"click",function(j){return j.preventDefault(),i.fire(),!1}),g.addClass(f.__button,"button"),f.domElement.appendChild(f.__button),f}return w(a,[{key:"fire",value:function b(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),a}(C),V=function(c){A(a,c);function a(b,d){v(this,a);var e=B(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,b,d));e.__color=new r(e.getValue()),e.__temp=new r(0);var f=e;e.domElement=document.createElement("div"),g.makeSelectable(e.domElement,!1),e.__selector=document.createElement("div"),e.__selector.className="selector",e.__saturation_field=document.createElement("div"),e.__saturation_field.className="saturation-field",e.__field_knob=document.createElement("div"),e.__field_knob.className="field-knob",e.__field_knob_border="2px solid ",e.__hue_knob=document.createElement("div"),e.__hue_knob.className="hue-knob",e.__hue_field=document.createElement("div"),e.__hue_field.className="hue-field",e.__input=document.createElement("input"),e.__input.type="text",e.__input_textShadow="0 1px 1px ",g.bind(e.__input,"keydown",function(m){m.keyCode===13&&n.call(this)}),g.bind(e.__input,"blur",n),g.bind(e.__selector,"mousedown",function(){g.addClass(this,"drag").bind(window,"mouseup",function(){g.removeClass(f.__selector,"drag")})}),g.bind(e.__selector,"touchstart",function(){g.addClass(this,"drag").bind(window,"touchend",function(){g.removeClass(f.__selector,"drag")})});var i=document.createElement("div");h.extend(e.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),h.extend(e.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:e.__field_knob_border+(e.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),h.extend(e.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),h.extend(e.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),h.extend(i.style,{width:"100%",height:"100%",background:"none"}),na(i,"top","rgba(0,0,0,0)","#000"),h.extend(e.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),Ja(e.__hue_field),h.extend(e.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:e.__input_textShadow+"rgba(0,0,0,0.7)"}),g.bind(e.__saturation_field,"mousedown",j),g.bind(e.__saturation_field,"touchstart",j),g.bind(e.__field_knob,"mousedown",j),g.bind(e.__field_knob,"touchstart",j),g.bind(e.__hue_field,"mousedown",k),g.bind(e.__hue_field,"touchstart",k);function j(m){x(m),g.bind(window,"mousemove",x),g.bind(window,"touchmove",x),g.bind(window,"mouseup",l),g.bind(window,"touchend",l)}function k(m){s(m),g.bind(window,"mousemove",s),g.bind(window,"touchmove",s),g.bind(window,"mouseup",q),g.bind(window,"touchend",q)}function l(){g.unbind(window,"mousemove",x),g.unbind(window,"touchmove",x),g.unbind(window,"mouseup",l),g.unbind(window,"touchend",l),p()}function q(){g.unbind(window,"mousemove",s),g.unbind(window,"touchmove",s),g.unbind(window,"mouseup",q),g.unbind(window,"touchend",q),p()}function n(){var m=T(this.value);m!==!1?(f.__color.__state=m,f.setValue(f.__color.toOriginal())):this.value=f.__color.toString()}function p(){f.__onFinishChange&&f.__onFinishChange.call(f,f.__color.toOriginal())}e.__saturation_field.appendChild(i),e.__selector.appendChild(e.__field_knob),e.__selector.appendChild(e.__saturation_field),e.__selector.appendChild(e.__hue_field),e.__hue_field.appendChild(e.__hue_knob),e.domElement.appendChild(e.__input),e.domElement.appendChild(e.__selector),e.updateDisplay();function x(m){m.type.indexOf("touch")===-1&&m.preventDefault();var t=f.__saturation_field.getBoundingClientRect(),D=m.touches&&m.touches[0]||m,fa=D.clientX,E=D.clientY,Q=(fa-t.left)/(t.right-t.left),R=1-(E-t.top)/(t.bottom-t.top);return R>1?R=1:R<0&&(R=0),Q>1?Q=1:Q<0&&(Q=0),f.__color.v=R,f.__color.s=Q,f.setValue(f.__color.toOriginal()),!1}function s(m){m.type.indexOf("touch")===-1&&m.preventDefault();var t=f.__hue_field.getBoundingClientRect(),D=m.touches&&m.touches[0]||m,fa=D.clientY,E=1-(fa-t.top)/(t.bottom-t.top);return E>1?E=1:E<0&&(E=0),f.__color.h=E*360,f.setValue(f.__color.toOriginal()),!1}return e}return w(a,[{key:"updateDisplay",value:function b(){var d=T(this.getValue());if(d!==!1){var e=!1;h.each(r.COMPONENTS,function(j){if(!h.isUndefined(d[j])&&!h.isUndefined(this.__color.__state[j])&&d[j]!==this.__color.__state[j])return e=!0,{}},this),e&&h.extend(this.__color.__state,d)}h.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var f=this.__color.v<.5||this.__color.s>.5?255:0,i=255-f;h.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+f+","+f+","+f+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,na(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),h.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+f+","+f+","+f+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})}}]),a}(C),Ia=["-moz-","-o-","-webkit-","-ms-",""];function na(c,a,b,d){c.style.background="",h.each(Ia,function(e){c.style.cssText+="background: "+e+"linear-gradient("+a+", "+b+" 0%, "+d+" 100%); "})}function Ja(c){c.style.background="",c.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",c.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",c.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",c.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",c.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Ka={load:function c(a,b){var d=b||document,e=d.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=a,d.getElementsByTagName("head")[0].appendChild(e)},inject:function c(a,b){var d=b||document,e=document.createElement("style");e.type="text/css",e.innerHTML=a;var f=d.getElementsByTagName("head")[0];try{f.appendChild(e)}catch(i){}}},La=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,Ma=function c(a,b){var d=a[b];return h.isArray(arguments[2])||h.isObject(arguments[2])?new ja(a,b,arguments[2]):h.isNumber(d)?h.isNumber(arguments[2])&&h.isNumber(arguments[3])?h.isNumber(arguments[4])?new U(a,b,arguments[2],arguments[3],arguments[4]):new U(a,b,arguments[2],arguments[3]):h.isNumber(arguments[4])?new L(a,b,{min:arguments[2],max:arguments[3],step:arguments[4]}):new L(a,b,{min:arguments[2],max:arguments[3]}):h.isString(d)?new ka(a,b):h.isFunction(d)?new $(a,b,""):h.isBoolean(d)?new Z(a,b):null};function Na(c){setTimeout(c,1e3/60)}var Oa=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Na,Pa=function(){function c(){v(this,c),this.backgroundElement=document.createElement("div"),h.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),g.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),h.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var a=this;g.bind(this.backgroundElement,"click",function(){a.hide()})}return w(c,[{key:"show",value:function a(){var b=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),h.defer(function(){b.backgroundElement.style.opacity=1,b.domElement.style.opacity=1,b.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function a(){var b=this,d=function e(){b.domElement.style.display="none",b.backgroundElement.style.display="none",g.unbind(b.domElement,"webkitTransitionEnd",e),g.unbind(b.domElement,"transitionend",e),g.unbind(b.domElement,"oTransitionEnd",e)};g.bind(this.domElement,"webkitTransitionEnd",d),g.bind(this.domElement,"transitionend",d),g.bind(this.domElement,"oTransitionEnd",d),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function a(){this.domElement.style.left=window.innerWidth/2-g.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-g.getHeight(this.domElement)/2+"px"}}]),c}(),Qa=Ca(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);Ka.inject(Qa);var oa="dg",pa=72,qa=20,M="Default",N=function(){try{return!!window.localStorage}catch(c){return!1}}(),O=void 0,ra=!0,G=void 0,aa=!1,sa=[],o=function c(a){var b=this,d=a||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),g.addClass(this.domElement,oa),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],d=h.defaults(d,{closeOnTop:!1,autoPlace:!0,width:c.DEFAULT_WIDTH}),d=h.defaults(d,{resizable:d.autoPlace,hideable:d.autoPlace}),h.isUndefined(d.load)?d.load={preset:M}:d.preset&&(d.load.preset=d.preset),h.isUndefined(d.parent)&&d.hideable&&sa.push(this),d.resizable=h.isUndefined(d.parent)&&d.resizable,d.autoPlace&&h.isUndefined(d.scrollable)&&(d.scrollable=!0);var e=N&&localStorage.getItem(H(this,"isLocal"))==="true",f=void 0,i=void 0;Object.defineProperties(this,{parent:{get:function n(){return d.parent}},scrollable:{get:function n(){return d.scrollable}},autoPlace:{get:function n(){return d.autoPlace}},closeOnTop:{get:function n(){return d.closeOnTop}},preset:{get:function n(){return b.parent?b.getRoot().preset:d.load.preset},set:function n(p){b.parent?b.getRoot().preset=p:d.load.preset=p,Ua(this),b.revert()}},width:{get:function n(){return d.width},set:function n(p){d.width=p,ea(b,p)}},name:{get:function n(){return d.name},set:function n(p){d.name=p,i&&(i.innerHTML=d.name)}},closed:{get:function n(){return d.closed},set:function n(p){d.closed=p,d.closed?g.addClass(b.__ul,c.CLASS_CLOSED):g.removeClass(b.__ul,c.CLASS_CLOSED),this.onResize(),b.__closeButton&&(b.__closeButton.innerHTML=p?c.TEXT_OPEN:c.TEXT_CLOSED)}},load:{get:function n(){return d.load}},useLocalStorage:{get:function n(){return e},set:function n(p){N&&(e=p,p?g.bind(window,"unload",f):g.unbind(window,"unload",f),localStorage.setItem(H(b,"isLocal"),p))}}});if(h.isUndefined(d.parent)){this.closed=d.closed||!1,g.addClass(this.domElement,c.CLASS_MAIN),g.makeSelectable(this.domElement,!1);if(N){if(e){b.useLocalStorage=!0;var j=localStorage.getItem(H(this,"gui"));j&&(d.load=JSON.parse(j))}}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=c.TEXT_CLOSED,g.addClass(this.__closeButton,c.CLASS_CLOSE_BUTTON),d.closeOnTop?(g.addClass(this.__closeButton,c.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(g.addClass(this.__closeButton,c.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),g.bind(this.__closeButton,"click",function(){b.closed=!b.closed})}else{d.closed===void 0&&(d.closed=!0);var k=document.createTextNode(d.name);g.addClass(k,"controller-name"),i=ba(b,k);var l=function n(p){return p.preventDefault(),b.closed=!b.closed,!1};g.addClass(this.__ul,c.CLASS_CLOSED),g.addClass(i,"title"),g.bind(i,"click",l),d.closed||(this.closed=!1)}d.autoPlace&&(h.isUndefined(d.parent)&&(ra&&(G=document.createElement("div"),g.addClass(G,oa),g.addClass(G,c.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(G),ra=!1),G.appendChild(this.domElement),g.addClass(this.domElement,c.CLASS_AUTO_PLACE)),this.parent||ea(b,d.width)),this.__resizeHandler=function(){b.onResizeDebounced()},g.bind(window,"resize",this.__resizeHandler),g.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),g.bind(this.__ul,"transitionend",this.__resizeHandler),g.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),d.resizable&&Ta(this),f=function n(){N&&localStorage.getItem(H(b,"isLocal"))==="true"&&localStorage.setItem(H(b,"gui"),JSON.stringify(b.getSaveObject()))},this.saveToLocalStorageIfPossible=f;function q(){var n=b.getRoot();n.width+=1,h.defer(function(){n.width-=1})}d.parent||q()};o.toggleHide=function(){aa=!aa,h.each(sa,function(c){c.domElement.style.display=aa?"none":""})};o.CLASS_AUTO_PLACE="a";o.CLASS_AUTO_PLACE_CONTAINER="ac";o.CLASS_MAIN="main";o.CLASS_CONTROLLER_ROW="cr";o.CLASS_TOO_TALL="taller-than-window";o.CLASS_CLOSED="closed";o.CLASS_CLOSE_BUTTON="close-button";o.CLASS_CLOSE_TOP="close-top";o.CLASS_CLOSE_BOTTOM="close-bottom";o.CLASS_DRAG="drag";o.DEFAULT_WIDTH=245;o.TEXT_CLOSED="Close Controls";o.TEXT_OPEN="Open Controls";o._keydownHandler=function(c){document.activeElement.type!=="text"&&(c.which===pa||c.keyCode===pa)&&o.toggleHide()};g.bind(window,"keydown",o._keydownHandler,!1);h.extend(o.prototype,{add:function c(a,b){return P(this,a,b,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function c(a,b){return P(this,a,b,{color:!0})},remove:function c(a){this.__ul.removeChild(a.__li),this.__controllers.splice(this.__controllers.indexOf(a),1);var b=this;h.defer(function(){b.onResize()})},destroy:function c(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&G.removeChild(this.domElement);var a=this;h.each(this.__folders,function(b){a.removeFolder(b)}),g.unbind(window,"keydown",o._keydownHandler,!1),ta(this)},addFolder:function c(a){if(this.__folders[a]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+a+'"');var b={name:a,parent:this};b.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[a]&&(b.closed=this.load.folders[a].closed,b.load=this.load.folders[a]);var d=new o(b);this.__folders[a]=d;var e=ba(this,d.domElement);return g.addClass(e,"folder"),d},removeFolder:function c(a){this.__ul.removeChild(a.domElement.parentElement),delete this.__folders[a.name],this.load&&this.load.folders&&this.load.folders[a.name]&&delete this.load.folders[a.name],ta(a);var b=this;h.each(a.__folders,function(d){a.removeFolder(d)}),h.defer(function(){b.onResize()})},open:function c(){this.closed=!1},close:function c(){this.closed=!0},hide:function c(){this.domElement.style.display="none"},show:function c(){this.domElement.style.display=""},onResize:function c(){var a=this.getRoot();if(a.scrollable){var b=g.getOffset(a.__ul).top,d=0;h.each(a.__ul.childNodes,function(e){a.autoPlace&&e===a.__save_row||(d+=g.getHeight(e))}),window.innerHeight-b-qa<d?(g.addClass(a.domElement,o.CLASS_TOO_TALL),a.__ul.style.height=window.innerHeight-b-qa+"px"):(g.removeClass(a.domElement,o.CLASS_TOO_TALL),a.__ul.style.height="auto")}a.__resize_handle&&h.defer(function(){a.__resize_handle.style.height=a.__ul.offsetHeight+"px"}),a.__closeButton&&(a.__closeButton.style.width=a.width+"px")},onResizeDebounced:h.debounce(function(){this.onResize()},50),remember:function c(){h.isUndefined(O)&&(O=new Pa(),O.domElement.innerHTML=La);if(this.parent)throw new Error("You can only call remember on a top level GUI.");var a=this;h.each(Array.prototype.slice.call(arguments),function(b){a.__rememberedObjects.length===0&&Sa(a),a.__rememberedObjects.indexOf(b)===-1&&a.__rememberedObjects.push(b)}),this.autoPlace&&ea(this,this.width)},getRoot:function c(){for(var a=this;a.parent;)a=a.parent;return a},getSaveObject:function c(){var a=this.load;return a.closed=this.closed,this.__rememberedObjects.length>0&&(a.preset=this.preset,a.remembered||(a.remembered={}),a.remembered[this.preset]=W(this)),a.folders={},h.each(this.__folders,function(b,d){a.folders[d]=b.getSaveObject()}),a},save:function c(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=W(this),ca(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function c(a){this.load.remembered||(this.load.remembered={},this.load.remembered[M]=W(this,!0)),this.load.remembered[a]=W(this),this.preset=a,da(this,a,!0),this.saveToLocalStorageIfPossible()},revert:function c(a){h.each(this.__controllers,function(b){this.getRoot().load.remembered?ua(a||this.getRoot(),b):b.setValue(b.initialValue),b.__onFinishChange&&b.__onFinishChange.call(b,b.getValue())},this),h.each(this.__folders,function(b){b.revert(b)}),a||ca(this.getRoot(),!1)},listen:function c(a){var b=this.__listening.length===0;this.__listening.push(a),b&&wa(this.__listening)},updateDisplay:function c(){h.each(this.__controllers,function(a){a.updateDisplay()}),h.each(this.__folders,function(a){a.updateDisplay()})}});function ba(c,a,b){var d=document.createElement("li");return a&&d.appendChild(a),b?c.__ul.insertBefore(d,b):c.__ul.appendChild(d),c.onResize(),d}function ta(c){g.unbind(window,"resize",c.__resizeHandler),c.saveToLocalStorageIfPossible&&g.unbind(window,"unload",c.saveToLocalStorageIfPossible)}function ca(c,a){var b=c.__preset_select[c.__preset_select.selectedIndex];a?b.innerHTML=b.value+"*":b.innerHTML=b.value}function Ra(c,a,b){b.__li=a,b.__gui=c,h.extend(b,{options:function f(i){if(arguments.length>1){var j=b.__li.nextElementSibling;return b.remove(),P(c,b.object,b.property,{before:j,factoryArgs:[h.toArray(arguments)]})}if(h.isArray(i)||h.isObject(i)){var k=b.__li.nextElementSibling;return b.remove(),P(c,b.object,b.property,{before:k,factoryArgs:[i]})}},name:function f(i){return b.__li.firstElementChild.firstElementChild.innerHTML=i,b},listen:function f(){return b.__gui.listen(b),b},remove:function f(){return b.__gui.remove(b),b}});if(b instanceof U){var d=new L(b.object,b.property,{min:b.__min,max:b.__max,step:b.__step});h.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(f){var i=b[f],j=d[f];b[f]=d[f]=function(){var k=Array.prototype.slice.call(arguments);return j.apply(d,k),i.apply(b,k)}}),g.addClass(a,"has-slider"),b.domElement.insertBefore(d.domElement,b.domElement.firstElementChild)}else if(b instanceof L){var e=function f(i){if(h.isNumber(b.__min)&&h.isNumber(b.__max)){var j=b.__li.firstElementChild.firstElementChild.innerHTML,k=b.__gui.__listening.indexOf(b)>-1;b.remove();var l=P(c,b.object,b.property,{before:b.__li.nextElementSibling,factoryArgs:[b.__min,b.__max,b.__step]});return l.name(j),k&&l.listen(),l}return i};b.min=h.compose(e,b.min),b.max=h.compose(e,b.max)}else b instanceof Z?(g.bind(a,"click",function(){g.fakeEvent(b.__checkbox,"click")}),g.bind(b.__checkbox,"click",function(f){f.stopPropagation()})):b instanceof $?(g.bind(a,"click",function(){g.fakeEvent(b.__button,"click")}),g.bind(a,"mouseover",function(){g.addClass(b.__button,"hover")}),g.bind(a,"mouseout",function(){g.removeClass(b.__button,"hover")})):b instanceof V&&(g.addClass(a,"color"),b.updateDisplay=h.compose(function(f){return a.style.borderLeftColor=b.__color.toString(),f},b.updateDisplay),b.updateDisplay());b.setValue=h.compose(function(f){return c.getRoot().__preset_select&&b.isModified()&&ca(c.getRoot(),!0),f},b.setValue)}function ua(c,a){var b=c.getRoot(),d=b.__rememberedObjects.indexOf(a.object);if(d!==-1){var e=b.__rememberedObjectIndecesToControllers[d];e===void 0&&(e={},b.__rememberedObjectIndecesToControllers[d]=e),e[a.property]=a;if(b.load&&b.load.remembered){var f=b.load.remembered,i=void 0;if(f[c.preset])i=f[c.preset];else if(f[M])i=f[M];else return;if(i[d]&&i[d][a.property]!==void 0){var j=i[d][a.property];a.initialValue=j,a.setValue(j)}}}}function P(c,a,b,d){if(a[b]===void 0)throw new Error('Object "'+a+'" has no property "'+b+'"');var e=void 0;if(d.color)e=new V(a,b);else{var f=[a,b].concat(d.factoryArgs);e=Ma.apply(c,f)}d.before instanceof C&&(d.before=d.before.__li),ua(c,e),g.addClass(e.domElement,"c");var i=document.createElement("span");g.addClass(i,"property-name"),i.innerHTML=e.property;var j=document.createElement("div");j.appendChild(i),j.appendChild(e.domElement);var k=ba(c,j,d.before);return g.addClass(k,o.CLASS_CONTROLLER_ROW),e instanceof V?g.addClass(k,"color"):g.addClass(k,Ea(e.getValue())),Ra(c,k,e),c.__controllers.push(e),e}function H(c,a){return document.location.href+"."+a}function da(c,a,b){var d=document.createElement("option");d.innerHTML=a,d.value=a,c.__preset_select.appendChild(d),b&&(c.__preset_select.selectedIndex=c.__preset_select.length-1)}function va(c,a){a.style.display=c.useLocalStorage?"block":"none"}function Sa(c){var a=c.__save_row=document.createElement("li");g.addClass(c.domElement,"has-save"),c.__ul.insertBefore(a,c.__ul.firstChild),g.addClass(a,"save-row");var b=document.createElement("span");b.innerHTML="&nbsp;",g.addClass(b,"button gears");var d=document.createElement("span");d.innerHTML="Save",g.addClass(d,"button"),g.addClass(d,"save");var e=document.createElement("span");e.innerHTML="New",g.addClass(e,"button"),g.addClass(e,"save-as");var f=document.createElement("span");f.innerHTML="Revert",g.addClass(f,"button"),g.addClass(f,"revert");var i=c.__preset_select=document.createElement("select");c.load&&c.load.remembered?h.each(c.load.remembered,function(n,p){da(c,p,p===c.preset)}):da(c,M,!1),g.bind(i,"change",function(){for(var n=0;n<c.__preset_select.length;n++)c.__preset_select[n].innerHTML=c.__preset_select[n].value;c.preset=this.value}),a.appendChild(i),a.appendChild(b),a.appendChild(d),a.appendChild(e),a.appendChild(f);if(N){var j=document.getElementById("dg-local-explain"),k=document.getElementById("dg-local-storage"),l=document.getElementById("dg-save-locally");l.style.display="block",localStorage.getItem(H(c,"isLocal"))==="true"&&k.setAttribute("checked","checked"),va(c,j),g.bind(k,"change",function(){c.useLocalStorage=!c.useLocalStorage,va(c,j)})}var q=document.getElementById("dg-new-constructor");g.bind(q,"keydown",function(n){n.metaKey&&(n.which===67||n.keyCode===67)&&O.hide()}),g.bind(b,"click",function(){q.innerHTML=JSON.stringify(c.getSaveObject(),void 0,2),O.show(),q.focus(),q.select()}),g.bind(d,"click",function(){c.save()}),g.bind(e,"click",function(){var n=prompt("Enter a new preset name.");n&&c.saveAs(n)}),g.bind(f,"click",function(){c.revert()})}function Ta(c){var a=void 0;c.__resize_handle=document.createElement("div"),h.extend(c.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function b(f){return f.preventDefault(),c.width+=a-f.clientX,c.onResize(),a=f.clientX,!1}function d(){g.removeClass(c.__closeButton,o.CLASS_DRAG),g.unbind(window,"mousemove",b),g.unbind(window,"mouseup",d)}function e(f){return f.preventDefault(),a=f.clientX,g.addClass(c.__closeButton,o.CLASS_DRAG),g.bind(window,"mousemove",b),g.bind(window,"mouseup",d),!1}g.bind(c.__resize_handle,"mousedown",e),g.bind(c.__closeButton,"mousedown",e),c.domElement.insertBefore(c.__resize_handle,c.domElement.firstElementChild)}function ea(c,a){c.domElement.style.width=a+"px",c.__save_row&&c.autoPlace&&(c.__save_row.style.width=a+"px"),c.__closeButton&&(c.__closeButton.style.width=a+"px")}function W(c,a){var b={};return h.each(c.__rememberedObjects,function(d,e){var f={},i=c.__rememberedObjectIndecesToControllers[e];h.each(i,function(j,k){f[k]=a?j.initialValue:j.getValue()}),b[e]=f}),b}function Ua(c){for(var a=0;a<c.__preset_select.length;a++)c.__preset_select[a].value===c.preset&&(c.__preset_select.selectedIndex=a)}function wa(c){c.length!==0&&Oa.call(window,function(){wa(c)}),h.each(c,function(a){a.updateDisplay()})}var Va={Color:r,math:K,interpret:T},Wa={Controller:C,BooleanController:Z,OptionController:ja,StringController:ka,NumberController:_,NumberControllerBox:L,NumberControllerSlider:U,FunctionController:$,ColorController:V},Xa={dom:g},Ya={GUI:o},Za=o,_a={color:Va,controllers:Wa,dom:Xa,gui:Ya,GUI:Za},xa=_a;class $a{constructor(c){this.listeners={},this.config=c,this.gui=new xa.GUI({load:JSON});const a=e=>f=>{this.triggerChange(e,f)},b=this.gui.addFolder("Canvas");b.add(c,"width").min(10).max(4096).step(1).onChange(a("width")),b.add(c,"height").min(10).max(4096).step(1).onChange(a("height")),b.add(c,"scale").min(1).max(4).step(1).onChange(a("scale")),b.add(c,"angle").min(0).max(360).onChange(a("angle")),b.open();const d=this.gui.addFolder("Pattern");d.add(c,"symmetries").min(4).max(32).step(1).onChange(a("symmetries")),d.add(c,"patternScale").name("scale").min(.05).max(4).step(.05).onChange(a("patternScale")),d.add(c,"patternAngle").name("angle").min(0).max(360).onChange(a("patternAngle")),d.addColor(c,"offset").onChange(a("offset")),d.add(c,"file").name("Load pattern..."),d.add(c,"save").name("Save image..."),d.add(c,"randomize").name("Randomize").onChange(()=>{this.updateDisplay(this.gui),this.triggerChange("randomize")}),d.open(),this.gui.remember(this.config)}updateDisplay(c){for(var a in c.__controllers)c.__controllers[a].updateDisplay();for(var b in c.__folders)this.updateDisplay(c.__folders[b])}addEventListener(c,a){this.listeners[c]=this.listeners[c]||[],this.listeners[c].push(a)}removeEventListener(c,a){this.listeners[c]=this.listeners[c]||[],this.listeners[c]=this.listeners[c].filter(b=>b!==a)}triggerChange(c,a){const b="change";this.listeners[b]&&this.listeners[b].forEach(d=>d({type:b,name:c,value:a}))}getValue(c){return this.config[c]}setValue(c,a){const b=this._findControllerFor(c);b&&b.setValue(a)}increaseValue(c,a){this.setValue(c,this.getValue(c)+a)}_findControllerFor(c){let a=this.gui.__controllers.find(function(b){return b.property===c});return a||(a=Object.keys(this.gui.__folders).reduce((b,d)=>(b||(b=this.gui.__folders[d].__controllers.find(e=>e.property===c)),b),void 0)),a}}var za=$a;function ya(c){c=c||{},this.width=c.width||2048,this.height=c.height||2048,this.scale=c.scale||4,this.angle=c.angle||0,this.offset=c.offset||{h:0,s:0,v:0},this.patternScale=c.patternScale||1,this.patternAngle=c.patternAngle||0,this.symmetries=c.symmetries||7,this.file=()=>document.getElementById("patternFile").click(),this.save=()=>{const a=document.createElement("a");a.download="mandala.png",a.href=document.getElementById("stage").toDataURL("image/png").replace(/^data:image\/[^;]/,"data:application/octet-stream"),a.click()},this.randomize=()=>{this.scale=Math.ceil(Math.random()*4),this.angle=Math.floor(Math.random()*360),this.offset.s=Math.random(),this.offset.v=Math.random(),this.patternScale=Math.random()*4,this.patternAngle=Math.floor(Math.random()*360),this.symmetries=Math.floor(Math.random()*16)+4}}const u=(c,a,b,d)=>{if(c&&a&&b)for(var e=String(a).split(" ");e.length;)a=e.pop(),c.addEventListener?c.addEventListener(a,b,d):c.attachEvent("on"+a,b,d)};class ab{constructor(c){const a=document.querySelector(c);this.config=new ya(),this.gui=new za(this.config),this.mandala=new Aa(),this.stage=new Ba(a),this.stage.clear("white"),this.stage.setScale(this.gui.getValue("scale")),this.stage.drawText("DROP IMAGE HERE"),this.bindEvents()}bindEvents(){let c=!1;u(document.getElementById("patternFile"),"change",b=>{this.onFileChange(b.target.files[0])}),u(this.stage.canvas,"mousedown",b=>{b.button===0&&(c=!0)}),u(document,"mouseup",b=>{c=!1}),u(document,"mousemove",b=>{if(!c)return;if(b.shiftKey)this.gui.increaseValue("angle",b.movementX/10);else if(b.altKey)this.gui.increaseValue("patternAngle",b.movementX/10);else{const d=this.gui.getValue("offset");this.gui.setValue("offset",{s:d.s-b.movementY/this.stage.height,v:d.v-b.movementX/this.stage.width})}});const a={x:void 0,y:void 0};u(this.stage.canvas,"touchstart",b=>{c=!0;const d=event.changedTouches[0];a.x=d.clientX,a.y=d.clientY}),u(document,"touchend touchcancel",b=>{c=!1}),u(document,"touchmove",b=>{if(!c)return;const d=event.changedTouches[0],e=d.clientX-a.x,f=d.clientY-a.y;a.x=d.clientX,a.y=d.clientY;const i=this.gui.getValue("offset");this.gui.setValue("offset",{s:i.s-f/this.stage.height,v:i.v-e/this.stage.width})}),u(this.stage.canvas,"wheel",b=>{b.preventDefault(),this.gui.increaseValue("patternScale",b.deltaY*-.001)}),u(window,"dragover",b=>b.preventDefault()),u(window,"drop",b=>{b.preventDefault();const d=b.dataTransfer.files[0];this.onFileChange(d)}),u(this.gui,"change",({name:b,value:d})=>{switch(b){case"patternAngle":this.mandala.setRotation(d);break;case"patternScale":this.mandala.setScale(d);break;case"scale":this.stage.setScale(d);break;case"width":this.stage.setWidth(d);break;case"height":this.stage.setHeight(d);break}this.render()})}onFileChange(c){if(!c)return;const a=new Image();a.src=URL.createObjectURL(c),a.addEventListener("load",()=>{this.mandala.setPattern(this.stage.ctx.createPattern(a,"repeat")),this.render()})}render(){clearTimeout(this.renderTimeout),this.renderTimeout=setTimeout(()=>{this.stage.clear(),this.mandala.render(this.stage.ctx,this.config)},1)}}window.MandalaApp=ab;})();
